<!DOCTYPE html>
<html lang="en">

<head>
  <!-- Character Encoding -->
  <meta charset="UTF-8" />

  <!-- Viewport & Responsive Settings -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#000000">
  <link rel="apple-touch-icon" href="/icons/icon-192.png">


  <!-- Monetag Verification -->
  <meta name="monetag" content="22f96c99a1ef9c7f13c4c8467014d6d1">
  <script>(function(s){s.dataset.zone='10557224',s.src='https://al5sm.com/tag.min.js'})([document.documentElement, document.body].filter(Boolean).pop().appendChild(document.createElement('script')))</script>
  <!-- Google tag (gtag.js) -->
  
<script>
(async () => {
  const API_URL = "https://workers-playground-autumn-mouse-86e7.watchoutofficial2006.workers.dev/?url=trending/all/week";
  const IMAGE_BASE = "https://image.tmdb.org/t/p/w1280";

  try {
    const res = await fetch(API_URL);
    const data = await res.json();

    const images = data.results
      .map(item => item.poster_path)
      .filter(Boolean);

    if (!images.length) return;

    const container = document.querySelector(".profile-spotlight");
    if (!container) return;

    // get or create img
    let img = container.querySelector(".profile-spotlight-backdrop");
    if (!img) {
      img = document.createElement("img");
      img.className = "profile-spotlight-backdrop";

      // ðŸ”¹ EXACT styles you asked for
      img.style.width = "100%";
      img.style.height = "80vh";
      img.style.objectFit = "cover";
      img.style.aspectRatio = "16 / 9";

      container.appendChild(img);
    }

    let index = 0;

    function changeImage() {
      // restart animation if any
      img.classList.remove("zoom-effect");
      void img.offsetWidth;

      img.src = IMAGE_BASE + images[index];
      img.classList.add("zoom-effect");

      index = (index + 1) % images.length;
    }

    changeImage();
    setInterval(changeImage, 4000);

  } catch (err) {
    console.error("Spotlight error:", err);
  }
})();
</script>




<script async src="https://www.googletagmanager.com/gtag/js?id=G-S1XCS01T14"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-S1XCS01T14');
</script>


  <!-- Firebase SDKs -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-app.js";
        import { getAuth, GoogleAuthProvider, signInWithPopup, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-auth.js";
        
        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBGU_YSZhb2alU6ws7gs_178k1_x5wd_MA",
            authDomain: "watchout-fun.firebaseapp.com",
            projectId: "watchout-fun",
            storageBucket: "watchout-fun.firebasestorage.app",
            messagingSenderId: "599865749733",
            appId: "1:599865749733:web:4472ebc1dd6ba2b3c6240c"
        };
        
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const provider = new GoogleAuthProvider();

        const accountSection = document.getElementById('account-section');
        const profileDisplayName = document.getElementById('profile-display-name');
        const profileAvatar = document.getElementById('profile-avatar');
        const authActionItem = document.getElementById('auth-action-item');

        // Function to handle Google Sign-in
        window.signInWithGoogle = async () => {
            try {
                const result = await signInWithPopup(auth, provider);
                console.log("Signed in successfully:", result.user);
            } catch (error) {
                console.error("Sign-in failed:", error.message);
            }
        };

        // Function to handle user sign-out
        window.signOutUser = async () => {
            try {
                await signOut(auth);
                console.log("Signed out successfully");
            } catch (error) {
                console.error("Sign-out failed:", error.message);
            }
        };

        // Listen for authentication state changes
        onAuthStateChanged(auth, (user) => {
            if (user) {
                // User is signed in, update the UI for logged-in state
                profileDisplayName.textContent = user.displayName || 'User';

                // Set user avatar
                if (user.photoURL) {
                    const img = document.createElement('img');
                    img.src = user.photoURL;
                    img.alt = 'Profile Picture';
                    profileAvatar.innerHTML = '';
                    profileAvatar.appendChild(img);
                } else {
                    // Use initial as a fallback if no photo is available
                    const initial = (user.displayName ? user.displayName[0] : 'U').toUpperCase();
                    profileAvatar.textContent = initial;
                }

                // Update the dropdown item for 'Sign Out'
                authActionItem.innerHTML = `
                    <svg class="dropdown-icon" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z"/>
                    </svg>
                    Sign Out
                `;
                authActionItem.onclick = signOutUser;
                authActionItem.style.color = '#ff4d4f'; // Apply sign-out color
                
            } else {
                // User is signed out, update the UI for logged-out state
                profileDisplayName.textContent = '';
                profileAvatar.textContent = 'WU';
                profileAvatar.innerHTML = ''; // Clear any previous image

                // Update the dropdown item for 'Sign In'
                authActionItem.innerHTML = `
                    <svg class="dropdown-icon" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z"/>
                    </svg>
                    Sign In
                `;
                authActionItem.onclick = signInWithGoogle;
                authActionItem.style.color = '#e5e5e5'; // Reset color
            }
        });
        
        // This script now changes the header's background from transparent to black as you scroll.
        window.addEventListener('scroll', function() {
            const headers = document.querySelector('.headers');
            const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
            
            if (scrollTop > 50) {
                headers.style.background = 'rgba(0,0,0,0.95)'; 
            } else {
                headers.style.background = 'transparent';
            }
        });

      
// Get the dropdown element
const dropdown = document.querySelector('.nfDropDown.theme-lakira');

// Get the sub-menu element
const subMenu = dropdown.querySelector('.sub-menu');

// Add a click event listener to the dropdown element
dropdown.addEventListener('click', (event) => {
  // Prevent the click from bubbling up to the document
  event.stopPropagation();

  // Set the opacity of the sub-menu to 1
  subMenu.style.opacity = '1';
});

// Add a click event listener to the entire document
document.addEventListener('click', (event) => {
  // Check if the click occurred outside the dropdown
  if (!dropdown.contains(event.target)) {
    // If it's an outside click, set the sub-menu opacity to 0
    subMenu.style.opacity = '0';
  }
});

 document.querySelectorAll('.sub-menu-link').forEach(link => {
  link.addEventListener('click', function(e) {
    e.preventDefault();
    const genre = this.dataset.genre; // e.g. "horror", "action"

    let path = window.location.pathname.replace(/\/+$/, ""); // remove trailing slashes

    const pathParts = path.split("/").filter(Boolean);

    const genreIndex = pathParts.indexOf("genre");

    if (genreIndex !== -1) {
      // If /genre exists, replace the next segment
      pathParts[genreIndex + 1] = genre;
      path = "/" + pathParts.join("/");
    } else {
      // Otherwise, append /genre/<genre>
      path = "/" + [...pathParts, "genre", genre].join("/");
    }

    history.pushState({ genre }, "", path);
  });
});





    </script>
	
  <!-- SEO Meta Tags -->
  <title>Cinexa - Explore Movies, TV Shows, Animes & Dramas Online</title>
  <meta name="description" content="Cinexa - Explore Movies, TV Shows, Animes, and Dramas online" />
  <meta name="keywords" content="Cinexa, Explore movies, TV shows online, anime , drama series, OTT platform" />
  <meta name="robots" content="index, follow" />
  <link rel="canonical" href="https://cinexa.icu/" />

  <!-- Favicon & Icons -->
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/watchout-favicon.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/watchout-favicon.png" />
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/watchout-favicon.png" />
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/watchout-favicon.png" />
  <link rel="shortcut icon" href="/icons/watchout-favicon.png" type="image/png" />

  <!-- Font Awesome -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css" rel="stylesheet" />

  <!-- Open Graph Tags (for Facebook, WhatsApp, etc.) -->
  <meta property="og:title" content="Cinexa - Explore Movies, TV Shows, Animes & Dramas Online" />
  <meta property="og:image" content="/icons/watchout-favicon.png" />
  <meta property="og:description" content="Explore your favorite movies, TV shows, anime, and dramas without signups on cinexa" />
  
  <meta property="og:url" content="https://cinexa.icu/" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="cinexa" />

  <!-- Twitter Card Tags -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Cinexa, Explore movies, TV shows online, anime , drama series, OTT platform" />
  <meta name="twitter:description" content="Explore your favorite movies, TV shows, anime, and dramas without signups on WatchOut." />
  <meta name="twitter:image" content="/icons/watchout-favicon.png" />
  <meta name="twitter:site" content="@cinexa_in" />

  <!-- Language -->
  <meta http-equiv="Content-Language" content="en" />

  
<!-- Add your custom styles here -->
<style>
    /* Trigger button */
    .report-issue-btn {
      padding: 12px 20px;
      background: #e50914;
      border: none;
      color: #fff;
      font-size: 15px;
      cursor: pointer;
      border-radius: 4px;
      font-weight: 600;
    }

    /* Overlay */
    .report-modal {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.75);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.2s ease;
      padding: 16px;
    }

    .report-modal.active {
      opacity: 1;
      pointer-events: auto;
    }

    /* Modal box */
    .report-modal-box {
      background: #141414;
      width: 100%;
      max-width: 420px;
      border-radius: 6px;
      padding: 20px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.8);
      transform: translateY(10px) scale(0.96);
      transition: transform 0.2s ease;
    }

    .report-modal.active .report-modal-box {
      transform: translateY(0) scale(1);
    }

    /* Header */
    .report-modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }

    .report-modal-title {
      font-size: 18px;
      margin: 0;
      font-weight: 600;
    }

    .report-close-btn {
      background: none;
      border: none;
      color: #b3b3b3;
      font-size: 22px;
      cursor: pointer;
      line-height: 1;
    }

    .report-close-btn:hover { color: #fff; }

    /* Body */
    .report-modal-body label {
      display: block;
      margin: 14px 0 6px;
      font-size: 13px;
      color: #b3b3b3;
    }

    .report-modal-body select,
    .report-modal-body textarea {
      width: 100%;
      padding: 12px 40px 12px 12px;
      background: #000;
      border: 1px solid #2a2a2a;
      color: #fff;
      border-radius: 4px;
      font-size: 14px;
      outline: none;
    }

    .report-modal-body select {
      appearance: none;
      -webkit-appearance: none;
      -moz-appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='8' viewBox='0 0 12 8'%3E%3Cpath fill='%23b3b3b3' d='M6 8L0 0h12z'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 14px center;
      background-size: 12px;
    }

    .report-modal-body select:focus,
    .report-modal-body textarea:focus {
      border-color: #e50914;
    }

    .report-modal-body textarea {
      resize: none;
      min-height: 96px;
    }

    /* Footer */
    .report-modal-footer {
      display: flex;
      justify-content: flex-end;
      margin-top: 20px;
    }

    .report-submit-btn {
      padding: 10px 18px;
      background: #e50914;
      border: none;
      color: #fff;
      font-size: 14px;
      cursor: pointer;
      border-radius: 4px;
      font-weight: 600;
    }

    .report-submit-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    @media (max-width: 480px) {
      .report-modal-box { padding: 16px; }
      .report-modal-title { font-size: 16px; }
      .report-issue-btn { width: 100%; }
    }
/* Zoom animation */
@keyframes slowZoom {
  from {
    transform: scale(1);
  }
  to {
    transform: scale(1.08);
  }
}

.zoom-effect {
  animation: slowZoom 6s linear forwards;
}
  .nfDropDown.theme-lakira .sub-menu {
    font-size: 14px;
    left: 0;
    margin: 0;
    overflow-x: hidden;
    padding: 0;
    z-index: 2;
}
  .sub-menu.theme-lakira {
    background-color: rgba(0, 0, 0, .9);
    border: 1px solid hsla(0, 0%, 100%, .15);
    box-sizing: border-box;
    color: #fff;
    cursor: default;
    font-size: 13px;
    line-height: 21px;
    opacity: 0;
    position: absolute;
}
  .nfDropDown.theme-lakira .sub-menu .sub-menu-list, .nfDropDown.theme-lakira .sub-menu .sub-menu-list-special {
    margin: 0;
    padding: 5px 0;
}
  .sub-menu.theme-lakira .sub-menu-list-special.multi-column, .sub-menu.theme-lakira .sub-menu-list.multi-column {
    display: table-cell;
}
  .sub-menu.theme-lakira .sub-menu-list, .sub-menu.theme-lakira .sub-menu-list-special {
    cursor: default;
    height: auto;
    padding: 1.1rem;
}
  .sub-menu.theme-lakira .sub-menu-item, .sub-menu.theme-lakira .sub-menu-item-special {
    cursor: default;
    display: block;
    line-height: 24px;
}
   .sub-menu-link {
    padding: 1px 20px 1px 10px;
}
  .nfDropDown.theme-lakira .sub-menu .sub-menu-link {
    display: inline-block;
    /*padding: 1px 0;*/
    width: 100%;
}
  .aro-gallery-header .subgenres .sub-menu .sub-menu-link {
    white-space: nowrap;
    cursor: pointer;
}
  .sub-menu.theme-lakira .sub-menu-link {
    color: #fff;
    display: inline-block;
    text-transform: none;
    width: 100%;
}
  
  .aro-toggle .aro-grid-toggle, .aro-toggle .aro-row-toggle {
    background-color: transparent;
    padding: 0;
}
  .aro-toggle .aro-row-toggle {
    align-items: center;
    border: 1px solid #fff;
    display: flex;
    height: 30px;
    justify-content: center;
    width: 44px;
}
  .aro-toggle .svg-icon-rows {
    height: 13px;
    color: #fff;
    width: 13px;
    fill: #fff;
}
  .aro-toggle .aro-grid {
    background: rgba(0, 0, 0, .1);
    border: 1px solid #fff;
    border-left: none;
    display: flex;
    opacity: .65;
    width: auto;
}
  .aro-toggle .aro-grid-toggle {
    align-items: center;
    border: 0;
    cursor: pointer;
    display: flex;
    height: 28px;
    justify-content: center;
    width: 44px;
}
  .aro-toggle .svg-icon-grid {
    color: #fff;
    height: 13px;
    width: 13px;
}
  
  .titleGroup--wrapper .title-group-collection {
    height: 1.2em;
    margin-right: .66em;
    width: 1.2em;
}
  .sub-header-wrapper{
    align-items: center;
    display: flex;
    padding: 0 4%;
    height: 68px;
  }
  /*.sub-header{display:none !important;}*/
  .aro-gallery-header{
    align-items: center;
    display: flex;
    flex-grow: 1;
    flex-wrap: wrap;
    margin: 0;
    min-height: 0;
    padding: 0;
  }
  .title{
    font-size: 2.5rem;
  }
  .aro-genre-details{
    align-items: center;
    display: flex;
    flex-direction: row;
    flex-grow: 1;
    justify-content: flex-start;
  }
  .genreTitle{
    font-size: 38px;
    line-height: 38px;
    margin-right: 15px;
    font-family: 'Netflix Sans';
    font-weight: 500;
    color: #fff;
  }
  .subgenres{
    display: inline-block;
    vertical-align: top;
    margin: 0 30px;
  }
  .nfDropDown.theme-lakira {
    position: relative;
    text-align: left;
}
  .nfDropDown.theme-lakira .label:focus, .nfDropDown.theme-lakira .label:hover {
    background-color: hsla(0, 0%, 100%, .1);
    cursor: pointer;
    outline: none;
}
  .nfDropDown.theme-lakira .label {
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
    background-color: #000;
    border: 1px solid hsla(0, 0%, 100%, .9);
    border-radius: 0;
    box-sizing: border-box;
    color: #fff;
    display: inline-block;
    font-size: 15px;
    font-weight: 500;
    height: 25px;
    letter-spacing: 1px;
    line-height: 25px;
    padding-left: 10px;
    padding-right: 50px;
    position: relative;
}
  .nfDropDown.theme-lakira .label .arrow {
    border-color: #fff transparent transparent;
    border-style: solid;
    border-width: 5px 5px 0;
    height: 0;
    position: absolute;
    right: 10px;
    top: 44%;
    width: 0;
}
  .aro-toggle{
    display: flex;
    margin-left: auto;
    z-index: 2;
  }
  .movie-entry-wrapper{
    align-items: baseline;
    display: flex;
  }
  .movie-number{
    aspect-ratio: 2 / 3;
  }
  
  /* Account Section Styles */
  .profile-avatar img{
    width: 100%;
  }
        .account-section {
            display: flex;
            align-items: center;
            gap: 20px;
            position: relative;
        }

        .profile-dropdown {
            position: relative;
        }

        .profile-trigger {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            padding: 5px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .profile-avatar {
            width: 32px;
            height: 32px;
            border-radius: 4px;
    background-image: url(https://occ-0-4345-3647.1.nflxso.net/dnm/api/v6/vN7bi_My87NPKvsBoib006Llxzg/AAAABZumJ3wvSKM7od-r3UjhVF9j3yteWlQYA-51F3SNoI682llhul1Xf_CUkMnfP_17Md2lpOOhbwHeGufvo8kOTjptoS_bcwtniHKz.png?r=e6e);
    background-size: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .profile-trigger:hover .profile-avatar {
            border-color: rgba(255,255,255,0.3);
            transform: scale(1.05);
        }

        .dropdown-arrow {
            width: 0;
            height: 0;
            border-left: 4px solid transparent;
            border-right: 4px solid transparent;
            border-top: 4px solid #e5e5e5;
            transition: all 0.3s ease;
        }

        .profile-trigger:hover .dropdown-arrow {
            border-top-color: #ffffff;
            transform: rotate(180deg);
        }

        .dropdown-menu {
            position: absolute;
            top: 100%;
            right: 0;
            margin-top: 8px;
            background: rgba(0,0,0,0.9);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.1);
            min-width: 200px;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 20px 40px rgba(0,0,0,0.5);
        }

        .profile-dropdown:hover .dropdown-menu {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .profile-dropdown:hover .dropdown-arrow {
            transform: rotate(180deg);
            border-top-color: #ffffff;
        }

        .dropdown-item {
            padding: 12px 16px;
            color: #e5e5e5;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 14px;
            transition: all 0.3s ease;
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }

        .dropdown-item:last-child {
            border-bottom: none;
        }

        .dropdown-item:hover {
            background: rgba(255,255,255,0.1);
            color: #ffffff;
            transform: translateX(0px);
        }

        .dropdown-item:first-child {
            border-radius: 0px 0px 0 0;
        }

        .dropdown-item:last-child {
            border-radius: 0 0 0px 0px;
        }

        .dropdown-icon {
            width: 16px;
            height: 16px;
            opacity: 0.7;
        }
  .header-right{
    position: absolute;
    right: 4%;
    display: flex;
    justify-content: flex-end;
    top: 0;
    gap: 10px;
    height: 60px;
  }
 .modal-backdrop-container.hidden {
            display: none;
            pointer-events: none;
        }
        
        .video-wrapper {
            position: relative;
            padding-bottom: 56.25%; /* 16:9 aspect ratio */
            height: 0;
            overflow: hidden;
            margin-left: -17%;
            margin-right: -17%;
        }
        
        .video-wrapper iframe {
            position: absolute;
            top: -170px;
            left: 0;
            width: 100%;
            height: calc(100% + 340px);
            border: none;
            opacity: 1;
            transition: opacity 0.3s ease;
        }
        
        .video-wrapper iframe.hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        .progress-border {
            position: absolute;
            bottom: 0;
            left: 0;
            height: 4px;
            background: linear-gradient(90deg, #e50914 0%, #e50914 100%);
            width: 0%;
            transition: width 0.1s ease;
            z-index: 6;
        }
        
        .progress-border:hover {
            height: 6px;
            background: linear-gradient(90deg, #f40612 0%, #f40612 100%);
        }
  
  #playerWrap{
  position: relative;
  aspect-ratio: 16 / 9;
  overflow: hidden;
  }

@font-face {
  font-family: 'Netflix Sans';
  src: url('https://assets.nflxext.com/ffe/siteui/fonts/netflix-sans/v3/NetflixSans_W_Rg.woff2') format('woff2');
  font-weight: 400;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: 'Netflix Sans';
  src: url('https://assets.nflxext.com/ffe/siteui/fonts/netflix-sans/v3/NetflixSans_W_Md.woff2') format('woff2');
  font-weight: 500;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: 'Netflix Sans';
  src: url('https://assets.nflxext.com/ffe/siteui/fonts/netflix-sans/v3/NetflixSans_W_Bd.woff2') format('woff2');
  font-weight: 700;
  font-style: normal;
  font-display: swap;
}

/* Netflix Icons */
@font-face {
  font-family: 'Netflix Icons';
  src: url('https://assets.nflxext.com/ffe/siteui/fonts/nf-icon-v1-93.woff') format('woff');
  font-weight: normal;
  font-style: normal;
  font-display: swap;
}
.netflix-sans-font-loaded {
    font-family: 'Netflix Sans','Helvetica Neue',Helvetica,Arial,sans-serif
}

.netflix-sans-font-loaded.nkufi-font-loaded {
    font-family: NKufi,'Netflix Sans','Helvetica Neue',Helvetica,Arial,sans-serif
}

.netflix-sans-font-loaded.graphik-font-loaded {
    font-family: GraphikTH,'Netflix Sans','Helvetica Neue',Helvetica,Arial,sans-serif
}

:root{--netflix-font-stack: 'Netflix Sans','Helvetica Neue',Helvetica,Arial,sans-serif;}

/* global smoothing (optional) */
body{font-family: var(--netflix-font-stack);-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;}

/* example error page styling (kept from your original) */
.error-page{
  font-family: var(--netflix-font-stack);
  font-size: 10px;
  line-height: 1.2;
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
  color:#fff;
  background:rgba(0,0,0,.18);
  bottom:0;
  display:flex;
  flex-direction:column;
  left:0;
  margin-top:68px;
  overflow:hidden;
  position:fixed;
  right:0;
  top:0;
  z-index:1000;
}
  .model-year-rating{
    align-items: center;
    color: #bcbcbc;
    display: flex;
    flex-wrap: wrap;
  }
  
  /* Header styles */
        .header {
            height: 60px;
            background: transparent;
            top: 0;
            left: 0;
            right: 0;
            z-index: 50;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .header-logo {
            height: 25px; /* Set height via CSS, half of previous 50px */
            margin-right: 0.5rem; /* Equivalent to space-x-2 */
            object-fit: contain; /* Ensure the image scales correctly within its bounds */
            transition: opacity 0.3s ease-in-out;
        }

        .header-title {
            color: #ffffff;
            padding-left: 10px;
            font-weight: 800;
            font-size: 1.3rem; /* text-lg */
            white-space: nowrap; /* Prevent text wrapping */
            overflow: hidden;
        }
        /* Styles for the new header navigation links */
        .header-nav-links {
            display: flex;
            align-items: center;
            margin-left: 1rem; /* ml-4 */
        }

        .header-nav-link {
            color: #ffffff; /* White color */
            font-size: 0.875rem; /* text-sm */
            text-decoration: none;
            margin-left: 18px;
            cursor: pointer;
            white-space: nowrap; /* Prevent text wrapping */
            transition: color 0.3s ease; /* Smooth transition for hover effect */
        }

        .header-nav-link:hover {
            color: #9ca3af; /* Grey color on hover */
        }
        .header-icons {
            display: flex;
            align-items: center;
            gap: 1rem; /* Equivalent to space-x-4 */
        }

        .header-icon {
            width: 1.5rem;
            height: 1.5rem;
            color: #ffffff;
            cursor: pointer;
            stroke-width: 2;
        }
        .scroll-button {
  height: auto;
  top: 0;
  bottom: 0;
  display: flex;
  align-items: center;
  height: 100%;
  display: none;
  position: absolute; 
  background: rgba(0, 0, 0, 0.5);
  border: none;
  color: white;
  font-size: 2rem;
  padding: 0.8rem;
  z-index: 10;
  cursor: pointer;
}

.scroll-button.left {
  border-radius: 0 6px 6px 0;
  left: 0rem;
}

.scroll-button.right {
  border-radius: 6px 0 0 6px;
  right: 0rem;
}
.scroll-button:hover {
    display: block;
    opacity: 100% !important;
  }
@media (min-width: 800px) {
  .scroll-button{
    display: block;
    opacity: 0;
  }
  .model-rating-box,.ion-align-items-center{
  display: none;
  }
}
        /* Hidden element utility */
        .hidden-element {
            display: none;
        }

        /* Main content area */
        .main-content {
            flex-grow: 1;
            padding-top: 4rem; /* pt-16 */
            padding-bottom: 4rem; /* pb-16 */
        }

        /* Section visibility */
        .section-hidden {
            display: none !important;
        }

        /* Notifications Section */
        .notifications-section {
            padding: 1rem;
            background: rgba(42, 42, 42, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.15);
            margin-left: 1rem;
            margin-right: 1rem;
            border-radius: 4px; /* rounded-xl */
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-top: 1.5rem; /* mt-6 */
        }

        .notifications-left {
            display: flex;
            align-items: center;
            gap: 0.75rem; /* space-x-3 */
        }

        .notifications-icon {
            width: 1.5rem;
            height: 1.5rem;
            color: #ffffff;
            stroke-width: 2;
        }

        .notifications-text {
            color: #ffffff;
            font-size: 1rem; /* text-base */
            font-weight: 500; /* font-medium */
        }

        /* Specific style for "See All" in Notifications section */
        #my-netflix-section .notifications-link {
            font-size: 1.25rem; /* Match carousel-title font-size */
            font-weight: 600; /* Match carousel-title font-weight */
            color: #ffffff; /* Match carousel-title color */
            text-decoration: none; /* Remove underline */
        }

        .notifications-link-icon {
            width: 1rem;
            height: 1rem;
            stroke-width: 2;
        }

        /* Carousel Sections (My List, Trailers, Mobile Games, Top 10 Games) */
        .carousel-section {
            position: relative;
            margin-top: 2rem; /* mt-8 */
            padding-left: 4%; /* px-4 */
        }

        .carousel-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 10px ; /* mb-4 */
        }

        .carousel-title {
            color: #ffffff;
            font-size: 1.5em; /* text-xl */
            font-weight: 700; /* font-semibold */
        }

        /* Style for "See All" text in carousel sections to match heading and remove underline */
        .carousel-section .notifications-link {
            font-size: 1.25rem; /* Match carousel-title font-size */
            font-weight: 600; /* Match carousel-title font-weight */
            color: #ffffff; /* Match carousel-title color */
            text-decoration: none; /* Remove underline */
        }


        .carousel-content {
            display: flex;
            overflow-x: scroll;
            gap: 0.5rem; /* space-x-3 */
            padding-bottom: 1rem; /* pb-4 */
        }

        /* Hide scrollbar */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        .movie-card {
            position: relative;
            flex-shrink: 0;
            width: 115px; /* w-32 */
            aspect-ratio: 2/3;
            border-radius: 6px; /* rounded-lg */
            overflow: hidden;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        @media (min-width: 768px) { /* md:w-40 */
            .movie-card {
                width: 10rem;
            }
        }
        @media (min-width: 1024px) { /* lg:w-48 */
            .movie-card {
                width: 12rem;
            }
        }
        @media (min-width: 900px) { /* md:w-40 */
            .card, card img {
                aspect-ratio:16/9 !important;
                width: 19.22% !important;
            }
        }
        .movie-card img {
            width: 100%;
            height: auto;
            object-fit: cover;
            border-radius: 0.5rem; /* rounded-lg */
        }

        .badge-n {
            position: absolute;
            top: 0.25rem; /* top-1 */
            right: 0.25rem; /* right-1 */
            background-color: #dc2626; /* bg-red-600 */
            color: #ffffff;
            font-size: 0.75rem; /* text-xs */
            padding: 0.05rem 0.5rem; /* px-2 py-1 */
            border-radius: 9999px; /* rounded-full */
            font-weight: 700; /* font-bold */
        }
       
        .badge-top10 {
            position: absolute;
            top: 0.25rem; /* top-1 */
            right: 0.25rem; /* right-1 */
            background-color: #dc2626; /* bg-red-600 */
            color: #ffffff;
            font-size: 0.75rem; /* text-xs */
            padding: 0.05rem 0.5rem; /* px-2 py-1 */
            border-radius: 9999px; /* rounded-full */
            font-weight: 700; /* font-bold */
        }

        .badge-bottom {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: rgba(0, 0, 0, 0.7); /* bg-black bg-opacity-70 */
            color: #ffffff;
            text-align: center;
            font-size: 0.75rem; /* text-xs */
            padding: 0.25rem 0; /* py-1 */
        }

        /* Home Section Specifics */
        .home-top-nav {
            display: flex;
            padding-left: 3%;
            text-wrap: nowrap;
            overflow-x: auto;
            scrollbar-width: none
            align-items: center;
            justify-content: flex-start; /* Changed to flex-start for left alignment */
            gap: 0.88rem; /* space-x-4 */
            margin-bottom: 0.8rem; /* mb-6 */
        }

        .home-top-nav button {
            padding: 0.5rem 0.9rem; /* px-4 py-2 */
            text-wrap: nowrap;
            border-radius: 9999px; /* rounded-full */
            background-color: transparent; /* Changed to transparent */
            border: 1px solid #ffffff; /* Added white border */
            color: #ffffff;
            font-size: 0.8rem; /* text-sm */
            font-weight: 500; /* font-medium */
            display: flex;
            align-items: center;
            gap: 0.25rem; /* space-x-1 */
        }

        .featured-content {
            position: relative;
            width: 100%;
            border-radius: 0.5rem; /* rounded-lg */
            overflow: hidden;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            margin-bottom: 2rem; /* mb-8 */
        }

        .featured-content img {
            width: 100%;
            height: auto;
            object-fit: cover;
            border-radius: 0.5rem; /* rounded-lg */
        }

        .featured-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(to top, #000, transparent);
            padding: 1rem;
        }

        .featured-series-info {
            display: flex;
            align-items: center;
            gap: 0.25rem; /* space-x-1 */
            margin-bottom: 0.5rem; /* mb-2 */
        }

        .featured-series-n {
            color: #dc2626; /* text-red-600 */
            font-weight: 700; /* font-bold */
            font-size: 0.875rem; /* text-sm */
        }

        .featured-series-text {
            color: #ffffff;
            font-size: 0.75rem; /* text-xs */
            font-weight: 600; /* font-semibold */
        }

        .featured-title {
            color: #ffffff;
            font-size: 1.5rem; /* text-2xl */
            font-weight: 700; /* font-bold */
            margin-bottom: 0.5rem; /* mb-2 */
        }

        .featured-description {
            color: #d1d5db; /* text-gray-300 */
            font-size: 0.875rem; /* text-sm */
            margin-bottom: 1rem; /* mb-4 */
        }

        .featured-buttons {
            display: flex;
            gap: 0.75rem; /* space-x-3 */
        }

        .featured-button {
            display: flex;
            align-items: center;
            gap: 0.5rem; /* space-x-2 */
            padding: 0.5rem 1.25rem; /* px-5 py-2 */
            border-radius: 0.5rem; /* rounded-lg */
            font-weight: 600; /* font-semibold */
        }

        .featured-button.play {
            background-color: #ffffff;
            color: #000000;
        }

        .featured-button.my-list {
            background-color: #4b5563; /* bg-gray-600 */
            color: #ffffff;
        }

        .featured-button svg {
            width: 1.25rem; /* w-5 */
            height: 1.25rem; /* h-5 */
            stroke-width: 2;
        }

        .recommended-grid {
            display: grid;
            grid-template-columns: repeat(2, minmax(0, 1fr));
            gap: 0.75rem; /* gap-3 */
            margin-bottom: 2rem; /* mb-8 */
        }

        .recommended-item {
            background-color: #dc2626; /* bg-red-600 */
            padding: 1rem;
            border-radius: 0.5rem; /* rounded-lg */
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: #ffffff;
            font-weight: 600; /* font-semibold */
        }
        .recommended-item.gray {
            background-color: #374151; /* bg-gray-700 */
        }


        /* New & Hot Section Specifics */
        .new-hot-top-nav {
            display: flex;
            align-items: center;
            justify-content: flex-start;
            gap: 0.75rem; /* space-x-3 */
            margin-bottom: 1.5rem; /* mb-6 */
            overflow-x: auto;
        }

        .new-hot-top-nav button {
            padding: 0.5rem 1rem; /* px-4 py-2 */
            border-radius: 9999px; /* rounded-full */
            background-color: #374151; /* bg-gray-700 */
            color: #ffffff;
            font-size: 0.875rem; /* text-sm */
            font-weight: 500; /* font-medium */
            display: flex;
            align-items: center;
            gap: 0.25rem; /* space-x-1 */
            flex-shrink: 0;
        }

        .new-hot-top-nav button svg {
            width: 1rem; /* w-4 */
            height: 1rem; /* h-4 */
        }

        .new-hot-top-nav button .text-orange-400 { color: #fb923c; }
        .new-hot-top-nav button .text-green-400 { color: #4ade80; }
        .new-hot-top-nav button .text-blue-400 { color: #60a5fa; }
        .new-hot-top-nav button .text-red-600 { color: #dc2626; }


        .coming-soon-item {
            margin-bottom: 2rem; /* mb-8 */
        }

        .coming-soon-item img {
            width: 100%;
            height: auto;
            object-fit: cover;
            border-radius: 0.5rem; /* rounded-lg */
            margin-bottom: 1rem; /* mb-4 */
        }

        .coming-soon-info {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 0.5rem; /* mb-2 */
        }

        .coming-soon-type {
            display: flex;
            align-items: center;
            gap: 0.25rem; /* space-x-1 */
        }

        .coming-soon-n {
            color: #dc2626; /* text-red-600 */
            font-weight: 700; /* font-bold */
            font-size: 0.875rem; /* text-sm */
        }

        .coming-soon-label {
            color: #ffffff;
            font-size: 0.75rem; /* text-xs */
            font-weight: 600; /* font-semibold */
        }

        .coming-soon-rating {
            color: #ffffff;
            font-size: 0.75rem; /* text-xs */
            padding: 0.05rem 0.5rem; /* px-2 py-1 */
            background-color: #374151; /* bg-gray-700 */
            border-radius: 9999px; /* rounded-full */
        }

        .coming-soon-title {
            color: #ffffff;
            font-size: 1.25rem; /* text-xl */
            font-weight: 700; /* font-bold */
            margin-bottom: 0.5rem; /* mb-2 */
        }

        .coming-soon-date {
            color: #9ca3af; /* text-gray-400 */
            font-size: 0.875rem; /* text-sm */
            margin-bottom: 1rem; /* mb-4 */
        }

        .coming-soon-description {
            color: #d1d5db; /* text-gray-300 */
            font-size: 0.875rem; /* text-sm */
            margin-bottom: 1rem; /* mb-4 */
        }

        .remind-me-button {
            display: flex;
            align-items: center;
            gap: 0.5rem; /* space-x-2 */
            background-color: #4b5563; /* bg-gray-600 */
            color: #ffffff;
            padding: 0.5rem 1.25rem; /* px-5 py-2 */
            border-radius: 0.5rem; /* rounded-lg */
            font-weight: 600; /* font-semibold */
            border: none;
            cursor: pointer;
        }

        .remind-me-button svg {
            width: 1.25rem; /* w-5 */
            height: 1.25rem; /* h-5 */
            stroke-width: 2;
        }

        /* Bottom Navigation Bar */
        .bottom-nav {
            background-color: #000000; /* Changed to pure black */
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            z-index: 50;
            padding: 0.5rem; /* p-2 */
            display: flex;
            justify-content: space-around;
            align-items: center;
            box-shadow: 0 -4px 6px -1px rgba(0, 0, 0, 0.1), 0 -2px 4px -1px rgba(0, 0, 0, 0.06);
        }

        .nav-button {
            display: flex;
            flex-direction: column;
            align-items: center;
            color: #ffffff;
            font-size: 0.75rem; /* text-xs */
            font-weight: 500; /* font-medium */
            opacity: 0.5; /* opacity-50 */
            background: none;
            border: none;
            cursor: pointer;
            padding: 0.25rem;
        }

        .nav-button.active {
            opacity: 1; /* opacity-100 */
        }

        .nav-button svg {
            width: 1.5rem; /* w-6 */
            height: 1.5rem; /* h-6 */
            margin-bottom: 0.25rem; /* mb-1 */
            stroke-width: 2;
        }

        /* Custom Home Icon Style */
        .home-icon {
            width: 22px;
            height: 22px;
            background: currentColor; /* Uses the current text color */
            clip-path: polygon(50% 0%, 0% 40%, 0% 100%, 100% 100%, 100% 40%);
            margin-bottom: 0.25rem; /* To match the spacing of other icons */
        }

        /* Default Profile Section for My WatchOut */
        .default-profile-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding-top: 2px;
            gap: 1rem; /* space-y-4 */
        }

        .default-profile-avatar {
            width: 4.4rem; 
            aspect-ratio: 1;
            border-radius: 0.5rem; /* squared with rounded corners */
            border: 2px solid #3b82f6; /* border-2 border-blue-500 */
            object-fit: cover;
        }

        .default-profile-name {
            color: #ffffff;
            font-size: 1.25rem; /* text-xl */
            font-weight: 600; /* font-semibold */
        }
  .model-poster{width:100%;height:auto;aspect-ratio:16/9} .header{height:60px;} 
  .border-t{
    height: 70px;
    margin: 0 4%;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-top: #fff 1px solid;}
  
  .space-x-2{display: flex;
    align-items: center;
    flex-direction: row;
    gap: 7px;}
  .h-4{height: 23px;
    padding-top: 1px;}
  .text-xs{color:#fff;text-wrap-mode: nowrap;border-left:1px solid #fff; white-space: nowrap;padding-left:7px;}
.item-post h1.entry-title,#breadcrumb,#bottom-ad-placeholder{display:none}.unique-container{width:100%;padding:0;background:var(--unique-container-bg);box-shadow:var(--unique-box-shadow)}.unique-poster{margin-bottom:0;position:relative}.model-poster img{width:100%;height:auto;border-radius:10px;object-fit:cover}.unique-poster::after{content:&#39;&#39;;position:absolute;bottom:0;left:0;width:100%;height:30%;background:linear-gradient(to bottom,rgba(0,0,0,0)0%,rgba(0,0,0,0.85)100%);border-radius:0 0 10px 10px}.Model-logo{text-align:left;margin-top:5px}.Model-logo img{height:20px;width:auto;opacity:1}.model-title{text-align:left;margin-top:5px;font-size:30px;font-weight:bold;color:#fff}.model-overview {font-size:14px;display:flex;align-items: center;color:white;}.model-rating{font-size:9px;margin-right:8px;background:#4d4d4d;padding:2px 3px;border-radius:2px}.model-year-rating span{vertical-align:middle;display:inline}.model-cast,.model-creator{font-size:13px;font-weight:500;color:#898383}.model-rating-box{text-align:center;font-size:11px;margin:15px 0}.ion-align-items-center{align-items:center!important;display:flex;flex-wrap:wrap}.model-rating-box .btn-vertical{display:flex;flex-direction:column;align-items:center}.model-rating-box .btn-vertical .btn{margin-top:3px;color:#8c8b8b}.play-button{display:block;margin-top:5px;padding:10px 30px;font-size:16px;font-weight:bold;color:#000;background:#fff;border:0;border-radius:5px;cursor:pointer;text-align:center;text-decoration:none}.play-button:hover{background:#f0f0f0}.iframe-container{position:relative;width:100%;padding-bottom:56.25%;height:0;overflow:hidden}.iframe-container iframe{position:absolute;top:0;left:0;width:100%;height:100%;border:0}@media (min-width:1000px){.play-button{display:inline-block}}@media (max-width:640px){.episode-thumbnail,.unique-episode a,.unique-episode a img{width:120px!important;height:67px!important}}
</style>
    
<!-- Series Layout Uncommon CSS -->
<style>  html, body {
  overflow-x: hidden;
}
html.rtl {
--body-font: 'Cairo',Arial,sans-serif;
--meta-font: 'Cairo',Arial,sans-serif;
--title-font: 'Cairo',Arial,sans-serif;
--text-font: 'Cairo',Arial,sans-serif;
}   
.episodes-container{display:flex;flex-direction:column;gap:10px}.episode-item{display:flex;align-items:center;gap:10px;padding-bottom:15px;border-radius:0;color:#fff;font-size:16px;border-bottom:1px solid #444}.episode-item:hover{background:#333}.episode-thumbnail{width:200px;height:110px;object-fit:cover;border-radius:5px;margin:15px 0 0 15px}.episode-content{display:flex;align-items:center;gap:10px}.episode-content a{font-size:13px;font-weight:bold;margin-bottom:5px;text-overflow:ellipsis;overflow:hidden;text-align:left}.episodes-heading{text-align:left;margin:20px 0 5px;font-size:22px;font-weight:bold;color:#fff;display:flex;justify-content:space-between;align-items:center}.season-button{padding:12px 30px;font-size:16px;font-weight:bold;color:#fff;background:#2b2a33;border:1px solid #404040;border-radius:5px;cursor:pointer;text-align:center}.season-button:hover{background:#2b2a33}.unique-episodes{display:flex;flex-direction:column;overflow-y:auto;border:1px solid #444;border-radius:10px}.unique-episode{display:flex;align-items:center;gap:10px;padding-bottom:15px;border-bottom:1px solid #444}.unique-episode:last-child{padding-bottom:0;border-bottom:0}.unique-episode a img{width:200px;height:110px;object-fit:cover;border-radius:5px;flex-shrink:0}.unique-episode .episode-text{display:flex;flex-direction:column;flex-grow:1;margin-top:0}.unique-episode a{text-decoration:none;color:#fff;font-weight:bold;margin:0;height:110px}.unique-episode a:hover{text-decoration:underline}   

:root{
--netflix-font-stack: 'Netflix Sans', 'Helvetica Neue', Helvetica, Arial, sans-serif;
--body-font:'$(main.font.family)', Arial, sans-serif;
--title-font:'$(title.font.family)', Arial, sans-serif;
--meta-font:'$(meta.font.family)', Arial, sans-serif;
--text-font:'$(text.font.family)', Arial, sans-serif;
--text-font-color:$(text.post.inner);
--runs-solid-color:#c1bbbb;
--black-color:#404040;
--hero-color:#aaaaaa;
--main-menu-bg:$(main.menu.bg);
--snippet-color:#aba4a4;
--solid-border:#ddd;
--top-bar:$(top.bar);
--featured-posts-title:$(featured.posts.title);
--button-bg-color:$(main.button.color);
--button-text-color:$(main.button.text.color);
--lables-buttons-color:$(lables.buttons.color);
--lables-text-color:$(lables.text.color);
--bg-bt-bar:$(bg.bt.bar);
--email-bg-color:$(email.bg.color);
--email-text-color:$(email.text.color);
--cloud-bg-color:$(cloud.bg.color);
--cloud-border-color:$(cloud.bg.color);
--list-text-color:$(list.text.color);
--theme-text-color:$(theme.text.color);
--featured-gadgets-title:$(featured.gadgets.title);
--placeholder-text-color:#3e3e3e;
--main-menu-text-color:$(main.menu.text.color);
--sub-menu-text-color:$(sub.menu.text.color);
--footer-title-color:$(footer.title.color);
--footer-copyright-bg:$(footer.copyright.bg);
--body-color-main:$(body.background);
--all-link-color:#0093ff;
--black-text:#000000;
--main-text-color:$(main.text.color);
--mobile-menu-bg:$(mobile.menu.bg.color);
--top-menu-text:$(top.bar.menufont);
--white-bg:#ffffff;
--block-bg:#ffffff;
--featured-posts-title-featured:#ffffff;
--white-label-color:#ffffff;
--bg-cards:#ffffff;
--bg-cards-video:#121212;
--bg-cards-shadow:-1px 7px 10px 0 rgb(0 0 0 / 0.06);
--bt-breaking:rgba(0 0 0 / 0.08);
--bt-breaking-text:#626262;
--shadow-top:0 0 20px rgba(0,0,0,.15);
--shadow-top-fixed:5px 5px 8px 0px rgba(224 223 223 / 0.48);
--ads-bg:rgb(143 183 255 / 0.20);
--ads-text:#898989;
--buttons-category-text:#1d1d1d;
--snip-text-color:#eeeeee;
--search-bt-text:#626262;
--comments-dec:#333;
--sticky-bg:#f1f1f1;
--input-form:transparent;
--bt-home:#f2f7fb;
--cm-count:#555555;
--lixXO-navigation-text:#4e4e4e;
--sticky-lists:#f7fcff;
--post-snip-data:#707070;
--post-snip-open:#383838;
--ico-relative:#e60000;
--ico-relative-hover:rgb(0 0 0 / 0.51);
--front-bg-lists:#fff;
--share-author-links:#585858;
--box-posts-share:#f1f1f1;
--title-share:#1c1c1c;
--title-share-fa:#5c5c5c;
--footer-text-color:$(footer.text.color);
--footer-about-text:$(footer.about.color);
--footer-bg-color:$(footer.background.color);
--footer-gadgets-title:$(footer.gadgets.title);
--main-logo-text-color:$(main.logo.text.color);
--submenu-bg-color:$(submenu.background.color);
--comment-content:#f6f6f6;
--comment-text:#5e5e5e;
--label-text-color:#2c2c2c;
--pager-text-color:$(body.text.color);
--back-top:rgb(90 90 90 / 0.18);
--box-shadows:rgb(102 102 102 / 0.13);
}
body.dark{
--main-logo-text-color:#d4d4d4;
--all-link-color:rgba(255,255,255,.7);
--body-color-main:#1e1b1b;
--main-menu: #383838;
--text-font-color:#e3e3e3;
--shadow-top:none;
--top-bar:#2d2d2d;
--cloud-border-color:rgb(100 100 100 / 0.66);
--cloud-bg-color:#ffffff;
--mobile-menu-bg:#212121;
--input-form:rgb(112 112 112 / 0.34);
--shadow-top-fixed:none;
--white-label-color:#464646;
--search-bt-text:#b5b5b5;
--main-menu-text-color:#dadada;
--sub-menu-text-color:#dadada;
--title-share:#dddddd;
--black-color:#d9d9d9;
--title-share-fa:#dddddd;
--front-bg-lists:#292929;
--box-shadows:transparent;
--bt-home:#212121;
--sticky-lists:#212121;
--main-menu-bg:#232323;
--post-snip-open:#eee;
--footer-gadgets-title:#c3c3c3;
--footer-title-color:#adadad;
--sticky-bg:#212121;
--placeholder-text-color:#dadada;
--theme-text-color:#dadada;
--featured-gadgets-title:#dadada;
--ads-bg:#212121;
--box-posts-share:#323232;
--submenu-bg-color:#212121;
--label-text-color:#a1a1a1;
--featured-posts-title: #c3c3c3;
--ads-text:#dadada;
--buttons-category-text:#dadada;
--bg-cards:#212121;
--block-bg:#3a3a3a;
--black-text:#f3f8fb;
--post-snip-data:#a5a5a5;
--comments-dec:#cecece;
--comment-content:#353535;
--comment-text:#c1c1c1;
--footer-bg-color:#181818;
--footer-text-color:#E4E4E4;
--cm-count:#E4E4E4;
--main-text-color:#E4E4E4;
--lixXO-navigation-text:#c3c3c3;
--share-author-links:#E4E4E4;
--footer-copyright-bg:#292929;
}
a,abbr,acronym,address,applet,b,big,blockquote,body,caption,center,cite,code,dd,del,dfn,div,dl,dt,em,fieldset,font,form,h1,h2,h3,h4,h5,h6,html,i,iframe,img,ins,kbd,label,legend,li,object,p,pre,q,s,samp,small,span,strike,strong,sub,sup,table,tbody,td,tfoot,th,thead,tr,tt,u,ul,var{padding:0;border:0;outline:0;vertical-align:baseline;background:0;margin:0;text-decoration:none;}
form,textarea,input,button{-webkit-appearance:none;-moz-appearance:none;appearance:none;border-radius:0;box-sizing:border-box}
.CSS_LIGHTBOX{z-index:999999!important}.CSS_LIGHTBOX_ATTRIBUTION_INDEX_CONTAINER .CSS_HCONT_CHILDREN_HOLDER > .CSS_LAYOUT_COMPONENT.CSS_HCONT_CHILD:first-child > .CSS_LAYOUT_COMPONENT{opacity:0}
input,textarea{outline:none}
/*! normalize.css v3.0.1 | MIT License | git.io/normalize */
dl,ul{list-style-position:inside;font-weight:400;list-style:none}
button{cursor: pointer;outline: none;}
ul li{list-style:none}
caption,th{text-align:center}
html,body{text-size-adjust:none;-webkit-text-size-adjust:none;-moz-text-size-adjust:none;-ms-text-size-adjust:none}
.separator a{clear:none!important;float:none!important;margin-left:0!important;margin-right:0!important}
#Navbar1,#navbar-iframe,.widget-item-control,a.quickedit,.home-link,.feed-links{display:none!important}
.center{display:table;margin:0 auto;position:relative}
.widget > h2,.widget > h3{display:none}
.widget iframe,.widget img{max-width:100%}
.container{position:relative;max-width: 100%;width:;}
.center{display:table;margin:0 auto;position:relative}
img{border:0;position:relative}
a,a:visited{text-decoration:none}
.clearfix{clear:both}
.section,.widget,.widget ul{margin:0;padding:0}
a{color:var(--all-link-color)}
a img{border:0}
abbr{text-decoration:none}
.widget>h2,.widget>h3{display:none}
*:before,*:after{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;}
/*-- CSS Variables --*/
.no-items.section{display:none}
h1,h2,h3,h4,h5,h6{font-family:var(--netflix-font-stack);font-weight:500}
body{position:relative;background:#000000;font-family:var(--netflix-font-stack);font-size:14px;font-weight:400;color:var(--black-text);word-wrap:break-word;margin:0;padding:0;font-style:normal;line-height:1.2}
#outer-wrapper{position:relative;overflow:hidden;width:100%;max-width:100%;margin:0 auto}
.home #Blog1 {display:none;}

.outer-container {
    display: flex;
    justify-content: space-between;
    width: 100%;
}

h1{font-size:26px;line-height:28px}
h3{font-size:22px;line-height:21px}
h4{font-size:20px;line-height:18px}
h5{font-size:16px;line-height:16px}
h6{font-size:13px;line-height:13px;margin-bottom:0;margin-top:0}
@media only screen and (min-width:1025px){h1{font-size:42px;line-height:46px}
h2{font-size:36px;line-height:40px}
h3{font-size:28px;line-height:35px}
h4{font-size:21px;line-height:26px}
}
.post-body h1{font-size:28px}
.post-body h2{font-size:24px}
.post-body h3{font-size:21px}
.post-body h4{font-size:18px}
.post-body h5{font-size:16px}
.post-body h6{font-size:13px}
.dark .post-body p{background:transparent!important;color:#fff!important}
#center-container{position:relative;float:left;width:100%;overflow:hidden;padding:0px 0 0;margin:0}

}
</style>

    <style>

.download-btn{display: block;
    margin-top: 5px;
    padding: 12px 30px;
    font-size: 18px;
    font-weight: bold;
    color: #ffffff;
    background-color: rgb(55, 55, 55);
    border: none;
    border-radius: 5px;
    cursor: pointer;
    text-align: center;
    text-decoration: none;
}     
  
   #container-f193ef3eaf1b3f057f14b51de2fad403 .container-f193ef3eaf1b3f057f14b51de2fad403__stand {background: #000000;}
      
    #search-space{position: fixed;
    top: 0px;
    left: 0px;
    width: 100%;
    height: 100%;
    background-color: black;
    color: white;
    z-index: 4;
    padding: 20px;
    overflow: hidden;
    box-sizing: border-box;
    display: none;
    right: 0;
    bottom: 0;
}

 .search-hidden {
    display: !important;
}

.search-visible {
    display: block !important;
}     
      
    
    
  
      .rank-number {
    font-size: 100px;
    position: relative;
    -webkit-text-stroke-width: 3px;
    -webkit-text-stroke-color: #ffffff;
    z-index: 2;
    color: #000000;
    margin-right: -16px;
}
    .model-title {
      text-align: left;
      margin-top: 5px;
      font-size: 27px;
      font-weight: bold;
      color: #fff;
    }
    
    .model-overview {
    font-size: 14px;
    color: white; /* Text color changed to white */
    margin-top: 5px;
    }
    .model-year-rating {
    font-size: 13px;
    display: flex;
    font-weight: 400;
    color: #bcbcbc; /* Text color changed to white */
    margin-top: 5px;
    }
    .model-rating { 
    font-size: 9px;
    margin-right: 8px;
    background: #4d4d4d;
    padding: 0px 2px;
    border-radius: 2px;
    }

    .model-year {
    font-size: 14px;
    color: #bcbcbc; /* Text color changed to white */
    margin-right:8px;
    }
    .model-year-rating span {
    vertical-align: middle;
    display: inline;
    }    
    
    .model-cast {
    font-size: 13px;
    font-weight: 500;
    color: #898383; /* Text color changed to white */
    }
    .model-creator {
    font-size: 13px;
    font-weight: 500;
    color: #898383; /* Text color changed to white */
    }
    .model-rating-box {
    text-align: center;
    font-size: 11px;
    margin: 15px 0;
}
    .ion-align-items-center {
    align-items: center !important;
    display: flex
;
    flex-wrap: wrap;
}  
    .model-rating-box .btn-vertical {
    display: flex
;
    flex-direction: column;
    align-items: center;
}
    .model-rating-box .btn-vertical .btn {
    margin-top: 3px;
    color: #8c8b8b;
}
    .episodes-season-heading {
    text-align: left;
    margin-top: 20px;
    margin-bottom: 5px;
    font-size: 22px;
    font-weight: bold;
    color: #fff;
    display: flex;
    justify-content: space-between;
    align-items: center;
}
    
@media only screen and (min-width: 600px) {
  .tag-division {
    display: none !important;
  }
}
    .play-button {
      margin-top: 15px;
      padding: 12px 30px;
      font-size: 16px;
      font-weight: bold;
      color: #000;
      border-radius:50px;
      background-color: #fff;
      border: none;
      cursor: pointer;
      text-align: center;
      text-decoration: none;
    }

    .play-button:hover {
      background-color: #f0f0f0;
    }

    .episodes-heading {
      text-align: left;
      margin-top: 20px;
      margin-bottom: 5px;
      font-size: 22px;
      font-weight: bold;
      color: #fff;
    }


    .unique-episode {
      display: flex;
      align-items: center;
      gap: 10px;
      padding-bottom: 15px;
      border-bottom: 1px solid #444;
    }

    .unique-episode:last-child {
      padding-bottom: 0;
      border-bottom: none;
    }

    .unique-episode a img {
      width: 200px;
      height: 110px;
      object-fit: cover;
      border-radius: 5px;
      flex-shrink: 0;
    }

    .unique-episode .episode-text {
      display: flex;
      flex-direction: column;
      flex-grow: 1;
      margin-top: 0;
    }
    
    .episodes-heading {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.season-button {
  padding: 12px 30px; /* Match play button padding */
  font-size: 16px; /* Match play button font size */
  font-weight: bold;
  color: #000;
  background-color: #fff;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  text-align: center;
}

/* Optional: Add hover effect similar to play button */
.season-button:hover {
  background-color: #f0f0f0;
}


    .unique-episode a {
      text-decoration: none;
      color: #fff;
      font-weight: bold;
      margin: 0;
      height: 110px;
    }

    .unique-episode a:hover {
      text-decoration: underline;
    }

    @media (max-width: 600px) {
      .unique-episode a { 
        width: 120px;
        height:67px;}
      .unique-episode a img {
        width: 120px;
        height: 67px;
      }
         
   }   
      
      
      
      
      
      
      
      
.series-overview {
    font-size: 13px;
    font-weight: 500;
    color: white; /* Text color changed to white */
    margin-top: 5px;
    }
    .series-year-rating {
    font-size: 13px;
    font-weight: 500;
    color: white; /* Text color changed to white */
    margin-top: 5px;
    }
    .series-year {
    font-size: 14px;
    color: white; /* Text color changed to white */
    margin-top: 5px;
    }
    .series-cast {
    font-size: 13px;
    font-weight: 500;
    color: #898383; /* Text color changed to white */
    }
    .series-creator {
    font-size: 13px;
    font-weight: 500;
    color: #898383; /* Text color changed to white */
    }      

.cards-section{
  padding-bottom: 30px;
  position: relative;
  }
.cards-section h2{
  font-size: 1.35em; /* text-2xl */
        color: #ffffff;
        padding-left: 4%;
        font-weight: 800; /* font-bold */
        padding-bottom: 0.55rem;
  }
.cards-container{
    scrollbar-width: none;
    padding-left: 4%;
    overflow-x: auto;
    overflow-y: hidden;
    display: flex;
    gap: 0.5rem;
}
.card{
    flex-shrink: 0;
    cursor: pointer;
    background-color: #000000;
    border-radius: 4px;
    overflow: hidden;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    width: 29.22%;
    aspect-ratio: 2 / 2.8;
}
.card img {
          display: block; /* Ensure image takes full width */
          width: 100%; /* w-full */
          height: auto; /* h-auto */
          object-fit: fill; /* object-cover */
      }
  
@media screen and (max-width:900px){
  .header-nav-links {display:none;}
}
/* Profile Screen CSS */
      .profile-screen {
    position: fixed;
	margin-top:155px;
    background-color: transparent;
    left: 0;
    right: 0;
    bottom: 0;
    opacity: 0;
	animation: fade-in 500ms ease 200ms 1 forwards;
    z-index: 99999;
}

.text h1 {
    display: flex;
    justify-content: center;
    font-family: sans-serif;
    color: white;
    font-size: 45px;
}

.select_users {
    display: flex;
    justify-content: center;
    margin-top: 15px;
}

.users-img img {
    width: 135px;
    cursor: pointer;
    border: transparent 3px solid;
    border-radius: 5px;
}

.users-text p {
    font-size: 18px;
    text-align: center;
    color: white;
    font-family: sans-serif;
    margin-top: 10px;
    color: gray;
}    

.user-one {
    margin: 0px 15px;
}

.user-two {
    margin: 0px 15px;
}

.user-three {
    margin: 0px 15px;
}

.user-kids {
    margin: 0px 15px;
}

.add-profile {
    /*width: 135px;*/
    margin: 0px 15px 30px 15px;
}

.img-addProfile {
    width: 135px;
}

.img-addProfile img {
    width: 100%;
}

.add-profile p {
    font-size: 18px;
    text-align: center;
    color: white;
    font-family: sans-serif;
    margin-top: 14px;
    color: gray;
}

.content-manageProfile {
    display: flex;
    justify-content: center;
    margin-top: 40px;
}

.manageProfile {
    display: flex;
    justify-content: center;
    align-items: center;
    color: gray;
    /*width: 240px;*/
    /*height: 36px;*/
    border: 1px solid gray;
    font-size: 1.2vw;
    font-family: 'NETFLIX SANS';
    padding: .5em 1.5em;
    text-decoration: none;
    /*text-transform: uppercase;*/
    letter-spacing: 2px;
}

.userIt-hv:hover > div > img {
    /*width: 129px;*/
    border: 3px solid white;
}

.userIt-hv:hover p {
    color: lightgray;
}

.add-profile:hover > .img-addProfile {
    background-color: lightgray;
}

.add-profile:hover p {
    color: lightgray;
}

.manageProfile:hover {
    color: white;
    border: 1px solid white;
}
.select_users_wrapper{
	position:relative;
}
.curved-bg {
    position: absolute;
    top: 56px;
    left: 50%;
    transform: translateX(-50%);
    width: 250%;
    height: 100vh;
    background: #1d1d1d;
    -webkit-backdrop-filter: blur(25px);
    border-radius: 50% 50% 0 0;
    box-shadow: 0px -20px 90px 100px rgb(0 0 0);
}
</style>
  
</head>

<body>
	<div class="profile-screen-wrapper" style="background-color: rgb(20, 20, 20);z-index:9999;position:fixed;width:100vw;height:100vh;">
	<div class="profile-spotlight" style="animation: fade-in 500ms ease 200ms 1 forwards;">
	
	</div>	
  <div class="profile-screen">
	<div class="curved-bg"></div>
    </nav>
  <div class="text" style="position:relative;">
    <h1>Whoâ€™s watching?</h1>
  </div>
<div class="select_users_wrapper">
  <div class="select_users">
    <div class="user-one users-text userIt-hv">
      <a class="user-one users-img">
        <img src="https://occ-0-1356-559.1.nflxso.net/dnm/api/v6/K6hjPJd6cR6FpVELC5Pd6ovHRSk/AAAAFODe-79HMte1GvxsxPzvEhS4oamceVNh3isrrNF3kcraRbsL9uOcrH0MyKtlmWkLJyKJIxId66coocNnpINTOKpTcQ.png?r=f08" alt="user icon">
        <p>Person 1</p>
      </a>
    </div>

    <div class="user-two users-text userIt-hv">
      <a class="userTwo-img users-img">
        <img src="https://occ-0-1356-559.1.nflxso.net/dnm/api/v6/K6hjPJd6cR6FpVELC5Pd6ovHRSk/AAAAFH0VbIGycnpOMaFT5ER1erOVKsxpCLYnZF0-sxIK15G0mY7z7RnNlEEiRFGOOBCJcyB2CEibnXtHsXwNqmcCGg-XlQ.png?r=9fe" alt="user icon">
      </a>
      <p>Person 2</p>
    </div>

    <div class="user-three users-text userIt-hv">
      <a class="userThree-img users-img">
        <img src="https://occ-0-1356-559.1.nflxso.net/dnm/api/v6/K6hjPJd6cR6FpVELC5Pd6ovHRSk/AAAAFM5PrJX0TiFgfm4HOoS76PWmofnZtjwSQQj-dPSEdzfCr8p8wNhjBwMybzmLIAGotByD810aYhO6nG8N8FMUoXG-sg.png?r=ab" alt="user icon">
      </a>
      <p>Person 3</p>
    </div>
  </div>
  <div class="select_users">
    <div class="user-kids users-text userIt-hv">
      <a class="userKids-img users-img">
        <img src="https://occ-0-4345-3647.1.nflxso.net/dnm/api/v6/vN7bi_My87NPKvsBoib006Llxzg/AAAABdRpy5qGCmYWEf6vIIQyFF4vnbPhdKeGCpEW6pQwvcEqZF4VUfDc25mHHWax4zIHnLOS3jvfDy16TlSgLgTWpiXsigETnQ9JwpPq.png?r=6fb" alt="kids icon">
      </a>
      <p>Kids</p>
    </div>

    <div class="add-profile">
      <div class="img-addProfile">
        <img src="https://i.imgur.com/zYfjSjj.png" alt="add profile">
      </div>
      <p>Add Profile</p>
    </div>
  </div>
</div>

  <div class="content-manageProfile">
    <a href="#" class="manageProfile">Manage Profiles</a>
  </div>
 </div>  
</div>
  <script>
  document.querySelectorAll('.users-img').forEach(user => {
    user.addEventListener('click', () => {
      document.querySelector('.profile-screen-wrapper').style.display = 'none';
    });
  });
</script>

  
  <div class="netflix-sans-font-loaded __web-inspector-hide-shortcut__">
    <!-- Main container -->
    <div class="min-h-screen flex flex-col">
      <div class="headers" style="display: flex; flex-direction: column; background: transparent; position: fixed; top: 0; left: 0; right: 0; z-index: 55;">
        <header class="header">
          <div class="header-left" style="display: flex; align-items: center; gap: 0.5rem; padding-left: 4%;" bis_skin_checked="1">
                <!-- Updated Netflix Logo - inline style removed, CSS class handles height -->
                <a href="https://cinexa.icu/" style="
    display: flex;
    align-items: flex-start;
"><img id="header-logo-img" src="/icons/header-logo.png" style="height: 30px;margin-right: 5px;">
</a>
                <span class="header-title" id="header-title"></span> <!-- Changed to empty text content -->
                <nav id="header-nav-links" class="header-nav-links">
                    <a  class="header-nav-link" onclick="renderHomeSections()">Home</a>
                    <a  class="header-nav-link" onclick="renderMovieSections()">Movies</a>
                    <a  class="header-nav-link" onclick="renderTVSections()">TV Shows</a>
                    <a  class="header-nav-link" onclick="renderAnimeSections()">Anime</a>
                    <a  class="header-nav-link" onclick="renderMyListSections()">My List</a>
                </nav>
            </div>
          <div class="header-right">
          <div id="tmdb-search-wrapper">
              <div id="tmdb-search-container" class="collapsed">
                  <div id="tmdb-input-wrapper">
                      <div class="tmdb-search-icon">
                          <svg height="100" style="height: 20px; width: 20px;" viewBox="0,0,256,256" width="100" xmlns="http://www.w3.org/2000/svg">
                             <g fill="#ffffff" fill-rule="nonzero" stroke="none" style="mix-blend-mode: normal">
                               <g transform="scale(8.53333,8.53333)">
                                 <path d="M13,3c-5.511,0 -10,4.489 -10,10c0,5.511 4.489,10 10,10c2.39651,0 4.59738,-0.85101 6.32227,-2.26367l5.9707,5.9707c0.25082,0.26124 0.62327,0.36648 0.97371,0.27512c0.35044,-0.09136 0.62411,-0.36503 0.71547,-0.71547c0.09136,-0.35044 -0.01388,-0.72289 -0.27512,-0.97371l-5.9707,-5.9707c1.41266,-1.72488 2.26367,-3.92576 2.26367,-6.32227c0,-5.511 -4.489,-10 -10,-10zM13,5c4.43012,0 8,3.56988 8,8c0,4.43012 -3.56988,8 -8,8c-4.43012,0 -8,-3.56988 -8,-8c0,-4.43012 3.56988,-8 8,-8z"></path>
                               </g>
                             </g>
                          </svg>
                      </div>
                      <div class="tmdb-input-field">
                          <input type="text" id="tmdb-search" placeholder="Search movies or series..." autocomplete="off" />
                      </div>
                      <div id="search-clear" class="search-clear-icon" style="display: none;">
                          <svg xmlns="http://www.w3.org/2000/svg" fill="none" role="img" viewBox="0 0 24 24" width="24" height="24" data-icon="MagnifyingGlassStandard" aria-hidden="true" class="search-icon">
                              <path fill-rule="evenodd" clip-rule="evenodd" d="M10.5858 12L2.29291 3.70706L3.70712 2.29285L12 10.5857L20.2929 2.29285L21.7071 3.70706L13.4142 12L21.7071 20.2928L20.2929 21.7071L12 13.4142L3.70712 21.7071L2.29291 20.2928L10.5858 12Z" fill="currentColor"></path>
                          </svg>
                      </div>
                  </div>
                
                  <button id="tmdb-cancel-btn">
                    Cancel
                  </button>
                
              </div>
              <button id="tmdb-toggle-btn" title="Search">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" role="img" viewBox="0 0 24 24" width="24" height="24" data-icon="MagnifyingGlassStandard" aria-hidden="true" class="search-icon">
<path fill-rule="evenodd" clip-rule="evenodd" d="M17 10C17 13.866 13.866 17 10 17C6.13401 17 3 13.866 3 10C3 6.13401 6.13401 3 10 3C13.866 3 17 6.13401 17 10ZM15.6177 17.0319C14.078 18.2635 12.125 19 10 19C5.02944 19 1 14.9706 1 10C1 5.02944 5.02944 1 10 1C14.9706 1 19 5.02944 19 10C19 12.125 18.2635 14.078 17.0319 15.6177L22.7071 21.2929L21.2929 22.7071L15.6177 17.0319Z" fill="currentColor"></path></svg> 
                  </button>
                    <div id="tmdb-search-results">
                    </div>
              </div>
             <!-- The account section is now always visible -->
            <div id="account-section" class="account-section">
                <div class="profile-dropdown">
                    <div class="profile-trigger">
                        <div id="profile-avatar" class="profile-avatar"></div>
                        <div class="dropdown-arrow"></div>
                    </div>
                    
                    <div class="dropdown-menu">
                        <!-- This single item now acts as both Sign In and Sign Out and is the first item -->
                        <a href="#" class="dropdown-item" id="auth-action-item">
                            <!-- Content will be dynamically added by JavaScript -->
                        </a>

                        <!-- Profile name item is now second -->
                        <a href="#" class="dropdown-item">
                            <svg class="dropdown-icon" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                            </svg>
                            <span id="profile-display-name"></span>
                        </a>
                        
                        <!-- Other menu items -->
                        <a href="#" class="dropdown-item">
                            <svg class="dropdown-icon" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.8,11.69,4.8,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z"/>
                            </svg>
                            Account Settings
                        </a>
                        
                        <a href="#" class="dropdown-item">
                            <svg class="dropdown-icon" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                            </svg>
                            Favorites
                        </a>
                        
                        <a href="#" class="dropdown-item">
                            <svg class="dropdown-icon" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                            </svg>
                            Help Center
                        </a>
                    </div>
                </div>
            </div>
         </div>
        </header>
        <div class="sub-header" style="display: none;"><div component="div"><div class="sub-header-wrapper"><div class="aro-gallery-header"><div class="title"></div><div class="aro-genre-details"><span class="genreTitle">Movies</span><div class="subgenres"><div class="ptrack-container"><div class="ptrack-content" data-ui-tracking-context="%7B%22appView%22:%22categorySelector%22,%22usePresentedEvent%22:true%7D" data-tracking-uuid="270a7a57-c109-429d-ac6d-66b3fa37d94b">
          <div label="Genres" cols="3" class="nfDropDown theme-lakira">
            <div class="label" role="button" aria-haspopup="true" tabindex="0" aria-expanded="false" aria-labelledby="profileLanguageDropDown-header">Genres<span class="arrow"></span></div>
            <div role="menu" class="sub-menu theme-lakira">
  <ul class="sub-menu-list multi-column">
  <li><a data-genre="halloween" class="sub-menu-link">Halloween</a></li>
  <li><a data-genre="zodiac" class="sub-menu-link">Your Zodiac Watchlist</a></li>
  <li><a data-genre="hindi" class="sub-menu-link">Hindi</a></li>
  <li><a data-genre="tamil" class="sub-menu-link">Tamil</a></li>
  <li><a data-genre="telugu" class="sub-menu-link">Telugu</a></li>
  <li><a data-genre="malayalam" class="sub-menu-link">Malayalam</a></li>
  <li><a data-genre="english" class="sub-menu-link">English</a></li>
  <li><a data-genre="international" class="sub-menu-link">International</a></li>
  <li><a data-genre="independent" class="sub-menu-link">Independent</a></li>
</ul>

<ul class="sub-menu-list multi-column">
  <li><a data-genre="comedies" class="sub-menu-link">Comedies</a></li>
  <li><a data-genre="action" class="sub-menu-link">Action</a></li>
  <li><a data-genre="romance" class="sub-menu-link">Romance</a></li>
  <li><a data-genre="dramas" class="sub-menu-link">Dramas</a></li>
  <li><a data-genre="thriller" class="sub-menu-link">Thriller</a></li>
  <li><a data-genre="horror" class="sub-menu-link">Horror</a></li>
  <li><a data-genre="scifi" class="sub-menu-link">Sci-Fi</a></li>
  <li><a data-genre="crime" class="sub-menu-link">Crime</a></li>
  <li><a data-genre="fantasy" class="sub-menu-link">Fantasy</a></li>
</ul>

<ul class="sub-menu-list multi-column">
  <li><a data-genre="bollywood" class="sub-menu-link">Bollywood</a></li>
  <li><a data-genre="hollywood" class="sub-menu-link">Hollywood</a></li>
  <li><a data-genre="children-family" class="sub-menu-link">Children &amp; Family</a></li>
  <li><a data-genre="sports" class="sub-menu-link">Sports</a></li>
  <li><a data-genre="award-winning" class="sub-menu-link">Award-Winning</a></li>
  <li><a data-genre="documentaries" class="sub-menu-link">Documentaries</a></li>
  <li><a data-genre="shorts" class="sub-menu-link">Shorts</a></li>
  <li><a data-genre="standup-comedy" class="sub-menu-link">Stand-Up Comedy</a></li>
  <li><a data-genre="anime" class="sub-menu-link">Anime</a></li>
</ul>

</div>
          </div>
        
        </div></div></div><div class="aro-toggle"><button class="aro-row-toggle" aria-label="View in list view" tabindex="0"><svg viewBox="0 0 24 24" width="24" height="24" data-icon="ListMedium" data-icon-id=":r4e:" aria-hidden="true" class="svg-icon svg-icon-rows" xmlns="http://www.w3.org/2000/svg" fill="none" role="img">
<path fill-rule="evenodd" clip-rule="evenodd" d="M24 6H0V4H24V6ZM24 18V20H0V18H24ZM0 13H12V11H0V13Z" fill="currentColor"></path>

</svg></button><div class="aro-grid"><button aria-label="View in grid view" class="aro-grid-toggle" tabindex="0"><svg viewBox="0 0 24 24" width="24" height="24" data-icon="GridFillMedium" data-icon-id=":r4f:" aria-hidden="true" class="svg-icon svg-icon-grid" xmlns="http://www.w3.org/2000/svg" fill="none" role="img">
<path fill-rule="evenodd" clip-rule="evenodd" d="M1 3C0.447715 3 0 3.44772 0 4V10C0 10.5523 0.447715 11 1 11H10C10.5523 11 11 10.5523 11 10V4C11 3.44772 10.5523 3 10 3H1ZM1 13C0.447715 13 0 13.4477 0 14V20C0 20.5523 0.447715 21 1 21H10C10.5523 21 11 20.5523 11 20V14C11 13.4477 10.5523 13 10 13H1ZM13 4C13 3.44772 13.4477 3 14 3H23C23.5523 3 24 3.44772 24 4V10C24 10.5523 23.5523 11 23 11H14C13.4477 11 13 10.5523 13 10V4ZM14 13C13.4477 13 13 13.4477 13 14V20C13 20.5523 13.4477 21 14 21H23C23.5523 21 24 20.5523 24 20V14C24 13.4477 23.5523 13 23 13H14Z" fill="currentColor"></path>

</svg></button></div></div></div></div></div></div></div>
      </div>
        
        <main class="main-section flex-grow pt-16 pb-16" >
            <section id="search-section">
            </section>
            <section id="home-section">
              <!-- Top Navigation for Home -->
                    <div class="home-top-nav">
                        <button onclick="renderTVSections()">TV Shows</button>
                        <button onclick="renderMovieSections()">Movies</button>
                        <button>
                            <span>Categories</span>
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" style="width: 1rem; height: 1rem;">
                                <path stroke-linecap="round" stroke-linejoin="round" d="m19.5 8.25-7.5 7.5-7.5-7.5" />
                            </svg>
                        </button>
                    </div>
          <div id="gms-movie-showcase" class="gms-movie-showcase-container">
    <img id="gms-movie-backdrop" class="gms-movie-backdrop" src="https://image.tmdb.org/t/p/original/h4zVaaJzWexzDps8Cj9MEghQBYa.jpg" alt="Stranger Things" />
    <div class="gms-gradient-overlay" bis_skin_checked="1" style="
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 2; /* Positioned between the backdrop and the content */
            /* The linear gradient has been moved here */
    background: linear-gradient(to top, #000000 0%, rgba(0, 0, 0, 0) 100%);
"></div>
    <div class="spotlight-info">
        <img src="https://image.tmdb.org/t/p/original/3Cs09d7Ajrms5dTGHhRngKCUocy.png" id="gms-movie-logo" class="gms-movie-logo" src="" alt="Movie Logo" style="max-height:200px;" />
        <h2 id="gms-movie-title" class="gms-movie-title">Stranger Things</h2>
        <p id="gms-movie-overview" class="gms-movie-overview">When a young boy vanishes, a small town uncovers a mystery involving secret experiments, terrifying supernatural forces, and one strange little girl.

</p>
        <div class="gms-movie-actions">
            <button onclick="openModal(66732, 'tv')" id="gms-play-button" class="gms-action-button gms-play-button">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" role="img" viewBox="0 0 24 24" width="24" height="24" data-icon="PlayStandard" aria-hidden="true">
                    <path d="M5 2.69127C5 1.93067 5.81547 1.44851 6.48192 1.81506L23.4069 11.1238C24.0977 11.5037 24.0977 12.4963 23.4069 12.8762L6.48192 22.1849C5.81546 22.5515 5 22.0693 5 21.3087V2.69127Z" fill="currentColor"></path>
                </svg>
                Play
            </button>
                <button onclick="openModal(66732, 'tv')" id="gms-more-info-button" class="gms-action-button gms-more-info-button">
                 <svg xmlns="http://www.w3.org/2000/svg" fill="none" role="img" viewBox="0 0 24 24" width="24" height="24" data-icon="CircleIStandard" aria-hidden="true">
<path fill-rule="evenodd" clip-rule="evenodd" d="M12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2ZM0 12C0 5.37258 5.37258 0 12 0C18.6274 0 24 5.37258 24 12C24 18.6274 18.6274 24 12 24C5.37258 24 0 18.6274 0 12ZM13 10V18H11V10H13ZM12 8.5C12.8284 8.5 13.5 7.82843 13.5 7C13.5 6.17157 12.8284 5.5 12 5.5C11.1716 5.5 10.5 6.17157 10.5 7C10.5 7.82843 11.1716 8.5 12 8.5Z" fill="currentColor"></path>

</svg>
                Info
               </button>
            </div>
    </div>
            <div class="embedded-components button-layer" bis_skin_checked="1" style="
    align-items: center;
    bottom: 40px;
    display: flex;
    flex-direction: row;
    justify-content: flex-end;
    position: absolute;
    z-index: 3;
    right: 0;
"><span class="maturity-rating" data-uia="maturity-rating" style="
    align-items: center;
    background-color: rgba(51, 51, 51, .6);
    border: 3px #dcdcdc;
    border-left-style: solid;
    box-sizing: border-box;
    display: flex;
    font-size: 1.1vw;
    height: 2.4vw;
    padding: .5vw 3.5vw .5vw .8vw;
"><span class="maturity-number" style="
    border: 0px;
    /* border: 1px solid hsla(0, 0%, 100%, .4); */
    font-family: Netflix Sans, Helvetica Neue, Segoe UI, Roboto, Ubuntu, sans-serif;
    overflow: hidden;
    padding: 0 .4em;
    text-overflow: ellipsis;
    text-transform: uppercase;
    unicode-bidi: normal /*!rtl:plaintext*/;
    white-space: nowrap;
">U/A 16+</span></span></div>
           </div>

            <div class="cw-container" id="cw-container">
              <h2>Continue Watching</h2>
              <button class="scroll-button left" onclick="scrollLeftHandler('cw-carousel')">â®</button>
              <div class="cw-carousel" id="cw-carousel"></div>
              <button class="scroll-button right" onclick="scrollRightHandler('cw-carousel')">â¯</button>
            </div>




<!-- TMDB Trending Movies Widget -->
<div id="trending-widget" class="cards-section">
  <h2>Trending Movies</h2>
  <button class="scroll-button left" onclick="scrollLeftHandler('trending-movies')">â®</button>
  <div class="cards-container" id="trending-movies"></div>
  <button class="scroll-button right" onclick="scrollRightHandler('trending-movies')">â¯</button>
</div>

<section id="section1"class="cards-section">
</section>

<section id="section2"class="cards-section">
</section>
				
<!-- TMDB Trending TV Shows Widget -->
<div id="trending-tv-widget" class="cards-section">
  <h2>Trending TV Shows</h2>
  <button class="scroll-button left" onclick="scrollLeftHandler('trending-tv-shows')">â®</button>
  <div class="cards-container" id="trending-tv-shows"></div>
  <button class="scroll-button right" onclick="scrollRightHandler('trending-tv-shows')">â¯</button>
</div>
              
<section id="section3"class="cards-section">
</section>

<section id="section4"class="cards-section">
</section>

<section id="section5"class="cards-section">
</section>

<section id="section6"class="cards-section">
</section>   
           
<section id="section7"class="cards-section">
</section>

<section id="section8"class="cards-section">
</section>

<section id="section9"class="cards-section">
</section>

<section id="section10"class="cards-section">
</section>
              
<section id="section11"class="cards-section">
</section>
              

              
<!--  Popular Korean Drama Shows Widget -->
  <div class="kd-container">
  <h2 class="kd-title">Popular Korean Dramas</h2>
  <div class="kd-relative">
    <button class="scroll-button left" onclick="scrollLeftHandler('kd-shows-container')">â®</button>
    <div id="kd-shows-container" class="kd-scroll-container">
      <!-- TV show cards will be injected here -->
    </div>
    <button class="scroll-button right" onclick="scrollRightHandler('kd-shows-container')">â¯</button>
  </div>
  <div id="kd-error-message" class="kd-error"></div>
</div>  


  <!--  Popular Chinese Drama Shows Widget -->            
   <div class="cd-container" >
  <h2 class="cd-title">Popular Chinese Dramas</h2>
  <div class="cd-relative">
    <button class="scroll-button left" onclick="scrollLeftHandler('cd-shows-container')">â®</button>
     <div id="cd-shows-container" class="cd-scroll-container">
      <!-- TV show cards will be injected here -->
    </div>
    <button class="scroll-button right" onclick="scrollRightHandler('cd-shows-container')">â¯</button>
  </div>
  <div id="cd-error-message" class="cd-error"></div>
</div>  
<!--  Popular Japanese Anime Shows Widget -->   
  <div class="ja-container">
  <h2 class="ja-title">Popular Japanese Anime</h2>
  <div class="ja-relative">
     <button class="scroll-button left" onclick="scrollLeftHandler('ja-shows-container')">â®</button>
     <div id="ja-shows-container" class="ja-scroll-container">
      <!-- TV show cards will be injected here -->
    </div>
    <button class="scroll-button right" onclick="scrollRightHandler('ja-shows-container')">â¯</button>
  </div>
  <div id="ja-error-message" class="ja-error"></div>
</div>
            </section>
            <!-- New & Hot Section -->    
            <section id="new-hot-section" class="section-hidden" style="padding: 1rem;">
                <div style="padding-top: 1rem;">
                    <!-- Top Navigation for New & Hot -->
                    <div class="new-hot-top-nav no-scrollbar">
                        <button>
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="text-orange-400">
                                <path fill-rule="evenodd" d="M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25ZM12.75 6a.75.75 0 0 0-1.5 0v6a.75.75 0 0 0 .75.75h4.5a.75.75 0 0 0 0-1.5h-3.75V6Z" clip-rule="evenodd" />
                            </svg>
                            <span>Coming Soon</span>
                        </button>
                        <button>
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="text-green-400">
                                <path d="M4.5 4.5a3 3 0 0 0-3 3v9a3 3 0 0 0 3 3h8.25a3 3 0 0 0 3-3V7.5a3 3 0 0 0-3-3H4.5ZM19.94 6.94a.75.75 0 0 0-1.061-1.061l-3.375 3.375a.75.75 0 0 0 1.061 1.061l3.375-3.375Z" />
                                <path fill-rule="evenodd" d="M1.5 7.5a3 3 0 0 1 3-3h1.372c.516 0 .966.351 1.048.85.143.852.64 1.723 1.09 2.27a3.001 3.001 0 0 0 2.27 1.091c.55.45 1.378.947 2.231 1.09.5.082.85.532.85 1.049v1.372a3 3 0 0 1-3 3H7.5a3 3 0 0 1-3-3V7.5Z" clip-rule="evenodd" />
                            </svg>
                            <span>Everyone's Watching</span>
                        </button>
                        <button>
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="text-blue-400">
                                <path d="M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25ZM12.75 6a.75.75 0 0 0-1.5 0v6a.75.75 0 0 0 .75.75h4.5a.75.75 0 0 0 0-1.5h-3.75V6Z" />
                            </svg>
                            <span>Mobile Games</span>
                        </button>
                        <button>
                            <span class="text-red-600" style="font-weight: 700; font-size: 0.75rem;">TOP 10</span>
                            <span>TV Shows</span>
                        </button>
                        <button>
                            <span class="text-red-600" style="font-weight: 700; font-size: 0.75rem;">TOP 10</span>
                            <span>Movies</span>
                        </button>
                    </div>

                    <!-- Coming Soon Film -->
                    <div class="coming-soon-item">
                        <img src="https://placehold.co/400x250/4A4A4A/FFFFFF?text=MY+OXFORD+YEAR" alt="My Oxford Year">
                        <div class="coming-soon-info">
                            <div class="coming-soon-type">
                                <span class="coming-soon-n">N</span>
                                <span class="coming-soon-label">FILM</span>
                            </div>
                            <span class="coming-soon-rating">U/A 16+</span>
                        </div>
                        <h3 class="coming-soon-title">MY OXFORD YEAR</h3>
                        <p class="coming-soon-date">Coming on 1 August</p>
                        <p class="coming-soon-description">An ambitious American fulfilling her dream of studying at Oxford falls for a charming Brit hiding a secret that may upend her perfectly planned life.</p>
                        <button class="remind-me-button">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.04 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0" />
                            </svg>
                            <span>Remind Me</span>
                        </button>
                    </div>

                    <!-- Coming Soon Series -->
                    <div class="coming-soon-item">
                        <img src="https://placehold.co/400x250/4A4A4A/FFFFFF?text=The+Great+Indian+Kapil+Show" alt="The Great Indian Kapil Show">
                        <div class="coming-soon-info">
                            <div class="coming-soon-type">
                                <span class="coming-soon-n">N</span>
                                <span class="coming-soon-label">SERIES</span>
                            </div>
                            <span class="coming-soon-rating">U/A 13+</span>
                        </div>
                        <h3 class="coming-soon-title">The Great Indian Kapil Show</h3>
                        <p class="coming-soon-description">A description for The Great Indian Kapil Show would go here, detailing its content and appeal.</p>
                        <button class="remind-me-button">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.04 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0" />
                            </svg>
                            <span>Remind Me</span>
                        </button>
                    </div>
                </div>
            </section>
            <!-- My WatchOut Section -->
            <section id="my-netflix-section" >
                <!-- Default Profile Section -->
                <div class="default-profile-section">
                    <img src="https://occ-0-4345-3647.1.nflxso.net/dnm/api/v6/vN7bi_My87NPKvsBoib006Llxzg/AAAABfjwXqIYd3kCEU6KWsiHSHvkft8VhZg0yyD50a_pHXku4dz9VgxWwfA2ontwogStpj1NE9NJMt7sCpSKFEY2zmgqqQfcw1FMWwB9.png?r=229&quot;" alt="User Avatar" class="default-profile-avatar">
                    <span class="default-profile-name">User</span>
                </div>

                <!-- Notifications Section -->
                <div class="notifications-section">
                    <div class="notifications-left">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="notifications-icon">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.04 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0" />
                        </svg>
                        <span class="notifications-text">Notifications</span>
                    </div>
                    <a href="#" class="notifications-link">
                        <span>See All</span>
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="notifications-link-icon">
                            <path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5" />
                        </svg>
                    </a>
                </div>

                <!-- My List Section -->
                <div class="carousel-section">
                    <div class="carousel-header">
                        <h2 class="carousel-title">My List</h2>
                        <a href="#" class="notifications-link">
                            <span>See All</span>
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="notifications-link-icon">
                                <path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5" />
                            </svg>
                        </a>
                    </div>
                    <button class="scroll-button left" onclick="scrollLeftHandler('my-list-container')">â®</button>
                    <div class="carousel-content no-scrollbar" id="my-list-container">
                        <!-- my-List card goes here-->
                    </div>
                    <button class="scroll-button right" onclick="scrollRightHandler('my-list-container')">â¯</button>
                </div>
            </section>     
        </main>
    </div>
<style>
#tmdb-search-wrapper {
    right:0;
    height: 60px;
    top:0;
    width:100%;
    display: flex;
    justify-content: flex-end;
    align-items: center;
    z-index: 999;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
}
body{background: Black;}
#tmdb-search-container {
    display: flex;
    align-items: center;
    border-radius: 8px;
    overflow: hidden;
    transition: width 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94), opacity 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94), padding 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    width: 0;
    opacity: 0;
    padding: 0;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
}

#tmdb-search-container.expanded {
    width: 100%;
    background:#000;
    opacity: 1;
    padding: 8px 12px;
    padding-right: 0;
}

@media(min-width:1000px) {
#tmdb-search-wrapper{position: relative; float: right;}
    #tmdb-search-container.expanded {
        width: 100% !important;
        border: 1px solid white;
    }
}

#tmdb-input-wrapper {
    position: relative;
    display: flex;
    gap: 8px;
    align-items: center;
    height: 36px;
    background-color: rgba(139, 139, 139, 0.12);
    flex: 1;
    padding: 0 8px;
    border: 0;
    border-radius: 6px;
    transition: background-color 0.2s ease;
}

#tmdb-input-wrapper:focus-within {
    background-color: rgba(139, 139, 139, 0.18);
    box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.1);
}

.tmdb-search-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0.7;
}

.tmdb-input-field {
    flex: 1;
    position: relative;
}

.tmdb-input-field input {
    width: 100%;
    height: 100%;
    font-size: 15px;
    background: transparent;
    color: #fff;
    border: none;
    outline: none;
    padding: 0;
    font-weight: 400;
}

.tmdb-input-field input::placeholder {
    color: rgba(255, 255, 255, 0.5);
    transition: color 0.2s ease;
}

.tmdb-input-field input:focus::placeholder {
    color: rgba(255, 255, 255, 0.3);
}

.search-clear-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    color: rgba(255, 255, 255, 0.5);
    cursor: pointer;
    padding: 3px;
    transition: color 0.2s ease;
}

.search-clear-icon:hover {
    color: rgba(255, 255, 255, 0.8);
}

#tmdb-cancel-btn {
    background: transparent;
    border: none;
    color: #fff; 
    font-size: 15px;
    font-weight: 500;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    padding: 0 15px;
    height: 100%;
    transition: opacity 0.2s ease;
}

#tmdb-cancel-btn:hover {
    opacity: 0.8;
}

#tmdb-toggle-btn {
    color: #fff;
    border: none;
    background: none;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background-color 0.2s ease, transform 0.2s ease;
}

#tmdb-toggle-btn:hover {
    transform: scale(1.05);
}

#tmdb-search-results {
    position: absolute;
    top: 60px;
    width: 100%;
    background: #0D0D0D;
    max-height: 400px;
    overflow-y: auto;
    border-radius: 0px 0 0 8px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.25);
    opacity: 0;
    transform: translateY(-10px);
    transition: opacity 0.3s ease, transform 0.3s ease;
}

#tmdb-search-results.visible {
    opacity: 1;
    transform: translateY(0);
}

.tmdb-result {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px 14px;
    cursor: pointer;
    border-bottom: 1px solid rgba(255, 255, 255, 0.08);
    transition: background-color 0.2s ease;
}

.tmdb-result:hover {
    background: rgba(255, 255, 255, 0.05);
}

.tmdb-result:last-child {
    border-bottom: none;
}

.tmdb-result img {
    width: 70px;
    height: auto;
    aspect-ratio: 2/3;
    border-radius: 4px;
    object-fit: cover;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
    transition: transform 0.2s ease;
}

.tmdb-result:hover img {
    transform: scale(1.05);
}

.tmdb-result-info {
    display: flex;
    flex-direction: column;
    flex: 1;
}

.tmdb-result-title {
    color: #fff;
    font-size: 14px;
    font-weight: 500;
    margin-bottom: 3px;
}

.tmdb-result-meta {
    display: flex;
    align-items: center;
    gap: 8px;
    color: rgba(255, 255, 255, 0.7);
    font-size: 12px;
}

.tmdb-result-year {
    color: rgba(255, 255, 255, 0.5);
}

.tmdb-result-type {
    background: rgba(229, 9, 20, 0.2);
    color: #E50914;
    padding: 2px 6px;
    border-radius: 3px;
    font-size: 10px;
    text-transform: uppercase;
    font-weight: 500;
}

.tmdb-no-results {
    padding: 20px;
    text-align: center;
    color: rgba(255, 255, 255, 0.7);
    font-size: 14px;
}

/* Scrollbar styling */
#tmdb-search-results::-webkit-scrollbar {
    width: 6px;
    background: transparent;
}

#tmdb-search-results::-webkit-scrollbar-thumb {
    background: rgba(255, 255, 255, 0.2);
    border-radius: 3px;
}

#tmdb-search-results::-webkit-scrollbar-thumb:hover {
    background: rgba(255, 255, 255, 0.3);
}

/* Mobile improvements */
@media (max-width: 768px) {
    #tmdb-search-container.expanded {
        border-radius: 6px;
    }
    #season-episode-controls h3{
      display: none;
  }
  #more-like-this-container h3, .previewModal--section-header{
      display: none !important;
  }
  #trailers-container h3{
      display: none;
  }
  .about-header h3{
      display: none;
  }
    .tmdb-result {
        padding: 14px;
    }
    
    .tmdb-result-title {
        font-size: 15px;
    }
}
/* Custom CSS for the movie showcase */
    .gms-movie-showcase-container {
        position: relative;
        overflow: hidden;
        /* width: 100%; -- Removed */
        margin: 0 auto;
        background-color: #1f2937; /* Dark background */
        color: white;
        font-family: 'Inter', sans-serif;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2); /* More pronounced shadow */
        height: auto; /* Allow height to be determined by content */
    }

    .gms-movie-backdrop {
        width: 100%;
        height: auto;
        display: block;
        object-fit: cover; /* Cover the container */
        opacity: 0.6; /* Slightly dim the backdrop */
    }

    .spotlight-info {
        position: absolute;
        z-index: 2;
        bottom: 0;
        left: 0;
        right: 0;
        padding: 4%;
    }

    .gms-movie-logo {
        display: block; /* Make it a block element */
        width: auto; /* Adjust logo size as needed */
        max-height:200px;
        margin-bottom: 0.5rem; /* Space below the logo */
        filter: drop-shadow(1px 1px 3px rgba(0, 0, 0, 0.5)); /* Shadow for the logo */
    }

    .gms-movie-title {
        display: none;
        font-size: 2rem; /* Larger title */
        font-weight: 700;
        margin-bottom: 0.5rem;
        text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5); /* Text shadow for readability */
    }

    .gms-movie-overview {
        color: #fff;
    font-size: 1.2vw;
    font-family: 'Netflix Sans';
    font-weight: 400;
    line-height: normal;
    margin-top: .1vw;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, .45);
    width: 100%;
    }

    /* Existing .gms-movie-actions now applies to the new div */
    .gms-movie-actions {
        display: flex;
        margin-top: 1.5vw;
        gap: 1rem; /* Space between buttons */
    }

    .gms-action-button {
        display: inline-flex;
        align-items: center;
        padding: 0.55rem 1.4rem;
        border-radius: 4px;
        font-size: 1rem;
        font-weight: 600;
        text-decoration: none;
        cursor: pointer;
        transition: background-color 0.3s ease;
        border: none;
        /* Added to ensure consistent height */
        min-height: 2.5rem; /* Calculated based on padding and font-size */
    }

    .gms-play-button {
        background-color: #ffffff; /* White background */
        color: #000000; /* Black text and icon */
    }

    .gms-play-button:hover {
        background-color: #e0e0e0; /* Slightly darker white on hover */
    }

    .gms-more-info-button {
        background-color: rgba(109, 109, 110, 0.7); /* Semi-transparent white */
        color: white;
       /*border: 1px solid rgba(255, 255, 255, 0.4); */
    }

    .gms-more-info-button:hover {
        background-color: rgba(255, 255, 255, 0.3);
    }

    .gms-action-button svg {
        margin-right: 0.5rem;
        width: 1.25rem;
        height: 1.25rem;
        /* SVG fill is set to currentColor by default, so changing button color makes it black */
    }
@media (min-width: 768px) {
  .spotlight-info {
    width: 36%;
  }
}

    /* Styles for desktop (medium and larger screens) */
    @media (min-width: 900px) { /* Tailwind's md breakpoint */
		.curved-bg,.profile-spotlight{
			display:none;
		}
		.profile-screen{
			top:0;
		}
		.select_users_wrapper{
			display:flex;
			justify-content:center
		}
      .add-profile{
  width:135px;
		  height:135px;
      }
      .progress-border{
        display:none;
      }
      .icon-button {
        display: none !important;
  }
      .search-overlay {
        display: none;
  }
      #search-page{
  display: none;
  }
      #my-netflix-section{
        margin-top: 60px;
      }
      .default-profile-section, .notifications-section,.header-title{
        display: none;
      }
      #tmdb-input-wrapper{
        border-radius: 0px !important;
      }
      .header-right{
        position: relative !important;
        
        
      }
      #tmdb-search-container{
        border-radius: 0px !important;
      }
      #tmdb-search-container.expanded{
        padding: 0px !important;
      }
      .cw-carousel{
        gap: 0.5rem !important;
      }
      #modal-rating{
  display: none;
      }
      .download-btn{
        display:none !important;
      }
      .episode-meta-row{
        justify-content: space-between;
        padding: 0em 1em 0.5em 0;
  }
        .gms-movie-showcase-container {
            aspect-ratio: 16 / 6.5; /* Set 16:7 aspect ratio */
            height: 90vh; /* Let aspect-ratio control height based on width */
            width: 100%; /* Ensure it takes full width on desktop */
        }

        /* Ensure backdrop covers the container with the defined aspect ratio */
        .gms-movie-backdrop {
            width: 100%;
            object-fit: cover;
        }

        /* Ensure consistent button height on desktop */
        .gms-action-button {
             min-height: 2.5rem; /* Explicit minimum height for desktop */
        }
    }

   
  
  .previewModal--outerwrapper{
    background: transparent !important;
  }
@media (max-width: 900px) {
  .main-section {
    padding-top: 60px;
  }
}
@media (max-width: 900px) {
  .account-section {
    display: none !important;
  }
}
@media (max-width: 768px) {
  .gms-movie-showcase-container {
    aspect-ratio: 9 / 12.5 !important;
  }
}
@media (max-width: 768px) {
  .spotlight-info {
    padding: 1rem;
    display: flex;
    flex-direction: column;
    align-items: center;
  }
}

    /* Styles for mobile screens smaller than desktop (mobile) */
    @media (max-width: 900px) {  
		.content-manageProfile{
			display:none;
		}
      .users-img img,.img-addProfile{
  width: clamp(60px, 14vw, 85px);
        height: clamp(60px, 14vw, 85px);
      }
      .user-one,.user-two,.user-three,.user-kids,.add-profile{
    display: flex;
    flex-direction: column;
    align-items: center;
      }
      .text h1{
        font-size: 25px;
      }
      .embedded-components{
  display:none !important;
      }
      .movie-number{
        height: 90px;
  }
      .mobile {
        display:block !important;
  }
      .sub-header{display: none !important;
                 }
      
      .header-right{
    position: absolute;
    right: 0 !important;
    width: 100%;
  }
    
      .cw-item img{
        aspect-ratio: 2/3;
      }
      .shadow-wrap{
        display: none !important;
      }
  .previewModal-audioToggle{
    padding: 5px !important;
        aspect-ratio: 1;
        bottom: 2% !important;
        right: 1% !important;
  }
      #volume-icon{
        width: 10px;
        height: 10px;
  }
      .episode-overview{
  display: none;
  }
      .episode-runtime{
  font-size: 14px;
  color: rgb(188, 188, 188);
  }
      .episode-meta-row{
        flex-direction: column;
      }
        .gms-movie-showcase-container {
            margin: 0 3%; /* Added margin */
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 0.5rem;
        }

        .gms-movie-backdrop {
             height: 100%; /* Backdrop height 100% on mobile */
        }


        .gms-movie-logo {
            width: 250px !important; /* Smaller logo size on mobile with !important */
            margin-bottom: 0.25rem; /* Reduced space below logo */
        }

         .gms-movie-title {
             display: none; /* Hide title on mobile */
         }

        .gms-movie-overview {
            display: none; /* Hide overview on mobile */
        }

        /* Apply styles to the correct action buttons container class */
        .gms-movie-actions {
            display: flex; /* Apply flex to the button container */
            margin-top: 0.5rem; /* Add space above buttons */
            width: 100%; /* Make the container take full width */
            align-items: center; /* Center buttons vertically */
            justify-content: center; /* Center buttons horizontally */
            gap: 14px; /* Space between buttons */
        }

        .gms-play-button {
            background-color: #ffffff;
            color: #000000;
           padding:0px !important;
            justify-content: center; /* Center content within the button */
            width: 100% !important; /* Full width on mobile */
        }

        .gms-more-info-button {
            background-color: rgba(255, 255, 255, 0.2);
            justify-content: center; /* Center content within the button */
            color: white;
            padding:0px !important;
            border: 1px solid rgba(255, 255, 255, 0.4);
            width: 100% !important; /* Full width on mobile */
        }
    }
  .previewModal--outerwrapper{
    background: linear-gradient(0deg, #181818, transparent 50%);
    width: 100%;
    position: absolute;
    height: 100%;
    top: 0;
  }
  .previewModal--tags {
    font-size: 14px;
    line-height: 20px;
    margin: .5em .5em .5em 0;
    word-break: break-word;
}

/* Desktop Search Section Styles */
#search-section {
    display: none;
    padding-top: 60px;
    padding-left: 4%;
    padding-right: 4%;
    min-height: 100vh;
}

.search-results-container {
padding: 10px;
}

.search-info {
    margin-bottom: 30px;
    text-align: center;
}

.search-info h2 {
    font-size: 2rem;
    margin-bottom: 10px;
    color: #333;
}

.search-info p {
    color: #666;
    font-size: 1.1rem;
}

.search-results-grid {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    gap: 20px;
    padding: 20px 0;
}

.search-result-item {
    cursor: pointer;
    border-radius: 4px;
    overflow: hidden;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
    background: white;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.search-result-item:hover {
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
}

.result-poster {
    width: 100%;
    aspect-ratio: 2/3;
    overflow: hidden;
}

.result-poster img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.2s ease;
}

.no-results-desktop {
    text-align: center;
    padding: 60px 20px;
    color: #666;
}

.no-results-desktop p {
    font-size: 1.2rem;
}

/* Dark mode support */
@media (prefers-color-scheme: dark) {
    .search-info h2 {
        color: #fff;
    }
    
    .search-info p {
        color: #ccc;
    }
    
    .search-result-item {
        background: #2a2a2a;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
    }
    
    .search-result-item:hover {
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
    }
    
    .result-title {
        color: #fff;
    }
    
    .result-year {
        background: #444;
        color: #ccc;
    }
    
    .no-results-desktop {
        color: #ccc;
    }
    
    #search-section {
        background: #000;
        color: #fff;
    }
}

/* Mobile responsiveness */
@media (max-width: 768px) {
    #search-section {
        display: none !important;
    }
    
    .search-results-grid {
        grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
        gap: 15px;
        padding: 15px 0;
    }
    
    .result-info {
        padding: 10px;
    }
    
    .result-title {
        font-size: 0.9rem;
    }
    
    .search-info h2 {
        font-size: 1.5rem;
    }
}

/* Tablet adjustments */
@media (min-width: 769px) and (max-width: 1024px) {
    .search-results-grid {
        grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
        gap: 20px;
    }
}

/* Large screens */
@media (min-width: 1400px) {
    .search-results-container {
        max-width: 1400px;
    }
    
    .search-results-grid {
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        gap: 30px;
    }
}
</style>

<script>
const imgBase = 'https://image.tmdb.org/t/p/w300';
const workerUrl = 'https://search-proxy.bingeoutofficial.workers.dev'; // No trailing slash
const M3U_URL = 'https://iptv-org.github.io/iptv/languages/hin.m3u';

const toggleBtn = document.getElementById('tmdb-toggle-btn');
const cancelBtn = document.getElementById('tmdb-cancel-btn');
const searchContainer = document.getElementById('tmdb-search-container');
const searchInput = document.getElementById('tmdb-search');
const resultsBox = document.getElementById('mobile-results-container');
const clearBtn = document.getElementById('search-clear');

const homeSection = document.getElementById('home-section');
const searchSection = document.getElementById('search-section');

// --- NEW: Live TV Data Storage ---
let liveChannelsCache = [];

// Initialize Live TV Data
async function initLiveChannels() {
    try {
        const res = await fetch(M3U_URL);
        const text = await res.text();
        liveChannelsCache = parseM3U(text);
        console.log("Live Channels Loaded:", liveChannelsCache.length);
    } catch (err) {
        console.error("Live Channels load failed:", err);
    }
}
initLiveChannels();

function parseM3U(data) {
    const lines = data.split('\n');
    const result = [];
    let current = null;
    lines.forEach(line => {
        if (line.startsWith('#EXTINF:')) {
           const name = line.split(',').pop().trim();
           const logo = line.match(/tvg-logo="([^"]+)"/)?.[1] || '';
            const group = line.match(/group-title="([^"]+)"/)?.[1] || 'Live TV';
            const tvgId = line.match(/tvg-id="([^"]+)"/)?.[1] || '';

            current = {
                name,
                logo,
                group,
                tvgId,          // âœ… STORE tvg-id
                media_type: 'live'
            };
        }
 
		else if (line.startsWith('http')) {
            if (current) {
                current.url = line.trim();
                result.push(current);
                current = null;
            }
        }
    });
    return result;
}

// Function to check if device is mobile
function isMobile() {
    return window.innerWidth <= 1000;
}

// Function to normalize strings for exact match comparison
function normalizeForMatch(str) {
    return str
        .toLowerCase()
        .replace(/[-\s]+/g, '')
        .replace(/[^a-z0-9]/g, '');
}

async function fetchTMDBResults(searchTerm) {
    if (!searchTerm) return [];
    const yearMatch = searchTerm.match(/\s(\d{4})$/);
    let queryWithoutYear = searchTerm;
    if (yearMatch) {
        queryWithoutYear = searchTerm.substring(0, searchTerm.length - yearMatch[0].length).trim();
    }

    const pages = [1, 2];
    const results = [];
    
    for (const page of pages) {
        const multiEndpoint = `${workerUrl}/search/multi?query=${encodeURIComponent(queryWithoutYear)}&language=en-US&page=${page}`;
        try {
            const res = await fetch(multiEndpoint);
            if (!res.ok) continue;
            const data = await res.json();
            if (!data.results) continue;

            const pageResults = data.results
                .filter(item => item.media_type === 'movie' || item.media_type === 'tv')
                .map(item => ({ ...item, media_type: item.media_type }));
            
            results.push(...pageResults);
        } catch (err) {
            console.error(`Page ${page} TMDB search error:`, err.message);
            continue;
        }
    }

    const uniqueResults = Array.from(
        new Map(results.map(item => [item.id, item])).values()
    );

    return uniqueResults.sort((a, b) => (b.popularity || 0) - (a.popularity || 0));
}

// --- UPDATED: Display Mobile with Live TV support ---
function displayMobileResults(results, searchTerm) {
	const resultsBox = document.getElementById('mobile-results-container');
    resultsBox.innerHTML = '';

    if (results.length === 0) {
        resultsBox.innerHTML = `<div class="tmdb-no-results">No results found for "${searchTerm}"</div>`;
        resultsBox.classList.add('visible');
        return;
    }

    const processedResults = processAndSortResults(results, searchTerm);
    const limitedResults = processedResults.slice(0, 30); // Increased limit for mixed results

    limitedResults.forEach(item => {
        const title = item.title || item.name || 'Untitled';
        const type = item.media_type;
        let releaseYear = '';

        if (type === 'movie' && item.release_date) {
            releaseYear = new Date(item.release_date).getFullYear();
        } else if (type === 'tv' && item.first_air_date) {
            releaseYear = new Date(item.first_air_date).getFullYear();
        }

        const div = document.createElement('div');
        div.className = 'tmdb-result';
        
        // Dynamic poster logic for Live TV
        const posterSrc = type === 'live' 
            ? (item.logo || 'https://via.placeholder.com/45x68?text=LIVE')
            : (item.poster_path ? imgBase + item.poster_path : 'https://via.placeholder.com/45x68?text=No+Image');

        div.innerHTML = `
            <img src="${posterSrc}" alt="${title}" loading="lazy" style="${type === 'live' ? 'object-fit: contain; padding: 4px;' : ''}">
            <div class="tmdb-result-info">
                <span class="tmdb-result-title">${title} ${type === 'live' ? '<span style="color:#ef4444; font-size:10px; margin-left:5px;">â— LIVE</span>' : ''}</span>
                <div class="tmdb-result-meta">
                    ${releaseYear ? `<span class="tmdb-result-year">${releaseYear}</span>` : ''}
                    <span class="tmdb-result-type">${type === 'live' ? 'Channel' : (type === 'movie' ? 'Movie' : 'TV')}</span>
                </div>
            </div>
        `;

        div.onclick = () => {
            if (type === 'live') {
                // Change this to your preferred way to play streams
                if (typeof openModal === 'function') {
                    openModal(item.tvgId, 'channel');
                } else {
                    console.log("Playing stream:", item.url);
                    window.open(item.url, '_blank'); 
                }
            } else {
                if (typeof openModal === 'function') {
                    openModal(item.id, type);
                } else {
                    alert('openModal function not defined!');
                }
            }
            resultsBox.classList.remove('visible');
            searchInput.value = '';
            clearBtn.style.display = 'none';
        };
        resultsBox.appendChild(div);
    });

    resultsBox.classList.add('visible');
}

// --- UPDATED: Display Desktop with Live TV support ---
function displayDesktopResults(results, searchTerm) {
    if (!searchSection) {
        displayMobileResults(results, searchTerm);
        return;
    }

    if (homeSection) homeSection.style.display = 'none';
    searchSection.style.display = 'block';
    window.scrollTo(0, 0);
    
    if (window.history && window.history.pushState && window.location.pathname !== '/search') {
        window.history.pushState({page: 'search', query: searchTerm}, 'Search Results', '/search');
    }

    searchSection.innerHTML = '';
    const resultsContainer = document.createElement('div');
    resultsContainer.className = 'search-results-container';

    if (results.length === 0) {
        const noResults = document.createElement('div');
        noResults.className = 'no-results-desktop';
        noResults.innerHTML = `<p>No results found for "${searchTerm}"</p>`;
        resultsContainer.appendChild(noResults);
        searchSection.appendChild(resultsContainer);
        return;
    }

    const resultsGrid = document.createElement('div');
    resultsGrid.className = 'search-results-grid';
    const processedResults = processAndSortResults(results, searchTerm);

    processedResults.forEach(item => {
        const title = item.title || item.name || 'Untitled';
        const type = item.media_type;

        const itemDiv = document.createElement('div');
        itemDiv.className = 'search-result-item';
        
        const posterSrc = type === 'live' 
            ? (item.logo || 'https://via.placeholder.com/200x300?text=LIVE')
            : (item.poster_path ? imgBase + item.poster_path : 'https://via.placeholder.com/200x300?text=No+Image');

        itemDiv.innerHTML = `
            <div class="result-poster" style="position:relative;">
                <img src="${posterSrc}" alt="${title}" loading="lazy" style="${type === 'live' ? 'object-fit: contain; background: #000; padding: 10px;' : ''}">
                ${type === 'live' ? '<div style="position:absolute; bottom:10px; left:10px; background:red; color:white; font-size:10px; padding:2px 6px; border-radius:4px; font-weight:bold;">LIVE CHANNEL</div>' : ''}
            </div>
        `;
        
        itemDiv.onclick = () => {
            if (type === 'live') {
                if (typeof openModal === 'function') openModal(item.tvgId, 'channel');
                else window.open(item.url, '_blank');
            } else {
                openModal(item.id, type);
            }
        };
        resultsGrid.appendChild(itemDiv);
    });

    resultsContainer.appendChild(resultsGrid);
    searchSection.appendChild(resultsContainer);
}

// Function to process and sort results (shared logic)
function processAndSortResults(results, searchTerm) {
    const yearMatch = searchTerm.match(/\s(\d{4})$/);
    let queryTitle = searchTerm;
    let queryYear = null;

    if (yearMatch) {
        queryYear = yearMatch[1];
        queryTitle = searchTerm.substring(0, searchTerm.length - yearMatch[0].length).trim();
    }

    const normalizedQueryTitle = normalizeForMatch(queryTitle);
    let processedResults = [...results];

    if (queryYear) {
        const yearMatches = [];
        const otherResults = [];
        
        processedResults.forEach(item => {
            const itemYear = item.release_date
                ? new Date(item.release_date).getFullYear().toString()
                : item.first_air_date
                ? new Date(item.first_air_date).getFullYear().toString()
                : '';
                
            if (itemYear === queryYear) {
                yearMatches.push(item);
            } else {
                otherResults.push(item);
            }
        });
        
        const sortedYearMatches = sortByTitleMatch(yearMatches, normalizedQueryTitle);
        const sortedOtherResults = sortByTitleMatch(otherResults, normalizedQueryTitle);
        processedResults = [...sortedYearMatches, ...sortedOtherResults];
    } else {
        processedResults = sortByTitleMatch(processedResults, normalizedQueryTitle);
    }

    return processedResults;
}

function displayResults(results, searchTerm) {
    if (window.innerWidth <= 1000) {
        displayMobileResults(results, searchTerm);
    } else {
        displayDesktopResults(results, searchTerm);
    }
}

function goBackToHome() {
    if (!isMobile()) {
        if (searchSection) searchSection.style.display = 'none';
        if (homeSection) homeSection.style.display = 'block';
    } else {
        history.back();
    }
}

function sortByTitleMatch(results, normalizedQueryTitle) {
    const exactMatches = [];
    const partialMatches = [];
    const otherMatches = [];

    results.forEach(item => {
        const title = item.title || item.name || 'Untitled';
        const normalizedTitle = normalizeForMatch(title);

        if (normalizedTitle === normalizedQueryTitle) {
            exactMatches.push(item);
        } else if (normalizedTitle.includes(normalizedQueryTitle) || normalizedQueryTitle.includes(normalizedTitle)) {
            partialMatches.push(item);
        } else {
            otherMatches.push(item);
        }
    });

    exactMatches.sort((a, b) => (b.popularity || 0) - (a.popularity || 0));
    partialMatches.sort((a, b) => (b.popularity || 0) - (a.popularity || 0));
    otherMatches.sort((a, b) => (b.popularity || 0) - (a.popularity || 0));

    return [...exactMatches, ...partialMatches, ...otherMatches];
}

function debounce(func, wait) {
    let timeout;
    return function (...args) {
        clearTimeout(timeout);
        timeout = setTimeout(() => func.apply(this, args), wait);
    };
}

// --- UPDATED: Search logic now includes Live Channel filtering ---
const debouncedSearch = debounce(async (query) => {
    if (!query) {
        if (isMobile()) {
            resultsBox.innerHTML = '';
            resultsBox.classList.remove('visible');
        } else {
            goBackToHome();
        }
        clearBtn.style.display = 'none';
        return;
    }

    clearBtn.style.display = 'flex';

    try {
        // 1. Fetch TMDB results
        const tmdbResults = await fetchTMDBResults(query);
        
        // 2. Filter Live Channels from Cache
        const normalizedQuery = query.toLowerCase();
        const filteredLive = liveChannelsCache.filter(c => 
            c.name.toLowerCase().includes(normalizedQuery)
        );

        // 3. Combine results (Live Channels first for higher visibility)
        const combinedResults = [...filteredLive, ...tmdbResults];
        
        displayResults(combinedResults, query);

        if (tmdbResults.length < 6 && query.toLowerCase().includes(' and ') && !query.includes(' & ')) {
            const modifiedQuery = query.replace(/ and /gi, ' & ');
            const modifiedResults = await fetchTMDBResults(modifiedQuery);
            displayResults([...filteredLive, ...modifiedResults], modifiedQuery);
        }
    } catch (err) {
        console.error('Unified search error:', err);
        if (isMobile()) {
            resultsBox.innerHTML = `<div class="tmdb-no-results">Error fetching results</div>`;
            resultsBox.classList.add('visible');
        } else {
            displayDesktopResults([], query);
        }
    }
}, 300);

searchInput.addEventListener('input', function () {
    const query = this.value.trim();
    debouncedSearch(query);
});

toggleBtn.addEventListener('click', () => {
    if (window.innerWidth <= 1000) {
        // Mobile / tablet
        searchPage.classList.add('is-visible');
        searchInputBar.focus();

        if (window.location.pathname !== '/search') {
            history.pushState({}, '', '/search');
        }
    } else {
        // Desktop
        toggleBtn.style.display = 'none';
        searchContainer.classList.add('expanded');

        setTimeout(() => searchInput.focus(), 300);
    }
});


clearBtn.addEventListener('click', () => {
    searchInput.value = '';
    if (isMobile()) {
        resultsBox.innerHTML = '';
        resultsBox.classList.remove('visible');
    } else {
        goBackToHome();
    }
    clearBtn.style.display = 'none';
    searchInput.focus();
});

cancelBtn.addEventListener('click', () => {
    searchContainer.classList.remove('expanded');
    toggleBtn.style.display = 'inline-block';
    searchInput.value = '';
    if (isMobile()) {
        resultsBox.innerHTML = '';
        resultsBox.classList.remove('visible');
    }
    clearBtn.style.display = 'none';
});

document.addEventListener('click', (e) => {
    const searchWrapper = document.getElementById('tmdb-search-wrapper');
    if (!searchWrapper.contains(e.target)) {
        if (searchContainer.classList.contains('expanded')) {
            searchContainer.classList.remove('expanded');
            toggleBtn.style.display = 'inline-block';
            searchInput.value = '';
            if (isMobile()) resultsBox.classList.remove('visible');
            else goBackToHome();
            clearBtn.style.display = 'none';
        }
    }
});

window.addEventListener('popstate', (e) => {
    if (!isMobile()) {
        if (e.state && e.state.page === 'search') {
            if (searchSection) searchSection.style.display = 'block';
            if (homeSection) homeSection.style.display = 'none';
        } else {
            searchInput.value = '';
            clearBtn.style.display = 'none';
            if (searchContainer.classList.contains('expanded')) {
                searchContainer.classList.remove('expanded');
                toggleBtn.style.display = 'inline-block';
            }
        }
    }
});

window.addEventListener('resize', () => {
    const currentQuery = searchInput.value.trim();
    if (currentQuery) {
        setTimeout(() => debouncedSearch(currentQuery), 100);
    }
});

searchInput.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
        if (searchInput.value.trim() !== '') {
            searchInput.value = '';
            if (isMobile()) {
                resultsBox.innerHTML = '';
                resultsBox.classList.remove('visible');
            } else {
                goBackToHome();
            }
            clearBtn.style.display = 'none';
        } else {
            cancelBtn.click();
        }
        e.preventDefault();
    }
});

window.tmdbSearch = {
    goBackToHome,
    displayResults,
    fetchTMDBResults
};
</script>


<script>
  
function updateSpotlight(id, mediaType, backdrop, logo, overview, title) {
  document.getElementById("gms-movie-backdrop").src = backdrop;
  document.getElementById("gms-movie-backdrop").alt = title;

  document.getElementById("gms-movie-logo").src = logo;
  document.getElementById("gms-movie-logo").alt = title + " Logo";

  document.getElementById("gms-movie-title").textContent = title;
  document.getElementById("gms-movie-overview").textContent = overview;

  document.getElementById("gms-play-button").setAttribute("onclick", `openModal(${id}, '${mediaType}')`);
  document.getElementById("gms-more-info-button").setAttribute("onclick", `openModal(${id}, '${mediaType}')`);
}

  
</script>










<style>
.cw-container {
  position: relative;
  border-radius: 8px;
  overflow: hidden;
  margin-bottom: 30px;
  display: none; /* Initially hidden */
}

  
.cw-container.cw-visible {
  display: block; /* Shown only when items exist */
}
.cw-container h2 {
  color: #fff;
  font-size: 1.5em;
  font-weight: 800;
  padding-left: 4%;
  padding-bottom: 0.55rem;
  font-family: Arial, sans-serif;
}
.cw-carousel {
  display: flex;
  gap: 15px;
  overflow-x: auto;
  overflow-y: hidden;
  padding-left: 4%;
  scrollbar-width: none;
}
.cw-item {
  display: flex;
  flex-direction: column;
  flex: 0 0 auto;
  width: 115px; /* Mobile default for posters */
  text-align: center;
  cursor: pointer;
  position: relative; /* For potential icon positioning */
}

@media (min-width: 769px) {
  .cw-item {
    width: 19.22% ; 
  }
}
.cw-item img {
  width: 100%;
  object-fit: cover;
  border-radius: 5px 5px 0 0;
}
.recent-row {
  display: flex;
  justify-content: space-around;
  gap: 10px;
  background: #1f1f1f;
  padding: 10px 0 5px;
}
.recent-info, .recent-delete {
  cursor: pointer;
}
.recent-info img.svg-icon, .recent-delete img.svg-icon {
  width: 20px;
  height: 20px;
  transition: opacity 0.2s;
}
.recent-delete img.svg-icon:hover {
  opacity: 0.8; /* Subtle fade on hover for delete */
}
.recent-info img.svg-icon:hover {
  opacity: 0.8; /* Subtle fade on hover for info */
}
.cw-progress-bar {
  height: 4px; /* Thin bar like Netflix */
  background-color: #e50914; /* Netflix red */
  position: absolute;
  bottom: 0;
  left: 0;
  border-radius: 0px 0px 0px 0px; /* Match image border-radius */
  transition: width 0.3s ease; /* Smooth width changes */
}
.cw-empty {
  color: #888;
  font-size: 1em;
  padding: 20px;
  text-align: center;
  font-family: Arial, sans-serif;
}
</style>



<script>
// Function to determine if the device is mobile based on screen width
function isMobile() {
    return window.innerWidth <= 768; // Common breakpoint for mobile devices
}

// Function to delete an item from continueWatching
function deleteFromContinueWatching(id, mediaType, itemElement) {
    // First immediately hide the item
    itemElement.style.display = 'none';

    // Then update localStorage without refreshing the display
    let continueWatching = JSON.parse(localStorage.getItem('continueWatching') || '[]');
    continueWatching = continueWatching.filter(item => !(item.id === id && item.mediaType === mediaType));
    localStorage.setItem('continueWatching', JSON.stringify(continueWatching));

    // Also delete associated video progress for this specific ID
    let videoProgress = JSON.parse(localStorage.getItem('videoProgress') || '{}');
    if (mediaType === 'movie') {
        delete videoProgress[`movie_${id}`];
    } else if (mediaType === 'tv') {
        // Clear progress for all episodes of the series
        Object.keys(videoProgress).forEach(key => {
            if (key.startsWith(`tv_${id}_`)) {
                delete videoProgress[key];
            }
        });
    }
    localStorage.setItem('videoProgress', JSON.stringify(videoProgress));

    // Check if carousel is now empty and hide container if needed
    if (document.querySelectorAll('.cw-item:not([style*="display: none"])').length === 0) {
        document.getElementById('cw-container').classList.remove('cw-visible');
        document.getElementById('cw-carousel').innerHTML = '<p class="cw-empty">No items in Continue Watching</p>';
    }
}

// Function to display Continue Watching items
async function displayContinueWatching() {
    const container = document.getElementById('cw-container');
    const carousel = document.getElementById('cw-carousel');
    const continueWatching = JSON.parse(localStorage.getItem('continueWatching') || '[]');
    const videoProgress = JSON.parse(localStorage.getItem('videoProgress') || '{}');

    // Hide the entire section if no items
    if (continueWatching.length === 0) {
        container.classList.remove('cw-visible');
        carousel.innerHTML = '';
        return;
    }

    // Show the section
    container.classList.add('cw-visible');

    // Determine image type based on device
    const usePoster = isMobile();
    const placeholderImage = usePoster 
        ? 'https://via.placeholder.com/120x180?text=No+Image'
        : 'https://via.placeholder.com/301x180?text=No+Image';

    // Clear existing content
    carousel.innerHTML = '';

    // Iterate in original order
    for (const item of continueWatching) {
        // Use stored URLs from continueWatching
        let imagePath = usePoster ? item.posterUrl : item.backdropUrl;

        // Fallback to placeholder if no URL is stored
        if (!imagePath) {
            imagePath = placeholderImage;
        }

        let currentProgress = null;
        if (item.mediaType === 'movie') {
            currentProgress = videoProgress[`movie_${item.id}`];
        } else if (item.mediaType === 'tv') {
            // Collect all episode keys for this specific TV series
            const episodeKeysForSeries = Object.keys(videoProgress).filter(key => key.startsWith(`tv_${item.id}_`));
            let lastPlayedEpisodeKey = episodeKeysForSeries.length > 0 
                ? episodeKeysForSeries[episodeKeysForSeries.length - 1]
                : null;
            currentProgress = lastPlayedEpisodeKey ? videoProgress[lastPlayedEpisodeKey] : null;
        }

        const div = document.createElement('div');
        div.className = 'cw-item';
        div.innerHTML = `
            <div style="position: relative;">
                <img src="${imagePath}" alt="Continue Watching Item">
                ${currentProgress && currentProgress.percentage ? `<div class="cw-progress-bar" style="width: ${currentProgress.percentage}%"></div>` : ''}
            </div>
            <div class="recent-row">
                <div class="recent-info"><img class="svg-icon" src="/icons/info.png" alt="Info"></div>
                <div class="recent-delete"><img class="svg-icon svg-icon2" src="/icons/delete.png" alt="Delete"></div>
            </div>
        `;
        div.querySelector('.recent-delete').onclick = (e) => {
            e.stopPropagation();
            deleteFromContinueWatching(item.id, item.mediaType, div);
        };
        div.onclick = () => openModal(item.id, item.mediaType);
        carousel.appendChild(div);
    }

    // If no items were added, show empty message
    if (carousel.children.length === 0) {
        carousel.innerHTML = '<p class="cw-empty">No items in Continue Watching</p>';
    }
}

// Run on load
displayContinueWatching();
</script>

  
<!------------------------------------------------------------------------------TMDB New to Watch Out! Widget------------------------------------------------------------------->
<!------------------------------------------------------------------------------TMDB New to Watch Out! Widget------------------------------------------------------------------->
<!------------------------------------------------------------------------------TMDB New to Watch Out! Widget------------------------------------------------------------------->






<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

<style>
    /* Custom scrollbar styling (optional, but improves appearance) */
    .nmw-horizontal-scroll::-webkit-scrollbar {
        height: 8px;
    }

    .nmw-horizontal-scroll::-webkit-scrollbar-track {
        background: #1a202c; /* Dark background for track */
        border-radius: 10px;
    }

    .nmw-horizontal-scroll::-webkit-scrollbar-thumb {
        background: #4a5568; /* Greyish thumb */
        border-radius: 10px;
    }

    .nmw-horizontal-scroll::-webkit-scrollbar-thumb:hover {
        background: #718096; /* Lighter grey on hover */
    -moz-user-select: none; /* Firefox */
    -webkit-user-select: none; /* Chrome, Safari, Opera */
    -ms-user-select: none; /* Internet Explorer/Edge */
    user-select: none; /* Standard syntax */
    }

    /* Hide scrollbar for Firefox */
    .nmw-horizontal-scroll {
        scrollbar-width: none;
        padding-left: 3%;
        scrollbar-color: #4a5568 #1a202c;
        overflow-x: auto; /* Enable horizontal scrolling */
        display: flex; /* Enable flexbox for horizontal layout */
        gap: 0.5rem; /* space-x-4 */
    }

    .nmw-widget-container {
        font-family: 'Inter', sans-serif;
        color: #e2e8f0; /* Light text */
        padding-bottom: 28px;
        /* Example: If you want a black background specifically for the widget */
        /* background-color: #000; */
    }

    .nmw-container {
        max-width: 1280px; /* Equivalent to mx-auto container */
        margin-right: auto;
    }
    @media (min-width :1000px) {
     .nmw-container { margin-left:10px }
    }

    .nmw-section-title {
        font-size: 1.35em; /* text-2xl */
        padding-left: 3%;
        font-weight: 800; /* font-bold */
        padding-bottom: 0.55rem; /* mb-4 */
    }

    /* Style for the placeholder image in case the API image fails */
    /* This placeholder size is optimized for posters. It might look stretched for backdrops. */
    .nmw-placeholder-image {
        background-color: #1f2937; /* Darker background for placeholder */
        color: #d1d5db; /* Light text for placeholder */
        display: flex;
        justify-content: center;
        align-items: center;
        text-align: center;
        font-size: 0.8rem;
        height: 450px; /* Match expected image height */
        width: 300px; /* Match expected image width */
        flex-shrink: 0; /* Prevent shrinking */
    }

      .nmw-movie-card {
        flex-shrink: 0; /* Prevent cards from shrinking */
        cursor: pointer; /* Indicate that the card is clickable */
        background-color: #000000; /* bg-gray-800 */
        border-radius: 6px; /* rounded-lg */
        overflow: hidden; /* overflow-hidden */
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* shadow-lg */
        width: 29.22%; /* w-40 */
        aspect-ratio: 2 / 2.8;
      }

      /* Responsive widths for movie card */
      @media (min-width: 768px) { /* md breakpoint */
          .nmw-movie-card {
          }
      }
      @media (min-width: 1000px) { /* lg breakpoint (desktop) */
          .nmw-movie-card ,.kd-card ,.cd-card ,.ja-card {width:200px !important;
          }
        .movie-number{ width: 115px
  }
         
          /* Adjust card height for desktop to better fit backdrops */
          .nmw-movie-card {
          }
          /* Ensure image covers the potentially changed card dimensions */
          .nmw-movie-card img {
              height: 100%;
              width: 100%;
          }
          /* Adjust placeholder size for desktop if needed (optional) */
          .nmw-placeholder-image {
              height: 100%; /* Match card height */
              width: 100%; /* Match card width */
              font-size: 1rem; /* Slightly larger text for larger placeholder */
          }
      }


      .nmw-movie-card img {
          display: block; /* Ensure image takes full width */
          width: 100%; /* w-full */
          aspect-ratio: 2/2.8;
          height: auto; /* h-auto */
          object-fit: fill; /* object-cover */
      }

      .nmw-card-text {
          padding: 0.5rem;/* p-2 */
          display: none;
          padding-top: 0.2rem;
          padding-left: 0;
      }

      .nmw-movie-title {
          font-size: 0.875rem; /* text-sm */
          font-weight: 800; /* font-semibold */
          overflow: hidden;
          text-overflow: ellipsis;
          white-space: nowrap; /* truncate */
      }

      .nmw-movie-details {
          font-size: 0.7rem; /* Smaller font size for details */
          color: #a0aec0; /* Lighter color for details */
          margin-top: 2px; /* Small margin above the details */
      }

    /* Skeleton Loading Styles */
    .nmw-skeleton-card {
        flex-shrink: 0;
        background-color: #181818; /* Darker background for skeleton */
        border-radius: 0.5rem;
        overflow: hidden;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        width: 120px; /* Match movie card width */
        position: relative; /* For shimmer effect */
        overflow: hidden; /* For shimmer effect */
    }

    @media (min-width: 1000px) {
        .nmw-skeleton-card {
            width: 200px !important;
        }
    }

    .nmw-skeleton-image {
        width: 100%;
        aspect-ratio: 2/3;
        background-color: #181818; /* Greyer background for image placeholder */
    }

    .nmw-skeleton-text {
        padding: 0.5rem;
    }

    .nmw-skeleton-line {
        height: 0.75rem; /* text-sm equivalent */
        background-color: #4a5568;
        border-radius: 0.25rem;
        margin-bottom: 0.5rem;
    }

    .nmw-skeleton-line.title {
        width: 90%; /* Longer line for title */
    }

    .nmw-skeleton-line.details {
        width: 60%; /* Shorter line for details */
        height: 0.6rem; /* Smaller height for details */
    }

    /* Shimmer Effect */
    .nmw-skeleton-card::after {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.05), transparent);
        transform: translateX(-100%);
        animation: shimmer 1.5s infinite;
    }

    @keyframes shimmer {
        100% {
            transform: translateX(100%);
        }
    }
  @keyframes fade-in {
	0% {
		opacity: 0;
		transform: scale(1.2);
	}
	100% {
		opacity: 1;
		transform: scale(1);
	}
}
</style>

<!------------------------------------------------------------------------------TMDB Trending Movies Widget------------------------------------------------------------------->

<style>
 @media (max-width: 900px) {.scroll-btn{display:none;}}
  #trending-widget {
    font-family: Arial, sans-serif;
    padding-bottom: 30px;
    background: #000;
    color: #fff;
    border-radius: 10px;
    position: relative;
    overflow: hidden;
  }
  #HTML36{padding:0px !important}

  #trending-widget h2 {
    font-size: 20px;
    font-weight: 800;
    padding-left: 4%;
    padding-bottom: 0.55rem;
  }

   .tmdb-movie-card {
    width: 115px;
    aspect-ratio: 2/3;
    flex: 0 0 auto;
    border-radius: 6px;
    overflow: hidden;
    cursor: pointer;
  }

  .tmdb-movie-card img {
    width: 100%;
    border-radius: 6px;
    height: auto;
    object-fit: cover;
  }
</style>

<script>
    // --- Configuration and Constants ---
    const TRENDING_CONTAINER = document.getElementById('trending-movies');
    const MODAL = document.getElementById('movie-modal');
    const MODAL_TITLE = document.getElementById('modal-title');
    const MODAL_OVERVIEW = document.getElementById('modal-overview');
    const MODAL_RATING = document.getElementById('modal-rating');
    const SVG_ICONS = {
        1: `<svg id="rank-1" width="100%" height="100%" viewBox="-20 0 70 154" class="svg-icon svg-icon-rank-1 top-10-rank"><path stroke="#ffffff" stroke-width="4" d="M35.377 152H72V2.538L2 19.362v30.341l33.377-8.459V152z"></path></svg>`,
        2: `<svg id="rank-2" width="100%" height="100%" viewBox="0 0 80 154" class="svg-icon svg-icon-rank-2 top-10-rank"><path stroke="#ffffff" stroke-width="4" d="M3.72 152H113v-30.174H50.484l4.355-3.55 29.453-24.012c5.088-4.124 9.748-8.459 13.983-13.004 4.16-4.464 7.481-9.339 9.972-14.629 2.449-5.203 3.678-11.113 3.678-17.749 0-9.428-2.294-17.627-6.875-24.645-4.597-7.042-10.941-12.494-19.07-16.376C77.803 3.957 68.496 2 58.036 2 47.591 2 38.37 4.023 30.347 8.06c-8.015 4.032-14.457 9.578-19.352 16.654-4.492 6.493-7.389 13.803-8.693 21.952h34.055c1.236-3.52 3.398-6.52 6.459-8.97 3.54-2.834 8.277-4.224 14.147-4.224 5.93 0 10.552 1.537 13.76 4.681 3.181 3.12 4.791 7.024 4.791 11.594 0 4.151-1.16 7.934-3.468 11.298-2.192 3.194-5.987 7.124-11.405 11.84L3.72 122.465V152z"></path></svg>`,
        3: `<svg id="rank-3" width="100%" height="100%" viewBox="0 0 80 154" class="svg-icon svg-icon-rank-3 top-10-rank"><path stroke="#ffffff" stroke-width="4" d="M3.809 41.577h33.243c1.3-2.702 3.545-4.947 6.674-6.72 3.554-2.015 7.83-3.01 12.798-3.01 5.555 0 10.14 1.11 13.723 3.376 3.839 2.427 5.782 6.283 5.782 11.315 0 4.553-1.853 8.395-5.473 11.38-3.547 2.926-8.18 4.37-13.821 4.37H41.44v28.366h16.77c5.572 0 10.275 1.227 14.068 3.711 4.02 2.633 6.071 6.581 6.071 11.616 0 5.705-1.943 9.975-5.853 12.562-3.658 2.42-8.292 3.61-13.863 3.61-5.205 0-9.82-.94-13.827-2.836-3.698-1.75-6.32-4.272-7.785-7.529H2.33c2.096 12.089 7.761 21.65 17.028 28.78C29.242 148.175 42.594 152 59.476 152c10.706 0 20.175-1.783 28.42-5.337 8.185-3.528 14.575-8.486 19.208-14.884 4.595-6.346 6.896-13.938 6.896-22.837 0-6.952-1.93-13.494-5.81-19.666-3.815-6.07-9.68-10.367-17.683-12.908l-5.46-1.735 5.353-2.04c6.659-2.538 11.667-6.338 15.083-11.412 3.431-5.096 5.142-10.806 5.142-17.181 0-8.471-2.262-15.778-6.787-21.985-4.574-6.275-10.7-11.17-18.408-14.696C77.683 3.775 69.109 2 59.687 2 44.084 2 31.515 5.816 21.91 13.415c-9 7.119-15.025 16.486-18.101 28.162z"></path></svg>`,
        4: `<svg id="rank-4" width="100%" height="100%" viewBox="0 0 81 154" class="svg-icon svg-icon-rank-4 top-10-rank"><path stroke="#ffffff" stroke-width="4" d="M72 152h35.333v-30.977H128V92.497h-20.667V2H69.89L2 92.712v28.311h70V152zM36.202 92.188l35.93-47.998v47.998h-35.93z"></path></svg>`,
        5: `<svg id="rank-5" width="100%" height="100%" viewBox="0 0 81 154" class="svg-icon svg-icon-rank-5 top-10-rank"><path stroke="#ffffff" stroke-width="4" d="M105.588 32.174V2H13.534l-8.3 88.357h32.463c2.145-2.362 4.866-4.254 8.143-5.675 3.585-1.554 7.543-2.328 11.859-2.328 6.247 0 11.418 1.745 15.418 5.255 4.061 3.564 6.104 8.37 6.104 14.265 0 6.041-2.044 10.89-6.121 14.387-3.999 3.43-9.162 5.132-15.401 5.132-4.299 0-8.17-.694-11.601-2.095-3.11-1.268-5.577-2.946-7.368-5.042H2.592c3.308 11.593 9.782 20.623 19.46 27.164C32.472 148.464 45.64 152 61.602 152c10.12 0 19.294-1.99 27.548-5.966 8.198-3.949 14.711-9.718 19.572-17.335 4.844-7.59 7.278-16.95 7.278-28.123 0-9.182-2.013-17.314-6.032-24.431-4.02-7.118-9.514-12.7-16.51-16.775-6.99-4.072-14.849-6.109-23.612-6.109-11.06 0-20.099 3.483-27.234 10.461l-3.892 3.806 3.273-35.354h63.595z"></path></svg>`,
        6: `<svg id="rank-6" width="100%" height="100%" viewBox="0 0 81 154" class="svg-icon svg-icon-rank-6 top-10-rank"><path stroke="#ffffff" stroke-width="4" d="M79.482 38.192h35.551c-3.284-10.945-8.963-19.573-17.048-25.938C89.323 5.434 77.531 2 62.545 2 50.756 2 40.35 4.86 31.277 10.577c-9.064 5.712-16.198 14.09-21.412 25.178C4.63 46.893 2 60.425 2 76.365c0 14.416 2.356 27.344 7.059 38.798 4.667 11.368 11.573 20.34 20.734 26.956C38.904 148.7 50.225 152 63.816 152a61.513 61.513 0 0019.922-3.278 53.546 53.546 0 0017.378-9.792c5.154-4.33 9.255-9.64 12.314-15.947 3.042-6.273 4.57-13.556 4.57-21.868 0-8.812-2.062-16.636-6.182-23.51-4.134-6.897-9.643-12.293-16.55-16.212-6.905-3.917-14.48-5.874-22.76-5.874-14.546 0-25.34 4.55-32.569 13.63l-4.003 5.03.443-6.413c.874-12.636 3.56-21.85 8.168-27.654 4.69-5.907 10.885-8.9 18.421-8.9 4.26 0 7.826.734 10.685 2.24 2.445 1.287 4.396 2.867 5.829 4.74zM62.605 123c-5.825 0-10.902-1.894-15.136-5.655C43.173 113.528 41 108.603 41 102.71c0-5.881 2.164-10.864 6.44-14.818C51.674 83.975 56.762 82 62.604 82c5.847 0 10.906 1.98 15.074 5.905C81.878 91.859 84 96.837 84 102.71c0 5.885-2.131 10.805-6.35 14.622-4.167 3.77-9.214 5.668-15.045 5.668z"></path></svg>`,
        7: `<svg id="rank-7" viewBox="0 0 78 154" width="100%" height="100%" class="svg-icon svg-icon-rank-7 top-10-rank"><path stroke="#ffffff" stroke-width="4" d="M113,2 L2,2 L2,33.4022989 L75.9665929,33.4022989 L21.22571,152 L60.28102,152 L113,32.7672283 L113,2 Z"></path></svg>`,
        8: `<svg id="rank-8" width="100%" height="100%" viewBox="0 0 77 154" class="svg-icon svg-icon-rank-8 top-10-rank"><path stroke="#ffffff" stroke-width="4" d="M59.5 152c11.335 0 21.358-1.72 30.077-5.15 8.637-3.397 15.361-8.258 20.213-14.586 4.805-6.267 7.21-13.876 7.21-22.899 0-7.326-2.261-14.07-6.813-20.29-4.548-6.214-10.837-10.658-18.922-13.35l-5.4-1.799 5.338-1.975c7.238-2.678 12.572-6.683 16.066-12.018 3.53-5.388 5.284-11.178 5.284-17.414 0-7.912-2.133-14.839-6.405-20.84-4.3-6.042-10.403-10.825-18.345-14.351C79.816 3.78 70.386 2 59.5 2S39.184 3.781 31.197 7.328c-7.942 3.526-14.044 8.309-18.345 14.351-4.272 6.001-6.405 12.928-6.405 20.84 0 6.236 1.755 12.026 5.284 17.414 3.494 5.335 8.828 9.34 16.066 12.018l5.338 1.975-5.4 1.798c-8.085 2.693-14.374 7.137-18.922 13.351C4.261 95.295 2 102.04 2 109.365c0 9.023 2.405 16.632 7.21 22.899 4.852 6.328 11.576 11.19 20.213 14.586 8.72 3.43 18.742 5.15 30.077 5.15zm.5-89c-5.6 0-10.334-1.515-14.125-4.56C41.985 55.313 40 51.183 40 46.21c0-5.244 1.976-9.518 5.875-12.65C49.666 30.515 54.4 29 60 29s10.334 1.515 14.125 4.56C78.025 36.694 80 40.968 80 46.212c0 4.973-1.985 9.103-5.875 12.228C70.334 61.485 65.6 63 60 63zm-.5 62c-6.255 0-11.556-1.613-15.836-4.856-4.41-3.343-6.664-7.816-6.664-13.25 0-5.298 2.258-9.698 6.664-13.038C47.944 90.613 53.245 89 59.5 89c6.255 0 11.556 1.613 15.836 4.856 4.406 3.34 6.664 7.74 6.664 13.038 0 5.434-2.254 9.907-6.664 13.25C71.056 123.387 65.755 125 59.5 125z"></path></svg>`,
        9: `<svg id="rank-9" viewBox="0 0 71 154" width="100%" height="100%" class="svg-icon svg-icon-rank-9 top-10-rank"><path stroke="#ffffff" stroke-width="4" d="M40.0597376,115.807692 L4.47328474,115.807692 C7.45109332,126.586242 13.4362856,135.15497 22.4670906,141.582071 C32.2129251,148.518048 44.5640134,152 59.5759717,152 C78.2141671,152 92.5105725,145.697944 102.6454,133.074799 C112.853557,120.360322 118,101.543854 118,76.5769231 C118,62.1603327 115.678843,49.3016297 111.046669,37.9886125 C106.453069,26.7698049 99.6241767,17.9802976 90.5435117,11.5767831 C81.5017862,5.20072813 70.1375399,2 56.3957597,2 C49.4158116,2 42.68229,3.15952329 36.1849549,5.47966815 C29.7045526,7.79376647 23.8782903,11.1932931 18.6948526,15.6846002 C13.5316746,20.1583529 9.45923583,25.508367 6.46782377,31.7491046 C3.4928156,37.95562 2,45.0644366 2,53.0961538 C2,61.9117395 4.02797967,69.7019439 8.0788911,76.5056791 C12.1434539,83.3323424 17.5832537,88.6925139 24.4218542,92.6108203 C31.2518358,96.5241882 38.8590885,98.4807692 47.2791519,98.4807692 C55.0853554,98.4807692 61.6095996,97.3619306 66.8547126,95.1478231 C72.0569983,92.9517941 76.4513169,89.5970183 80.0605818,85.0622151 L84.0584687,80.039134 L83.6207883,86.4440446 C82.74746,99.2241219 80.0984349,108.438199 75.5533003,114.10687 C70.9310132,119.871766 64.7726909,122.788462 57.2438163,122.788462 C52.8691399,122.788462 49.1904302,122.100251 46.212535,120.692834 C43.5930338,119.454801 41.5307848,117.825945 40.0597376,115.807692 Z M57.5,31 C63.3657106,31 68.4419893,32.9364861 72.6299874,36.7826253 C76.8609583,40.6682294 79,45.6186068 79,51.5 C79,57.3813932 76.8609583,62.3317706 72.6299874,66.2173747 C68.4419893,70.0635139 63.3657106,72 57.5,72 C51.6342894,72 46.5580107,70.0635139 42.3700126,66.2173747 C38.1390417,62.3317706 36,57.3813932 36,51.5 C36,45.6186068 38.1390417,40.6682294 42.3700126,36.7826253 C46.5580107,32.9364861 51.6342894,31 57.5,31 Z"></path></svg>`,
        10: `<svg id="rank-10" width="100%" height="100%" viewBox="0 0 140 154" class="svg-icon svg-icon-rank-10 top-10-rank"><path stroke="#ffffff" stroke-width="4" d="M34.757 151.55h35.869V2.976L2 19.687v30.14l32.757-8.41v110.132zm105.53 3.45c12.394 0 23.097-3.12 32.163-9.353 9.093-6.25 16.11-15.047 21.066-26.43C198.5 107.766 201 94.196 201 78.5c0-15.698-2.5-29.266-7.484-40.716-4.955-11.384-11.973-20.18-21.066-26.431C163.384 5.119 152.681 2 140.287 2c-12.393 0-23.096 3.12-32.162 9.353-9.093 6.25-16.11 15.047-21.066 26.43-4.984 11.45-7.484 25.02-7.484 40.717 0 15.698 2.5 29.266 7.484 40.716 4.955 11.384 11.973 20.18 21.066 26.431 9.066 6.234 19.769 9.353 32.162 9.353zm0-31.368c-7.827 0-13.942-4.147-18.15-12.178-4.053-7.736-6.047-18.713-6.047-32.954s1.994-25.218 6.047-32.954c4.208-8.03 10.323-12.178 18.15-12.178 7.827 0 13.943 4.147 18.15 12.178 4.053 7.736 6.048 18.713 6.048 32.954s-1.995 25.218-6.047 32.954c-4.208 8.03-10.324 12.178-18.15 12.178z"></path></svg>`
    };

    // TMDB API details via a proxy to avoid CORS issues
    const PROXY_BASE = 'https://workers-playground-autumn-mouse-86e7.watchoutofficial2006.workers.dev';
    const TRENDING_API_URL = `${PROXY_BASE}/?url=trending/movie/week`;
    const DETAILS_API_URL = (id) => `${PROXY_BASE}/?url=movie/${id}`;
    
    // --- Helper Functions ---
    // --- Main Logic ---
    /**
     * Fetches and displays trending movies from the TMDB API.
     */
    async function fetchTrendingMovies() {
        try {
            const res = await fetch(TRENDING_API_URL);
            if (!res.ok) {
                throw new Error('Network response was not ok');
            }
            const data = await res.json();
            
            // Clear previous content
            TRENDING_CONTAINER.innerHTML = '';
            
            data.results.slice(0, 10).forEach((movie, index) => {
                const rank = index + 1;
                // Create the wrapper for the number and card
                const wrapper = document.createElement('div');
                wrapper.className = 'movie-entry-wrapper';
            
                // Create the number element
                const numberDiv = document.createElement('div');
                numberDiv.className = 'movie-number';

                // Use the provided SVG code or a generic SVG
                if (SVG_ICONS[rank]) {
                    numberDiv.innerHTML = SVG_ICONS[rank];
                } else {
                    // Placeholder SVG with a white fill for visibility
                    numberDiv.innerHTML = `<svg width="100%" height="100%" viewBox="0 0 100 154" class="svg-icon">
                        <text x="50%" y="70%" dominant-baseline="middle" text-anchor="middle" font-size="70" font-weight="bold" fill="white">${rank}</text>
                    </svg>`;
                }
            
                // Create the movie card element
                const card = document.createElement('div');
                card.className = 'tmdb-movie-card';
                
                // Add an onerror fallback for images
                const posterUrl = movie.poster_path ? `https://image.tmdb.org/t/p/w300${movie.poster_path}` : 'https://placehold.co/300x450/2d3748/a0aec0?text=No+Image';
                card.innerHTML = `<img src="${posterUrl}" alt="${movie.title}" onerror="this.onerror=null;this.src='https://placehold.co/300x450/2d3748/a0aec0?text=No+Image';">`;
                
                card.onclick = () => openModal(movie.id,'movie');
                
                // Append both to the wrapper, then the wrapper to the container
                wrapper.appendChild(numberDiv);
                wrapper.appendChild(card);
                TRENDING_CONTAINER.appendChild(wrapper);
            });
        } catch (err) {
            console.error("Error loading trending movies:", err);
            TRENDING_CONTAINER.innerHTML = `<p class="text-red-500 text-center">Failed to load movies. Please try again later.</p>`;
            TRENDING_CONTAINER.style.display = 'block';
        }
    }
    
    // Initial data fetch on page load
    document.addEventListener('DOMContentLoaded', fetchTrendingMovies);
</script>





<style>
  #trending-tv-widget {
    font-family: Arial, sans-serif;
    padding-bottom: 30px;
    background: #000;
    color: #fff;
    border-radius: 10px;
    position: relative;
    overflow: hidden;
  }

  #trending-tv-widget h2 ,.kd-container h2 ,.cd-container h2 {
    font-size: 20px;
    padding-left:4%;
    font-weight: 800;
    color: #fff;
    padding-bottom: 0.55rem;
  }

#overlay {
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.8); /* 50% black */
    display: none;
    z-index: 40;
    
}
  .tmdb-movie-card {
    width: 115px;
    aspect-ratio: 2 / 3;
    flex: 0 0 auto;
    border-radius: 6px;
    overflow: hidden;
    cursor: pointer;
  }

  .tmdb-movie-card img {
    width: 100%;
    height: auto;
    object-fit: cover;
  }
</style>

<script>
    const TRENDING_TV_CONTAINER = document.getElementById('trending-tv-shows');
    const IMAGE_BASE_URL = 'https://image.tmdb.org/t/p/w300';
    const PROXY_URL = 'https://workers-playground-autumn-mouse-86e7.watchoutofficial2006.workers.dev/?url=trending/tv/week';

    async function fetchTrendingTVShows() {
        try {
            const res = await fetch(PROXY_URL);
            if (!res.ok) {
                throw new Error('Network response was not ok');
            }
            const data = await res.json();
            
            TRENDING_TV_CONTAINER.innerHTML = '';
            
            data.results.slice(0, 10).forEach((series, index) => {
                const rank = index + 1;
                const wrapper = document.createElement('div');
                wrapper.className = 'movie-entry-wrapper';
            
                const numberDiv = document.createElement('div');
                numberDiv.className = 'movie-number';

                if (SVG_ICONS[rank]) {
                    numberDiv.innerHTML = SVG_ICONS[rank];
                } else {
                    numberDiv.innerHTML = `<svg width="100%" height="100%" viewBox="0 0 100 154" class="svg-icon">
                        <text x="50%" y="70%" dominant-baseline="middle" text-anchor="middle" font-size="70" font-weight="bold" fill="white">${rank}</text>
                    </svg>`;
                }
            
                const card = document.createElement('div');
                card.className = 'tmdb-movie-card';
                
                const posterUrl = series.poster_path ? `${IMAGE_BASE_URL}${series.poster_path}` : 'https://placehold.co/300x450/2d3748/a0aec0?text=No+Image';
                card.innerHTML = `<img src="${posterUrl}" alt="${series.name}" onerror="this.onerror=null;this.src='https://placehold.co/300x450/2d3748/a0aec0?text=No+Image';">`;
                
                card.onclick = () => openModal(series.id, 'tv');
                
                wrapper.appendChild(numberDiv);
                wrapper.appendChild(card);
                TRENDING_TV_CONTAINER.appendChild(wrapper);
            });
        } catch (err) {
            console.error('Failed to load trending TV shows:', err);
            TRENDING_TV_CONTAINER.innerHTML = `<p class="text-red-500 text-center">Failed to load TV shows. Please try again later.</p>`;
        }
    }

    document.addEventListener('DOMContentLoaded', fetchTrendingTVShows);
</script>

<style>
/* Modal CSS */
.tmdb-modal {
background: black;
position: fixed;
height: 100vh;
z-index: 9999;
inset: 0;
overflow-y: auto;
scrollbar-width: none;
transform: translateY(100%); /* Start off-screen at the bottom */
transition: transform 0.4s ease-out;
}

.iframe-holder{
 display: none;
position: fixed;
z-index: 99999;
inset: 0;
background: #000000;
overflow-y: hidden;
}
  
@media (max-width: 767px) {
        .iframe-holder {
            transform: rotate(90deg);
            transform-origin: center;
            width: 100vh;
            height: 100vw;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(90deg);
        }
  .modal-close{
    display: none;
  }
}
  
.iframe-holder iframe {
        width: 100%;
        height: 100%;
        border: none;
    }
.modal-content {
background: #000;
min-height: 100vh;
color: #fff;
margin: 0 auto;
border-radius: 0; /* Default border-radius for smaller screens */
margin-top: 0; /* Default margin-top */
}

.modal-backdrop-container {
position: absolute;
width: 100%;
aspect-ratio: 16 / 9;
overflow: hidden;
border-radius: 0; /* Default border-radius for smaller screens */
}

.modal-backdrop {
width: 100%;
height: 100%;
object-fit: cover;
display: block;
}

.modal-close {
position: absolute;
top: 10px;
right: 10px;
width: 16px;
height: 16px;
background: #1c1c1c url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHg9IjBweCIgeT0iMHB4Igp3aWR0aD0iNTAiIGhlaWdodD0iNTAiCnZpZXdCb3g9IjAsMCwyNTYsMjU2IgpzdHlsZT0iZmlsbDojMDAwMDAwOyI+CjxnIGZpbGw9IiNmZmZmZmYiIGZpbGwtcnVsZT0ibm9uemVybyIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIHN0cm9rZS1saW5lY2FwPSJidXR0IiBzdHJva2UtbGluZWpvaW49Im1pdGVyIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHN0cm9rZS1kYXNoYXJyYXk9IiIgc3Ryb2tlLWRhc2hvZmZzZXQ9IjAiIGZvbnQtZmFtaWx5PSJub25lIiBmb250LXdlaWdodD0ibm9uZSIgZm9udC1zaXplPSJub25lIiB0ZXh0LWFuY2hvcj0ibm9uZSIgc3R5bGU9Im1peC1ibGVuZC1tb2RlOiBub3JtYWwiPjxnIHRyYW5zZm9ybT0ic2NhbGUoNS4xMiw1LjEyKSI+PHBhdGggZD0iTTkuMTU2MjUsNi4zMTI1bC0yLjg0Mzc1LDIuODQzNzVsMTUuODQzNzUsMTUuODQzNzVsLTE1LjkzNzUsMTUuOTY4NzVsMi44MTI1LDIuODEyNWwxNS45Njg3NSwtMTUuOTM3NWwxNS45Mzc1LDE1LjkzNzVsMi44NDM3NSwtMi44NDM3NWwtMTUuOTM3NSwtMTUuOTM3NWwxNS44NDM3NSwtMTUuODQzNzVsLTIuODQzNzUsLTIuODQzNzVsLTE1Ljg0Mzc1LDE1Ljg0Mzc1eiI+PC9wYXRoPjwvZz48L2c+Cjwvc3ZnPg==) center / 1.4em auto no-repeat;
border: none;
color: #fff;
padding: .5rem .5rem;
cursor: pointer;
border-radius: 50%;
}
.player-close {
position: absolute;
top: 20px;
right: 20px;
width: 25px;
height: 25px;
background: #1c1c1c;
border: none;
color: #fff;
padding: .5rem .5rem;
cursor: pointer;
border-radius: 50%;
appearance: none;
    font-style: inherit;
    font-variant: inherit;
    font-stretch: inherit;
    font-family: inherit;
    font-optical-sizing: inherit;
    font-size-adjust: inherit;
    font-kerning: inherit;
    font-feature-settings: inherit;
    font-variation-settings: inherit;
    margin: 0px;
    opacity: 1;
    text-decoration: none;
    -webkit-box-align: center;
    align-items: center;
    border: 1px solid rgba(0, 0, 0, 0);
    box-sizing: border-box;
    display: inline-flex;
    font-size: 13px;
    font-weight: 400;
    -webkit-box-pack: center;
    justify-content: center;
    letter-spacing: normal;
    line-height: 1;
    padding: 2px 7px;
    user-select: none;
    border-radius: 20px;
    cursor: pointer;
    fill: currentcolor;
    transition-duration: 250ms;
    transition-property: background-color, border-color;
    transition-timing-function: cubic-bezier(0.4, 0, 0.68, 0.06);
    vertical-align: text-top;
    width: 40px;
    height: 40px;
    background: rgba(0, 0, 0, 0);
    color: rgb(255, 255, 255);
}
  
.player-close:hover{
  transition-timing-function: cubic-bezier(0.32, 0.94, 0.6, 1);
  background: rgba(128, 128, 128, 0.4);
  border-color: rgba(0, 0, 0, 0);
  color: rgb(255, 255, 255);
}
  
.modal-logo-container {
text-align: center;
padding: 10px 0 0;
}

.modal-logo-container img {
max-height: 50px;
max-width: 200px;
object-fit: contain;
}

.model-info-container {
padding: 10px;
}

.model-title {
font-size: 27px;
font-weight: bold;
margin-bottom: 5px;
}

.model-year-rating span {
margin-right: 10px;
font-size: 14px;
}

.play-button {
display: block;
justify-content: center;
align-items: center;
gap: 10px;
margin-top: 5px; /* Default margin-top */
padding: 10px 30px;
font-size: 16px;
font-weight: bold;
color: #000;
background: #fff;
/*border-radius:5px;*/
border-radius:50px;
border: 0;
cursor: pointer;
text-align: center;
text-decoration: none;
}

.download-btn {
background: #333;
width: 100%;
color: #fff;
padding: 12px 30px;
border-radius: 5px;
border: none;
cursor: pointer;
}

.model-overview {
margin-top: 15px;
}

.model-cast {
margin-top: 10px;
}

#more-like-this-container h3, #collection-container h3 {
font-size: 20px;
    margin-bottom: 7px;
    margin-top: 48px;
}
#more-like-this h3 {
font-size: 20px;
    margin-bottom: 7px;
    margin-top: 48px;
}
@media (max-width: 767px) {
  .titleCard-imageWrapper {
    aspect-ratio: 2 / 3;
  }
  .previewModal--tags {
    display: none;
  }
}
.similar-item{
  cursor: pointer;
  background: #2f2f2f;
  border-radius:0.25em;
}
.video-item{
  border-radius:0.25em;
}
.video-title{
  padding: 1em;
  font-size: 16px;
}
.videoMetadata--container-container {
    align-items: center;
    display: flex;
    justify-content: space-between;
    padding: 1em;
}
.videoMetadata--container {
    align-items: center;
    color: #fff;
    display: flex;
    flex-wrap: wrap;
    justify-content: flex-start;
}
.videoMetadata--container .videoMetadata--line {
    align-items: center;
    color: #bcbcbc;
    display: flex;
    flex-wrap: wrap;
}
.videoMetadata--container .videoMetadata--line>* {
    margin-right: .5em;
}
.maturity-rating .maturity-number {
    border: 1px solid hsla(0, 0%, 100%, .4);
    font-family: Netflix Sans, Helvetica Neue, Segoe UI, Roboto, Ubuntu, sans-serif;
    overflow: hidden;
    padding: 0 .4em;
    text-overflow: ellipsis;
    text-transform: uppercase;
    unicode-bidi: normal /*!rtl:plaintext*/;
    white-space: nowrap;
}
.player-feature-badge {
    border: 1px solid hsla(0, 0%, 100%, .4);
    border-radius: 3px;
    color: hsla(0, 0%, 100%, .9);
    font-size: .7em !important;
    padding: 0 .5em !important;
    white-space: nowrap;
}
.similar-overview{
   color: #d2d2d2;
   margin: 0;
   padding: 0 1em 1em;
   padding-bottom: 0;
   display: -webkit-box;
   -webkit-line-clamp: 6;
   -webkit-box-orient: vertical;
   overflow: hidden;
   text-overflow: ellipsis;
}
.titleCard-imageWrapper {
    overflow: hidden;
    position: relative;
}

#more-like-this img, #collection img {
width: 100%;
aspect-ratio: 2 / 3;
border-radius: 4px;
cursor: pointer;
}
#modal-videos img {
        width: 100%;
        aspect-ratio: 16 / 9;
        border-radius: 4px 4px 0 0;
    }
@media (min-width: 768px) {
    #more-like-this img, #collection img {
        max-width: 300px;
        aspect-ratio: 16 / 9;
        border-radius: 4px 4px 0 0;
    }
    #modal-videos img {
        width: 100%;
        max-width: 300px;
        aspect-ratio: 16 / 9;
        border-radius: 4px 4px 0 0;
    }
  .similar-item{
  padding-bottom: 10px;
}
}
.titleCard-playIcon {
    align-items: center;
    bottom: 0;
    display: flex;
    justify-content: center;
    left: 0;
    opacity: 0;
    position: absolute;
    right: 0;
    top: 0;
    transition: opacity .2s ease-in;
}
.titleCard-playIcon:hover{
    opacity: 1;
}
.titleCard-playIcon .titleCard-playSVG {
    background-color: rgba(30, 30, 20, .5);
    border: 1px solid #fff;
    border-radius: 2em;
    height: 3em;
    padding: .5em;
    width: 3em;
}

#season-episode-controls {
margin-top: 15px;
display: none;
display: flex;
justify-content: space-between;
align-items: center;
}

#season-episode-controls h3 {
font-size: 20px;
margin-bottom: 0;
}

#season-selector-container {
            position: relative;
            width: fit-content;
}

#season-selector {
 background: rgba(42, 42, 42, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 4px;
            color: white;
            font-size: 16px;
            font-family: 'Netflix Sans';
            font-weight: 500;
            padding: 12px 16px;
            padding-right: 28px;
            cursor: pointer;
            outline: none;
            transition: all 0.2s ease;
            backdrop-filter: blur(10px);
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
}
#season-selector:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.3);
        }
   #season-selector:focus {
            background: rgba(255, 255, 255, 0.15);
            border-color: #e50914;
            box-shadow: 0 0 0 2px rgba(229, 9, 20, 0.3);
        }
   #season-selector option {
            background: #2a2a2a;
            color: white;
            padding: 12px;
            border: none;
        }
   #season-selector option:hover {
            background: #404040;
        }
#season-selector-container::after {
            content: '';
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            width: 0;
            height: 0;
            border-left: 6px solid transparent;
            border-right: 6px solid transparent;
            border-top: 8px solid rgba(255, 255, 255, 0.7);
            pointer-events: none;
            transition: transform 0.2s ease;
        }
#season-selector:focus + #season-selector-container::after,
        #season-selector-container:hover::after {
            border-top-color: white;
        }
#season-selector:focus ~ #season-selector-container::after {
            transform: translateY(-50%) rotate(180deg);
        }

#episodes-container {
margin-top: 15px;
display: none;
border: 1px solid #444;
border-radius: 10px;
}

#episode-list {
list-style-type: none;
padding-left: 0;
}

#episode-list li {
display: flex;
flex-direction: column;
/* To align image and text */
padding: 10px 10px;
/* Added padding here */
border-bottom: 1px solid #222;
}

#episode-list li:last-child {
border-bottom: none;
/* Remove border from the last item */
}

#episode-list li img {
width: 120px;
height: 67px;
object-fit: cover;
/* To maintain aspect ratio */
border-radius: 5px;
}

/* Mobile Styles (adjusting play button margin for smaller screens) */
@media screen and (max-width: 1000px) {
  .result-poster {
  border-radius: 4px;
  width: 70px;
  }
  
.play-button {
width: 100%;
margin-top: 15px; /* Increased margin-top for mobile */
padding: 12px 30px;
font-size: 16px;
}
#modal-videos{
   display: flex !important;
   flex-direction: column;
   gap: 10px;
}
.player-close { display: none;}
/* Ensure no rounded corners on top for mobile to touch edges */
.modal-content,
.modal-backdrop-container {
border-radius: 0 !important;
}
}
@media screen and (min-width: 950px) {

.tmdb-modal {
  width: 850px;
  justify-self: center;
 }
.previewModal--detailsMetadata{
  display: grid;
  column-gap: 2em;
  grid-template-columns: minmax(0, 2fr) minmax(0, 1fr);
  position: relative;
  width: 100%;
 }
}

.about-wrapper {
    padding-bottom: 2em;
}
.previewModal--section-header {
    font-size: 24px;
    display: flex;
    font-weight: 500;
    margin-bottom: 20px;
    margin-top: 48px;
}

/* Mobile: Show tabs and hide inactive sections */
        @media (max-width: 1000px) {
            .section-title {
                display: none;
            }
            .episode-indexing{
                display: none !important;
            }
            .previewModal{
             display: none;
             }
            
            .tab-content {
                display: none;
            }
            
            .tab-content.active {
                display: block;
            }
            
            .nav-tabs {
                display: flex;
                margin-top: 30px;
                border-top: solid 3px #181818;
                overflow-y: hidden;
                overflow-x: scroll;
                scrollbar-width: none;
            }
            
            .nav-tabs::-webkit-scrollbar {
                display: none;
            }
            
            .nav-tab {
                white-space: nowrap;
                font-size: 14px;
            }
        }

        .nav-tab {
            background: none;
            font-family: 'Netflix Sans';
            border: none;
            color: #999;
            font-size: 14px;
            font-weight: 600;
            padding: 16px 5px;
            cursor: pointer;
            border-top: 4px solid transparent;
            transition: all 0.3s ease;
            position: relative;
            letter-spacing: 0.5px;
        }

        .nav-tab.active {
            color: #fff;
            border-top-color: #e50914;
        }

        .nav-tab:hover:not(.active) {
            color: #fff;
            border-bottom-color: rgba(229, 9, 20, 0.5);
        }

        .nav-tab:last-child {
            margin-right: 0;
        }

        /* Active indicator animation */
        .nav-tab::after {
            content: '';
            position: absolute;
            top: -4px;
            left: 0;
            width: 0;
            height: 4px;
            background: #e50914;
            transition: width 0.3s ease;
        }

        .nav-tab.active::after {
            width: 100%;
        }
/* Desktop Styles */
@media screen and (min-width: 768px) {
  .episode-overview2{
    display: none;
  }
.modal-backdrop-container, #playerWrap{
border-radius: 15px 15px 0 0; /* Rounded top corners for desktop backdrop */
}
.modal-content {
/* Add padding/margin to center the modal below the top edge */
margin-top: 3px !important; /* Increased margin-top for desktop */
background: #181818;
max-width: 850px; /* Wider max-width for desktop */
border-radius: 15px; /* Apply rounded corners to the entire modal content on desktop */
}

.model-info-container {
padding: 20px 3.43em; /* Slightly more padding inside the info container on desktop */
}

.model-title {
font-size: 27px; /* Larger title on desktop */
}

.model-year-rating span {
font-size: 16px; /* Larger info text on desktop */
}

.play-button {
margin-top: 10px; /* Adjusted margin-top for desktop */
padding: 12px 40px; /* Larger button on desktop */
font-size: 18px;
}

.download-btn {
padding: 12px 30px; /* Slightly larger download button */
font-size: 18px;
}

.model-overview {
margin-top: 20px; /* More space above overview */
font-size: 14px;
font-family: var(--netflix-font-stack);
}

.model-cast {
margin-top: 15px; /* More space above cast */
font-size: 15px;
}
.previewModal--tags-label{
  color: #777;
}
.tag-item{
  color: #ddd;
  cursor: pointer;
  margin: 0;
  outline-color: #fff;
}

#more-like-this-container h3 , #collection-container h3{
    font-size: 24px;
    font-weight: 500;
    margin-bottom: 20px;
    margin-top: 48px;
}
#trailers-container h3 {
    font-size: 24px;
    font-weight: 500;
    margin-bottom: 20px;
    margin-top: 48px;
}
  


/* Ensure the bottom corners are rounded on desktop modal content */
.modal-content {
border-bottom-left-radius: 15px;
border-bottom-right-radius: 15px;
 }
}
.loading-spinner-container {
        display: flex;
        height: 100%;
        align-items: center; /* Centers image vertically */
        justify-content: center; /* Centers image horizontally */
        padding: 16px; /* Equivalent to p-4 */
        border-radius: 8px; /* Equivalent to rounded-lg */
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1), 0 2px 4px rgba(0, 0, 0, 0.06); /* Equivalent to shadow-lg */
    }

    /* Loading image styling */
    .loading-spinner-container img {
        width: 50px; /* Equivalent to w-16 */
        height: 50px; /* Equivalent to h-16 */
        border-radius: 50%; /* Equivalent to rounded-full */
        animation: spin 1s linear infinite; /* Animation for rotation */
    }

    /* Keyframes for the spinning animation */
    @keyframes spin {
        from {
            transform: rotate(0deg);
        }
        to {
            transform: rotate(360deg);
        }
    }
  #more-like-this, #collection{
  display: grid;
    grid-template-columns: 1fr 1fr 1fr;
    gap: 10px;
    overflow-x: auto;
}
   #modal-videos{
   display: grid;
    grid-template-columns: 1fr 1fr 1fr;
    gap: 10px;
    overflow-x: auto;
}
/* Desktop: Hide tabs and show all sections */
        @media (min-width: 1000px) {
            
            .nav-tabs {
                display: none !important;
            }
            
            .tab-content {
                display: block !important;
                margin-bottom: 60px;
            }
            
            .section-title {
                display: block;
                font-size: 24px;
                font-weight: 600;
                color: #ffffff !important;
                margin-bottom: 30px;
                padding-bottom: 10px;
                border-bottom: 1px solid #333;
            }
        }
.previewModal{
  bottom: 5%;
    z-index: 2;
    left: 3.43em;
    position: absolute;
    width: 40%;
}
.previewModal-logo,.previewModal-logo-con img{
  opacity: 1;
  margin-bottom: 1.5em;
  width: 100%;
}
.modal-controls{
  align-items: flex-start;
    display: flex;
    gap: 0.5em;
    margin-bottom: 1em;
    min-height: 2em;
    position: relative;
    z-index: 2;
}
.ltr-1t5n97z {
    -webkit-box-align: center;
    align-items: center;
    appearance: none;
    border: 0px;
    cursor: pointer;
    display: flex;
    -webkit-box-pack: center;
    justify-content: center;
    opacity: 1;
    padding: 0.8rem;
    position: relative;
    user-select: none;
    will-change: background-color, color;
    word-break: break-word;
    white-space: nowrap;
    border-radius: 50%;
}
.previewModal--wrapper{
    background-color: rgba(42, 42, 42, .6);
    margin: .25em;
    border-color: hsla(0, 0%, 100%, .5);
    border-width: 2px;
    color: white;
    -webkit-box-align: center;
    align-items: center;
    appearance: none;
    cursor: pointer;
    display: flex;
    -webkit-box-pack: center;
    justify-content: center;
    opacity: 1;
    padding: 0.4rem;
    position: relative;
    user-select: none;
    will-change: background-color, color;
    word-break: break-word;
    white-space: nowrap;
    border-radius: 50%;
}
  .play-button2,.provider-button{
  padding-left: 1.27rem;
  padding-right: 1.53rem;
  padding-top: 0.51rem;
  padding-bottom: 0.51rem;
  background-color: white;
  color: black;
  font-size: 1rem;
    font-family: 'Netflix Sans';
    font-weight: 500;
  -webkit-box-align: center;
    align-items: center;
    appearance: none;
    border: 0px;
    /*border-radius: 4px;*/
    border-radius: 50px;
    cursor: pointer;
    display: flex;
    gap: 1rem;
    -webkit-box-pack: center;
    justify-content: center;
    opacity: 1;
    position: relative;
    user-select: none;
    will-change: background-color, color;
    word-break: break-word;
    white-space: nowrap;
  }
.player-feature-badge{
  margin-right: .715em;
  border: 1px solid hsla(0, 0%, 100%, .4);
  border-radius: 3px;
  color: hsla(0, 0%, 100%, .9);
  font-size: .7em;
  padding: 0 .5em;
  white-space: nowrap;
}
  .episode-title{
    color: rgb(255, 255, 255);
    cursor: pointer;
    display: block;
    font-family: "Netflix Sans", "Helvetica Neue", "Segoe UI", Roboto, Ubuntu, sans-serif;
    font-size: 16px;
    font-weight: 500;
    overflow-wrap: anywhere;
    user-select: none;
    -webkit-font-smoothing: antialiased;
  }
  .episode-runtime{
    box-sizing: border-box;
    color: rgb(255, 255, 255);
    cursor: pointer;
    display: block;
    font-family: "Netflix Sans", "Helvetica Neue", "Segoe UI", Roboto, Ubuntu, sans-serif;
    font-size: 16px;
    -webkit-font-smoothing: antialiased;
  }
  .previewModal-audioToggle{
    opacity: 0.4;
    z-index: 2;
    position: absolute;
    bottom: 8%;
    right: 3em;
  }
  /* Netflix Next Episode Button */
        .next-button {
            position: absolute;
            right: 20px;
            bottom: 90px;
            background: linear-gradient(to right, #fff 50%, #ccc 50%);
            background-position: 100% 0%;
            background-size: 200% 100%;
            padding: 16px 32px;
            font-size: 21px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            color: #000;
            font-weight: 600;
            display: none; /* hidden by default */
            align-items: center;
            gap: 12px;
            transition: transform 0.2s ease, box-shadow 0.2s ease, background-position 0.3s ease;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            min-width: 200px;
            justify-content: center;
            overflow: hidden;
        }

        .next-button.show {
            display: flex;
            animation: backgroundSlide 5s ease-out ;
        }

        .next-button:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
        }

        .next-button:active {
            transform: scale(0.98);
        }

        .play-icon {
            width: 0;
            height: 0;
            border-left: 10px solid #000;
            border-top: 6px solid transparent;
            border-bottom: 6px solid transparent;
        }

        @keyframes backgroundSlide {
            0% {
                background-position: 100% 0%;
            }
            100% {
                background-position: 0% 0%;
            }
        }
  /* --- 1. The Overlay Container (The Sliding Page) --- */
        .search-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #000000; /* formerly --dark-background */
            z-index: 1000;

            /* Initial state: off-screen to the right (100% width) */
            transform: translateX(100%);
            transition: transform 0.35s cubic-bezier(0.4, 0.0, 0.2, 1); /* Smoother animation curve */

            display: flex;
            flex-direction: column;
            overflow: hidden; /* Prevent horizontal scroll during transition */
        }

        /* 2. Class to show the page */
        .search-overlay.is-visible {
            transform: translateX(0); /* Slide fully into view */
        }

        /* --- 3. The Fixed Search Bar --- */
        .search-bar-fixed {
            display: flex;
            flex-direction: column;
            gap: 10px;
            align-items: flex-start;
            background-color: #000000; /* formerly --dark-background */
            flex-shrink: 0;
        }

        /* New wrapper for input and mic icon */
        .input-wrapper {
            flex-grow: 1;
            width: 100%;
            height:50px;
            position: relative; /* Container for absolute mic position */
            background-color: #1e1e1e; /* formerly --input-background */
            border-radius: 0px; /* rounded-lg */
            display: flex; /* Helps ensure the input takes full height */
            align-items: center;
        }

        .search-input {
            flex-grow: 1;
            border: none;
            width: 100%;
            background: transparent; /* Wrapper has the background */
            color: #ffffff; /* formerly --text-color */
            font-size: 16px;
            /* Add padding on the right to make space for the mic icon */
            padding: 10px 15px 10px 15px; 
            outline: none;
            border-radius: 8px;
            /* Removed original margins and background color */
        }

        .search-input::placeholder {
            color: #888; /* formerly --dim-text */
        }

        /* --- Icon Styling --- */
        .icon-button {
            background: none;
            border: none;
            padding: 8px; /* p-2 */
            margin-top:10px;
            margin-left: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%; /* rounded-full */
            transition: background-color 0.2s;
        }
        .icon-button:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        .icon {
            width: 24px;
            height: 24px;
            fill: #ffffff; /* formerly --text-color */
        }

        /* Positioning the mic button inside the input wrapper */
        .mic-button {
            position: absolute;
            right: 0px;
            top: 50%;
            transform: translateY(-50%);
            padding: 10px; /* Adjusted padding to look good inside the input field */
        }
        .mic-button:hover {
            background-color: transparent; /* Prevent hover background change on the mic icon itself */
        }
        
        /* Trigger button positioning and style */
        #open-search {
            position: fixed;
            top: 1rem; /* top-4 */
            right: 1rem; /* right-4 */
            background-color: #1f2937; /* bg-gray-800 */
            padding: 12px; /* p-3 */
            border-radius: 9999px; /* rounded-full */
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1); /* shadow-lg */
            z-index: 50;
        }

        /* --- 4. Results Container --- */
        .search-results-container {
            flex-grow: 1;
            overflow-y: auto;
            padding-top: 10px;
            color: #fff;
            margin-bottom: 50px;
        }
        
        .section-title {
            font-size: 1.25rem; /* text-xl */
            font-weight: 700; /* font-bold */
            margin-bottom: 1rem; /* mb-4 */
            color: #ffffff; /* formerly --text-color */
        }

        /* Individual result items */
        .result-item {
            padding: 15px 0;
            border-bottom: 1px solid #222;
            display: flex;
            align-items: center;
            gap: 15px; /* gap-4 */
            cursor: pointer;
        }
        .result-item:hover {
            background-color: rgba(255, 255, 255, 0.05);
        }
        .result-item:last-child {
            border-bottom: none;
        }
        .result-item span {
            font-size: 1.25rem; /* text-xl */
            color: #E50914; /* formerly --netflix-red */
            font-weight: 800; /* font-extrabold */
        }
        .result-title {
            font-size: 1rem;
            font-weight: 600;
        }
        .result-description {
            font-size: 0.85rem;
            color: #888; /* formerly --dim-text */
        }
</style>

<!-- The Full-Screen Sliding Search Page -->
    <div class="search-overlay" id="search-page">
        
        <!-- Fixed Search Bar -->
        <div class="search-bar-fixed">
            
            <!-- Close Button (Left side, replaces search icon when open) -->
            <button id="close-search" class="icon-button">
                <!-- Back/Close Arrow SVG -->
                <svg class="icon" viewBox="0 0 24 24">
                    <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
                </svg>
            </button>

            <!-- Input Wrapper containing the search field and the mic icon -->
            <div class="input-wrapper">
                <svg viewBox="0 0 24 24" width="24" height="24" data-icon="MagnifyingGlassMedium" data-icon-id=":ri:" aria-hidden="true" style="width:27px ; height:27px; padding-left: 10px;" class="search-icon" xmlns="http://www.w3.org/2000/svg" fill="none" role="img">
<path fill-rule="evenodd" clip-rule="evenodd" d="M17 10C17 13.866 13.866 17 10 17C6.13401 17 3 13.866 3 10C3 6.13401 6.13401 3 10 3C13.866 3 17 6.13401 17 10ZM15.6177 17.0319C14.078 18.2635 12.125 19 10 19C5.02944 19 1 14.9706 1 10C1 5.02944 5.02944 1 10 1C14.9706 1 19 5.02944 19 10C19 12.125 18.2635 14.078 17.0319 15.6177L22.7071 21.2929L21.2929 22.7071L15.6177 17.0319Z" fill="#878787"></path>

</svg>
                <input type="text" id="search-input" placeholder="Search for a show, movie, genre, etc." class="search-input" autofocus>
                
                <!-- Mic Icon (Now positioned absolutely inside the input wrapper) -->
                
            </div>

        </div>

        <!-- Search Results/Suggestions Container (Dynamically populated by JS) -->
        <div id="mobile-results-container"class="search-results-container">
            <!-- Loading message will appear here initially -->
            <p style="text-align: center; padding-top: 50px;">Initializing...</p>
        </div>
    </div>

    <script>
const searchPage = document.getElementById('search-page');
const openButton = document.getElementById('open-search');
const closeButton = document.getElementById('close-search');
const resultsContainer = document.querySelector('.search-results-container');
const searchInputBar = document.getElementById('search-input');

// --- API Configuration ---
const PROXY_BASEURL = 'https://workers-playground-autumn-mouse-86e7.watchoutofficial2006.workers.dev';
// Fetch movies + TV shows
const trendingResults = `${PROXY_BASEURL}/?url=trending/all/week`;

/**
 * Renders the fetched movie/TV results into the search container.
 * @param {Array<Object>} items - An array of movie/show objects.
 */
function renderResults(items) {
    let html = `<h2 style="color:#fff; margin-top:0.5rem; font-size: 18px;">Recommended Shows & Movies</h2>`;

    if (items.length === 0) {
        html += `<p style="padding: 15px; color: #888;">No trending results found this week.</p>`;
    } else {
        items.forEach((item) => {
            const id = item.id;
            const mediaType = item.media_type || (item.title ? "movie" : "tv"); 
            const title = item.title || item.name || 'Untitled Content';
            const poster = item.poster_path 
                ? `https://image.tmdb.org/t/p/w300${item.poster_path}` // small poster for list
                : 'https://via.placeholder.com/92x138?text=No+Image';

            html += `
                <div class="result-item" onclick="openModal(${id}, '${mediaType}')">
                    <img class="result-poster" src="${poster}" alt="${title}" />
                    <div class="result-title">${title}</div>
                </div>
            `;
        });
    }

    resultsContainer.innerHTML = html;
}


/**
 * Fetches trending results from the API with retry logic (Exponential Backoff).
 */
async function fetchTrendingResults() {
    // Display loading state
    resultsContainer.innerHTML = `<p style="color: #E50914; text-align: center; padding-top: 50px;">Loading trending data...</p>`;
    
    const maxRetries = 3;
    for (let attempt = 0; attempt < maxRetries; attempt++) {
        try {
            const response = await fetch(trendingResults);
            if (!response.ok) {
                if (response.status === 429 && attempt < maxRetries - 1) {
                    const delay = Math.pow(2, attempt) * 1000;
                    await new Promise(resolve => setTimeout(resolve, delay));
                    continue;
                }
                throw new Error(`HTTP error! Status: ${response.status}`);
            }

            const data = await response.json();
            if (data && data.results) {
                renderResults(data.results.slice(0, 12)); // Show 12 posters
                return;
            } else {
                throw new Error("Invalid data structure received.");
            }
        } catch (error) {
            if (attempt === maxRetries - 1) {
                console.error("Error fetching trending data after retries:", error);
                resultsContainer.innerHTML = `
                    <p style="color: #ff3333; text-align: center; padding-top: 50px;">
                        Failed to load trending content.
                    </p>
                    <p style="color: #555; font-size: 0.8rem; text-align: center;">
                        Error: ${error.message}
                    </p>
                `;
            }
        }
    }
}


        // --- Event Listeners and Initialization ---

        /**
         * Opens the search overlay by adding the 'is-visible' class.
         */
        /*openButton.addEventListener('click', () => {
            searchPage.classList.add('is-visible');
            // Give a slight delay to ensure the transition starts, then focus the input
            setTimeout(() => {
                document.querySelector('.search-input').focus();
            }, 50);
        });*/

        /**
         * Closes the search overlay by removing the 'is-visible' class.
         */
         // Search input event listener
        searchInputBar.addEventListener('input', function () {
            const inputquery = this.value.trim();
            debouncedSearch(inputquery);
        });
      
        closeButton.addEventListener('click', () => {
            searchPage.classList.remove('is-visible');
        });

        // Optional: Close on ESC key press
        document.addEventListener('keydown', (event) => {
            if (event.key === 'Escape' && searchPage.classList.contains('is-visible')) {
                searchPage.classList.remove('is-visible');
            }
        });
      
        // Fetch data immediately when the app loads so it's ready when the user opens the search.
        window.onload = fetchTrendingResults;

    </script>
 <div class="report-modal" id="reportModal">
    <div class="report-modal-box">
      <div class="report-modal-header">
        <h2 class="report-modal-title">Report an Issue</h2>
        <button class="report-close-btn" onclick="closeReportModal()">&times;</button>
      </div>

      <div class="report-modal-body">
        <label for="issueType">Issue Type</label>
        <select id="issueType">
          <option value="">Select an issue</option>
          <option value="video">Video not playing</option>
          <option value="audio">Audio issue</option>
          <option value="subtitle">Subtitle issue</option>
          <option value="buffer">Buffering or slow playback</option>
          <option value="other">Other</option>
        </select>

        <label for="issueDesc">Description (optional)</label>
        <textarea id="issueDesc" placeholder="Describe the problem"></textarea>
      </div>

      <div class="report-modal-footer">
        <button class="report-submit-btn" id="submitBtn" onclick="submitIssue()" disabled>
          Submit
        </button>
      </div>
    </div>
  </div>   
<div id="overlay" onclick="closeModal()" class="modal-overlay""></div>
    <div class="iframe-holder" id="iframe-holder">
            <a class="player-close" onclick="closePlayer()"><svg xmlns="http://www.w3.org/2000/svg" fill="none" role="img" viewBox="0 0 24 24" width="24" height="24" data-icon="XStandard" aria-hidden="true">
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.5858 12L2.29291 3.70706L3.70712 2.29285L12 10.5857L20.2929 2.29285L21.7071 3.70706L13.4142 12L21.7071 20.2928L20.2929 21.7071L12 13.4142L3.70712 21.7071L2.29291 20.2928L10.5858 12Z" fill="currentColor"></path>

</svg></a>
        </div>
	
    <div id="tmdb-modal" style="visibility: hidden;" class="tmdb-modal">
      <button onclick="closeModal()" style="margin-bottom:10px" class="icon-button">
                <!-- Back/Close Arrow SVG -->
                <svg class="icon" viewBox="0 0 24 24">
                    <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"></path>
                </svg>
      </button>
	    <section id="channel-content" class="channel-content" style="display:none;">
		
		</section>
	  
        
      
        <div id="modal-content" class="modal-content">
             <div id="playerWrap">
                <div class="modal-backdrop-container" id="modal-backdrop-container">
                // content goes here dynamically by container.innerhtml on openmodal
                </div>
             </div>
          
<div id="modal-logo-container" class="modal-logo-container"></div>
<div class="model-info-container">
<div class="previewModal--detailsMetadata"> 
<div>
<div class="model-title" id="modal-title">Loading...</div>
<div class="model-year-rating">
<span class="model-year" id="modal-year"></span>
<span class="model-rating" id="modal-rating"></span>
<span class="model-extra" id="modal-runtime"></span>
<span class="player-feature-badge">HD</span>
<div class="ltr-bjn8wh" bis_skin_checked="1" ">
  <div class="ltr-x1hvkl" bis_skin_checked="1" style="display: flex;gap: 0.75em 12px;align-items: center;">
    <div style="display: flex;" aria-labelledby="standaloneAudioDescriptionAvailable" data-tooltip="Audio description is available" bis_skin_checked="1"><svg xmlns="http://www.w3.org/2000/svg" fill="none" role="img" viewBox="0 0 24 24" width="24" height="24" data-icon="AudioDescriptionStandard" aria-hidden="true" class="ltr-18tpq4v">
<path fill-rule="evenodd" clip-rule="evenodd" d="M21.9782 7.52002H22.2621C23.37 8.81831 24.0001 10.4801 24.0001 12.2077C24.0001 13.7414 23.505 15.2301 22.6221 16.4453H22.3348H21.8501H21.5662C22.5598 15.2613 23.1207 13.7691 23.1207 12.2077C23.1207 10.449 22.404 8.75599 21.1611 7.52002H21.445H21.9782ZM6.91381 16.4796H8.87336V7.52661H6.42566L0 16.4796H2.87701L3.63174 15.2956H6.91381V16.4796ZM4.8625 13.4299H6.92592V10.224L4.8625 13.4299ZM12.3019 9.62283C13.621 9.62283 14.6839 10.6926 14.6839 12.0048C14.6839 13.3203 13.621 14.3901 12.3019 14.3901H11.6787V9.62283H12.3019ZM12.5443 16.4743C15.0128 16.4743 17.0208 14.4698 17.0208 12.0048C17.0208 9.52935 15.0335 7.52826 12.565 7.52826H12.5373H9.79883V16.4778H12.5443V16.4743ZM20.0103 7.52002H19.7264H19.1932H18.9093C20.1522 8.75599 20.8689 10.449 20.8689 12.2077C20.8689 13.7691 20.308 15.2613 19.3144 16.4453H19.5983H20.083H20.3634C21.2531 15.2301 21.7482 13.7414 21.7482 12.2077C21.7482 10.4801 21.1181 8.81831 20.0103 7.52002ZM17.4745 7.52002H17.7584C18.8663 8.81831 19.4895 10.4801 19.4895 12.2077C19.4895 13.7414 19.0013 15.2301 18.1116 16.4453H17.8277H17.3464H17.0625C18.0492 15.2613 18.6101 13.7691 18.6101 12.2077C18.6101 10.449 17.9004 8.75599 16.6575 7.52002H16.9344H17.4745Z" fill="currentColor"></path>

</svg></div><div style="display: flex;" aria-labelledby="standaloneTextClosedCaptionsAvailable" data-tooltip="Subtitles for the deaf and hard of hearing are available" bis_skin_checked="1"><svg xmlns="http://www.w3.org/2000/svg" fill="none" role="img" viewBox="0 0 16 16" width="16" height="16" data-icon="SubtitlesSmall" aria-hidden="true">
<path fill-rule="evenodd" clip-rule="evenodd" d="M0 1.75C0 1.33579 0.335786 1 0.75 1H15.25C15.6642 1 16 1.33579 16 1.75V12.25C16 12.6642 15.6642 13 15.25 13H12.75V15C12.75 15.2652 12.61 15.5106 12.3817 15.6456C12.1535 15.7806 11.8709 15.785 11.6386 15.6572L6.80736 13H0.75C0.335786 13 0 12.6642 0 12.25V1.75ZM1.5 2.5V11.5H7H7.19264L7.36144 11.5928L11.25 13.7315V12.25V11.5H12H14.5V2.5H1.5ZM6 6.5L3 6.5V5L6 5V6.5ZM13 7.5H10V9H13V7.5ZM3 9V7.5L9 7.5V9L3 9ZM13 5H7V6.5H13V5Z" fill="currentColor"></path>

</svg></div></div></div>
</div>
<div class="action-buttons">
<button class="play-button" id="modal-play" style="display: none;">
  <svg xmlns="http://www.w3.org/2000/svg" fill="none" role="img" viewBox="0 0 24 24" width="24" height="24" data-icon="PlayStandard" aria-hidden="true">
    <path d="M5 2.69127C5 1.93067 5.81547 1.44851 6.48192 1.81506L23.4069 11.1238C24.0977 11.5037 24.0977 12.4963 23.4069 12.8762L6.48192 22.1849C5.81546 22.5515 5 22.0693 5 21.3087V2.69127Z" fill="currentColor"></path>
  </svg>
  <span>Watch</span>
  <span style="font-size:11px;opacity:0.85;">(Free with Ads)</span>

</button>
<button class="play-button" id="play-provider" style="display: none;margin-top: 5px;"></button>
<button class="download-btn" id="modal-download" style="display:none;">Download</button>
</div>
<p class="model-overview" id="modal-overview"></p>
</div>
  
<div>
 <p class="previewModal--tags" style="display: block !important;"><span class="previewModal--tags-label">Cast:</span> <span class="modal-cast" id="modal-cast"></span></p>
 <p class="previewModal--tags"><span class="previewModal--tags-label">Genres:</span> <span class="modal-genres" id="modal-genres"></span></p>
 <p class="previewModal--tags"><span id="keywords-tag" class="previewModal--tags-label">This Show is:</span> <span class="modal-keywords" id="modal-keywords"></span></p>
 </div>
</div>  
<ion-row class="ion-align-items-center model-rating-box">
<ion-col style="flex: 0 0 calc(calc(3 / var(--ion-grid-columns, 12)) * 100%); max-width: calc(calc(3 / var(--ion-grid-columns, 12)) * 100%); width: calc(calc(3 / var(--ion-grid-columns, 12)) * 100%);">
<div class="btn-vertical btn-mylist2 myList1">
<ion-icon class="md hydrated" ><svg id="myListSvg" xmlns="http://www.w3.org/2000/svg" fill="none" role="img" viewBox="0 0 24 24" width="24" height="24" data-icon="PlusStandard" aria-hidden="true">
<path fill-rule="evenodd" clip-rule="evenodd" d="M11 11V2H13V11H22V13H13V22H11V13H2V11H11Z" fill="currentColor"></path>
</svg> </ion-icon>
<span class="btn">My List</span>
</div>
</ion-col>
<ion-col style="flex: 0 0 calc(calc(3 / var(--ion-grid-columns, 12)) * 100%); max-width: calc(calc(3 / var(--ion-grid-columns, 12)) * 100%); width: calc(calc(3 / var(--ion-grid-columns, 12)) * 100%);">
<div class="btn-vertical">
<ion-icon class="md hydrated"><svg xmlns="http://www.w3.org/2000/svg" fill="none" role="img" viewBox="0 0 24 24" width="24" height="24" data-icon="ThumbsUpStandard" aria-hidden="true">
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.696 8.7732C10.8947 8.45534 11 8.08804 11 7.7132V4H11.8377C12.7152 4 13.4285 4.55292 13.6073 5.31126C13.8233 6.22758 14 7.22716 14 8C14 8.58478 13.8976 9.1919 13.7536 9.75039L13.4315 11H14.7219H17.5C18.3284 11 19 11.6716 19 12.5C19 12.5929 18.9917 12.6831 18.976 12.7699L18.8955 13.2149L19.1764 13.5692C19.3794 13.8252 19.5 14.1471 19.5 14.5C19.5 14.8529 19.3794 15.1748 19.1764 15.4308L18.8955 15.7851L18.976 16.2301C18.9917 16.317 19 16.4071 19 16.5C19 16.9901 18.766 17.4253 18.3994 17.7006L18 18.0006L18 18.5001C17.9999 19.3285 17.3284 20 16.5 20H14H13H12.6228C11.6554 20 10.6944 19.844 9.77673 19.5382L8.28366 19.0405C7.22457 18.6874 6.11617 18.5051 5 18.5001V13.7543L7.03558 13.1727C7.74927 12.9688 8.36203 12.5076 8.75542 11.8781L10.696 8.7732ZM10.5 2C9.67157 2 9 2.67157 9 3.5V7.7132L7.05942 10.8181C6.92829 11.0279 6.72404 11.1817 6.48614 11.2497L4.45056 11.8313C3.59195 12.0766 3 12.8613 3 13.7543V18.5468C3 19.6255 3.87447 20.5 4.95319 20.5C5.87021 20.5 6.78124 20.6478 7.65121 20.9378L9.14427 21.4355C10.2659 21.8094 11.4405 22 12.6228 22H13H14H16.5C18.2692 22 19.7319 20.6873 19.967 18.9827C20.6039 18.3496 21 17.4709 21 16.5C21 16.4369 20.9983 16.3742 20.995 16.3118C21.3153 15.783 21.5 15.1622 21.5 14.5C21.5 13.8378 21.3153 13.217 20.995 12.6883C20.9983 12.6258 21 12.5631 21 12.5C21 10.567 19.433 9 17.5 9H15.9338C15.9752 8.6755 16 8.33974 16 8C16 6.98865 15.7788 5.80611 15.5539 4.85235C15.1401 3.09702 13.5428 2 11.8377 2H10.5Z" fill="currentColor"></path>

</svg></ion-icon>
<span class="btn">Rate</span>
</div>
</ion-col>
<ion-col class="share-btn" style="flex: 0 0 calc(calc(3 / var(--ion-grid-columns, 12)) * 100%); max-width: calc(calc(3 / var(--ion-grid-columns, 12)) * 100%); width: calc(calc(3 / var(--ion-grid-columns, 12)) * 100%);">
<div class="btn-vertical">
<ion-icon class="md hydrated">
<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="24px" height="24px" viewBox="0,0,256,256"
style="fill:#FFFFFF;">
<g fill="#ffffff" fill-rule="nonzero" stroke="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="10" stroke-dasharray="" stroke-dashoffset="0" font-family="none" font-weight="none" font-size="none" text-anchor="none" style="mix-blend-mode: normal"><g transform="scale(10.66667,10.66667)"><path d="M18,2c-1.65685,0 -3,1.34315 -3,3c0.00061,0.18815 0.01892,0.37583 0.05469,0.56055l-7.11523,4.15039c-0.54194,-0.45909 -1.22919,-0.71102 -1.93945,-0.71094c-1.65685,0 -3,1.34315 -3,3c0,1.65685 1.34315,3 3,3c0.70916,-0.00139 1.3949,-0.25396 1.93555,-0.71289l7.11914,4.15234c-0.03577,0.18472 -0.05408,0.3724 -0.05469,0.56055c0,1.65685 1.34315,3 3,3c1.65685,0 3,-1.34315 3,-3c0,-1.65685 -1.34315,-3 -3,-3c-0.70983,0.00093 -1.39634,0.25353 -1.9375,0.71289l-7.11719,-4.15234c0.03577,-0.18472 0.05408,-0.3724 0.05469,-0.56055c-0.00061,-0.18815 -0.01892,-0.37583 -0.05469,-0.56055l7.11523,-4.15039c0.54194,0.45909 1.22919,0.71102 1.93945,0.71094c1.65685,0 3,-1.34315 3,-3c0,-1.65685 -1.34315,-3 -3,-3z"></path></g></g>
</svg>
</ion-icon>
<span class="btn">Share</span>
</div>
</ion-col>
<ion-col style="flex: 0 0 calc(calc(3 / var(--ion-grid-columns, 12)) * 100%); max-width: calc(calc(3 / var(--ion-grid-columns, 12)) * 100%); width: calc(calc(3 / var(--ion-grid-columns, 12)) * 100%);">
<div class="btn-vertical">
<ion-icon class="md hydrated" onclick="openReportModal()" ><img class="svg-icon" loading="lazy" src="https://net20.cc/mobile/img/report2222.svg" /></ion-icon>
<span class="btn">Reports</span>
</div>
</ion-col>
</ion-row>
  <nav class="nav-tabs">
        
        <button id="episode-tab" class="episode-tab nav-tab active" onclick="switchTab('episodes', this)">Episodes</button>
        <button id="collection-tab" class="collection-tab nav-tab" onclick="switchTab('collection-container', this)">Collection</button>
        <button id="more-like-this-tab" class="nav-tab" onclick="switchTab('more-like-this-container', this)">More Like This</button>
        <button class="nav-tab" onclick="switchTab('trailers-container', this)">Trailers & More</button>
        <button class="nav-tab" onclick="switchTab('about-wrapper', this)">About</button>
    </nav>
<div id="episodes" class="tab-content active">
<div id="season-episode-controls" style="margin-top: 15px; display: none; display: flex; justify-content: space-between; align-items: center;">
<h3 style="font-size: 24px; margin-bottom: 0;">Episodes</h3>
<div id="season-selector-container" >
<select id="season-selector"></select>
</div>
</div>
<div id="episodes-container" style="margin-top: 15px; display: none; border: 1px solid #444; border-radius: 10px;">
<ul id="episode-list"></ul>
</div>
</div>
  
<div id="collection-wrapper" class="titleGroup--wrapper">    
<div id="collection-container" class="tab-content">
<p class="previewModal--section-header titleGroup--header"><svg viewBox="0 0 24 24" width="24" height="24" data-icon="CollectionMedium" data-icon-id=":rgs:" aria-hidden="true" class="title-group-collection" xmlns="http://www.w3.org/2000/svg" fill="none" role="img">
<path fill-rule="evenodd" clip-rule="evenodd" d="M2 3C0.895431 3 0 3.89543 0 5V19C0 20.1046 0.895431 21 2 21H22C23.1046 21 24 20.1046 24 19V5C24 3.89543 23.1046 3 22 3H2ZM2 5H22V19H2V5ZM5 7V17H7V7H5ZM9 17V7H11V17H9ZM13.0715 7.37139L17.0715 17.3714L18.9285 16.6286L14.9285 6.62861L13.0715 7.37139Z" fill="currentColor"></path>
</svg>
Collection
</p>
<div id="collection" style="display: grid; gap: 10px; overflow-x: auto;"></div>
</div>
</div>  
  
<div id="more-like-this-wrapper">  
<div id="more-like-this-container" class="tab-content">
<h3>More Like This</h3>
<div id="more-like-this" style="display: grid; gap: 10px; overflow-x: auto;"></div>
</div>
</div> 
  
<div id="trailers-container" class="tab-content">
  <h3>Trailers & More</h3>
  <div id="modal-videos" class="modal-videos" ></div>
</div>
  
  <div class="about-wrapper tab-content" id="about-wrapper">
    <div class="about-header">
      <h3 id="previewModal--section-header" class="previewModal--section-header" >About</h3>
    </div>
    <div class="about-container" data-uia="about-container">
      <p class="mobile previewModal--tags"><span class="previewModal--tags-label">Creators:</span> <span class="modal-creators" id="modal-creators"></span></p>
      <p class="mobile previewModal--tags"><span class="previewModal--tags-label">Cast:</span> <span class="modal-cast" id="modal-cast"></span></p>
      <p class="mobile previewModal--tags"><span class="previewModal--tags-label">Genres:</span> <span class="modal-genres" id="modal-genres"></span></p>
      <p class="mobile previewModal--tags"><span class="previewModal--tags-label">This Show is:</span> <span class="modal-keywords"id="modal-keywords"></span></p>
      <p class="mobile previewModal--tags"><span class="previewModal--tags-label">Maturity Rating:</span> <span class="modal-certification"id="modal-certification"></span></p>
    </div>
  </div>
</div>
</div>
</div>
<script>
        function switchTab(tabName, element) {
            const moreLikeThisTab = document.getElementById('more-like-this-tab');
            // Remove active class from all tabs
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active class from all content
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Add active class to clicked tab
            element.classList.add('active');
            
            // Show corresponding content
            document.getElementById(tabName).classList.add('active');
        }
    </script>

<script>
async function renderCollection(sectionId, jsonUrl, heading) {
  const section = document.getElementById(sectionId);
  section.className = "cards-section";
  section.style.background = "#000";

  section.innerHTML = `
    <h2>${heading}</h2>
    <div id="${sectionId}-Container" class="cards-container"></div>
  `;

  const container = document.getElementById(`${sectionId}-Container`);

  const scrollLeftBtn = document.createElement('button');
  scrollLeftBtn.className = 'scroll-button left';
  scrollLeftBtn.innerText = 'â®';
  scrollLeftBtn.onclick = () => scrollLeftHandler(`${sectionId}-Container`);

  const scrollRightBtn = document.createElement('button');
  scrollRightBtn.className = 'scroll-button right';
  scrollRightBtn.innerText = 'â¯';
  scrollRightBtn.onclick = () => scrollRightHandler(`${sectionId}-Container`);

  section.appendChild(scrollLeftBtn);
  section.appendChild(scrollRightBtn);

  try {
    const response = await fetch(jsonUrl);
    const items = await response.json();

    if (!container) return;
    container.innerHTML = "";

    const isMobile = window.innerWidth <= 900;

    items.forEach(item => {
      const card = document.createElement("div");
      card.className = "card";
      card.onclick = () => openModal(item.id, item.mediaType);

      const imageUrl = isMobile ? item.poster : item.backdrop;

      card.innerHTML = `
        <img src="${imageUrl}" alt="${item.title}" />
      `;
      container.appendChild(card);
    });
  } catch (error) {
    console.error(`Failed to load collection from ${jsonUrl}:`, error);
  }
}

function scrollLeftHandler(containerId) {
  const container = document.getElementById(containerId);
  if (container) {
    container.scrollBy({ left: -950, behavior: 'smooth' });
  }
}

function scrollRightHandler(containerId) {
  const container = document.getElementById(containerId);
  if (container) {
    container.scrollBy({ left: 950, behavior: 'smooth' });
  }
}


const mcuUrl = "https://raw.githubusercontent.com/Watchout2025/RPM-Title-Fixer/refs/heads/main/mcu.json";
const bollywoodUrl = "https://raw.githubusercontent.com/Watchout2025/RPM-Title-Fixer/refs/heads/main/movies/bollywood.json";
const hollywoodUrl = "https://raw.githubusercontent.com/Watchout2025/RPM-Title-Fixer/refs/heads/main/movies/hollywood.json";
const kdramaUrl = "https://raw.githubusercontent.com/Watchout2025/RPM-Title-Fixer/refs/heads/main/tv/korean.json";
const cdramaUrl = "https://raw.githubusercontent.com/Watchout2025/RPM-Title-Fixer/refs/heads/main/tv/china.json";
const animeUrl = "https://raw.githubusercontent.com/Watchout2025/RPM-Title-Fixer/refs/heads/main/anime.json";
const southUrl = "https://raw.githubusercontent.com/Watchout2025/RPM-Title-Fixer/refs/heads/main/south.json";
const wweUrl = "https://raw.githubusercontent.com/Watchout2025/RPM-Title-Fixer/refs/heads/main/wwe.json";
const animationUrl = "https://raw.githubusercontent.com/Watchout2025/RPM-Title-Fixer/refs/heads/main/animation.json";
const usTvUrl = "https://raw.githubusercontent.com/Watchout2025/RPM-Title-Fixer/refs/heads/main/tv/us.json";
const indianTv = "https://raw.githubusercontent.com/Watchout2025/RPM-Title-Fixer/refs/heads/main/indianTv.json";
const docTv = "https://raw.githubusercontent.com/Watchout2025/RPM-Title-Fixer/refs/heads/main/docTv.json";

  
function renderTVSections(genre) {
  showSection('home');
  navigateTo('/TV');

  updateSpotlight(
    119051, // movie id
    "tv", // mediaType
    "https://image.tmdb.org/t/p/w1280/qg8Gv2w0dDL8cMsG2QO2hWp58wy.jpg", // backdrop
    "https://image.tmdb.org/t/p/original/2ErLAiKF2aMJfhqcRAL2qteyvvl.png", // logo
    "Smart, sarcastic and a little dead inside, Wednesday Addams investigates twisted mysteries while making new friends â€” and foes â€” at Nevermore Academy.", // overview
    "Wednesday" // title
  );

  // helper function to adjust URL based on genre
  const withGenre = (baseUrl) => {
    if (!genre) return baseUrl;
    if (baseUrl.endsWith(".json")) {
      return baseUrl.replace(/([^/]+)\.json$/, `$1/${genre}.json`);
    }
    return `${baseUrl}/${genre}.json`;
  };

  renderCollection("section1", withGenre(kdramaUrl), "Korean TV Shows");
  renderCollection("section2", withGenre(indianTv), "Indian TV Shows");
  renderCollection("section3", withGenre(cdramaUrl), "Chinese TV Shows");
  renderCollection("section4", withGenre(animeUrl), "Anime");
  renderCollection("section5", withGenre(usTvUrl), "US TV Shows");
  renderCollection("section6", withGenre(docTv), "Documentary TV Shows");

  window.scrollTo(0, 0);
}


  
function renderMovieSections(genre) {
    showSection('home');
    navigateTo('/Movies')
    updateSpotlight(
      911430, // movie id
      "movie", //mediaType
      "https://image.tmdb.org/t/p/w1280/1KFv63mmcBGVbFl3jxxozoSFlhA.jpg", // backdrop
      "https://image.tmdb.org/t/p/original/3LDmYRcnmQjqog9IRCMkp4MbnDI.png", // logo
      "Racing legend Sonny Hayes is coaxed out of retirement to lead a struggling Formula 1 teamâ€”and mentor a young hotshot driverâ€”while chasing one more chance at glory.", // overview
      "F1" // title
    );

    // helper function to adjust URL based on genre
  const withGenre = (baseUrl) => {
    if (!genre) return baseUrl;
    if (baseUrl.endsWith(".json")) {
      return baseUrl.replace(/([^/]+)\.json$/, `$1/${genre}.json`);
    }
    return `${baseUrl}/${genre}.json`;
  };

    renderCollection("section1", southUrl, "South Indian Cinema");
    renderCollection("section2", bollywoodUrl, "Bollywood Collection");
    renderCollection("section3",withGenre( hollywoodUrl), "Hollywood Collection");
    renderCollection("section4", animationUrl, "Animated");
    const subheader = document.querySelector(".sub-header")
    subheader.style.display = 'block';
    window.scrollTo(0, 0);
}

  function renderAnimeSections() {
    navigateTo('/Anime')
    showSection('home');
    updateSpotlight(
      207468, // movie id
      "tv", //mediaType
      "https://image.tmdb.org/t/p/w1280/9DrORnlwnjt5SeJKcuE5sqOoIdV.jpg", // backdrop
      "https://image.tmdb.org/t/p/original/3LLPafM7SMSaFzxdy3Pdy1kQGe4.svg", // logo
      "In a world plagued by creatures known as Kaiju, Kafka Hibino aspired to enlist in The Defense Force. He makes a promise to enlist with his childhood friend, Mina Ashiro. Soon, life takes them in separate ways. While employed cleaning up after Kaiju battles, Kafka meets Reno Ichikawa. Reno's determination to join The Defense Force reawakens Kafka's promise to join Mina and protect humanity.", // overview
      "Kaiju No. 8" // title
    );
    renderCollection("section1", animeUrl, "Anime");
    window.scrollTo(0, 0);
}
  
function renderMyListSections() {
    navigateTo('/My-List')
    showSection('my-netflix');
    window.scrollTo(0, 0);
    const subheader = document.querySelector(".sub-header")
    subheader.style.display = 'none';
}

function renderHomeSections() {
    const path = "/home";
    // Only push if it's not already the same path
    if (location.pathname.toLowerCase() !== path.toLowerCase()) {
      history.pushState({}, "", path);
    }
    showSection('home');
    updateSpotlight(
      119051, // movie id
      "tv", // mediaType
      "https://image.tmdb.org/t/p/w1280/iHSwvRVsRyxpX7FE7GbviaDvgGZ.jpg", // backdrop
      "https://image.tmdb.org/t/p/original/2ErLAiKF2aMJfhqcRAL2qteyvvl.png", // logo
      "Smart, sarcastic and a little dead inside, Wednesday Addams investigates twisted mysteries while making new friends â€” and foes â€” at Nevermore Academy.", // overview
      "Wednesday" // title
    );
    renderSectionsByCountry();
    window.scrollTo(0, 0);
    const subheader = document.querySelector(".sub-header")
    subheader.style.display = 'none';
}
    // Function to fetch visitor's country using ipapi.co (free tier available, no API key needed)
async function getVisitorCountry() {
  try {
    const response = await fetch('https://ipapi.co/json/');
    const data = await response.json();
    return data.country_name || 'Unknown'; // Fallback to 'Unknown' if detection fails
  } catch (error) {
    console.error('Error fetching country:', error);
    return 'Unknown'; // Fallback on error (e.g., network issues)
  }
}

// Mapping of country to prioritized section order
// Add more countries as needed; each value is an array of {url, title} objects in desired render order
const countrySectionOrder = {
  'India': [
	{url: bollywoodUrl, title: 'Bollywood Movies' },
	{ url: southUrl, title: 'South Indian Cinema' },
    { url: hollywoodUrl, title: 'Hollywood Movies' },
    { url: usTvUrl, title: 'US TV Shows' },
    { url: kdramaUrl, title: 'Korean TV Shows' },
	{ url: indianTv, title: 'Indian TV Shows' },
    { url: cdramaUrl, title: 'Chinese TV Shows' },
    { url: animeUrl, title: 'Anime' },
    { url: mcuUrl, title: 'Marvel Collection' },
    { url: wweUrl, title: 'WWE' },
    { url: animationUrl, title: 'Animated Movies' }
  ],
  'United States': [
    { url: hollywoodUrl, title: 'Hollywood Movies' },     // Prioritize US/Hollywood content
    { url: usTvUrl, title: 'US TV Shows' },
    { url: mcuUrl, title: 'Marvel Collection' },
    { url: wweUrl, title: 'WWE' },
    { url: animationUrl, title: 'Animated Movies' },
    { url: bollywoodUrl, title: 'Bollywood Movies' },
    { url: southUrl, title: 'South Indian Cinema' },
    { url: indianTv, title: 'Indian TV Shows' },
    { url: kdramaUrl, title: 'Korean TV Shows' },
    { url: cdramaUrl, title: 'Chinese TV Shows' },
    { url: animeUrl, title: 'Anime' }
  ],
  'South Korea': [
    { url: kdramaUrl, title: 'Korean TV Shows' },         // Prioritize Korean content
    { url: animeUrl, title: 'Anime' },
    { url: cdramaUrl, title: 'Chinese TV Shows' },
    { url: hollywoodUrl, title: 'Hollywood Movies' },
    { url: usTvUrl, title: 'US TV Shows' },
    { url: bollywoodUrl, title: 'Bollywood Movies' },
    { url: southUrl, title: 'South Indian Cinema' },
    { url: indianTv, title: 'Indian TV Shows' },
    { url: mcuUrl, title: 'Marvel Collection' },
    { url: wweUrl, title: 'WWE' },
    { url: animationUrl, title: 'Animated Movies' }
  ],
  'China': [
    { url: cdramaUrl, title: 'Chinese TV Shows' },        // Prioritize Chinese content
    { url: kdramaUrl, title: 'Korean TV Shows' },
    { url: animeUrl, title: 'Anime' },
    { url: hollywoodUrl, title: 'Hollywood Movies' },
    { url: usTvUrl, title: 'US TV Shows' },
    { url: bollywoodUrl, title: 'Bollywood Movies' },
    { url: southUrl, title: 'South Indian Cinema' },
    { url: indianTv, title: 'Indian TV Shows' },
    { url: mcuUrl, title: 'Marvel Collection' },
    { url: wweUrl, title: 'WWE' },
    { url: animationUrl, title: 'Animated Movies' }
  ],
  'Japan': [
    { url: animeUrl, title: 'Anime' },                    // Prioritize Anime
    { url: kdramaUrl, title: 'Korean TV Shows' },
    { url: cdramaUrl, title: 'Chinese TV Shows' },
    { url: hollywoodUrl, title: 'Hollywood Movies' },
    { url: usTvUrl, title: 'US TV Shows' },
    { url: bollywoodUrl, title: 'Bollywood Movies' },
    { url: southUrl, title: 'South Indian Cinema' },
    { url: indianTv, title: 'Indian TV Shows' },
    { url: mcuUrl, title: 'Marvel Collection' },
    { url: wweUrl, title: 'WWE' },
    { url: animationUrl, title: 'Animated Movies' }
  ],
  'Unknown': [                                             // Default/fallback order (your current order)
    { url: hollywoodUrl, title: 'Hollywood Movies' },
	{ url: bollywoodUrl, title: 'Bollywood Movies' },
    { url: southUrl, title: 'South Indian Cinema' },
    { url: kdramaUrl, title: 'Korean TV Shows' },
    { url: indianTv, title: 'Indian TV Shows' },
    { url: cdramaUrl, title: 'Chinese TV Shows' },
    { url: animeUrl, title: 'Anime' },
    { url: usTvUrl, title: 'US TV Shows' },
    { url: mcuUrl, title: 'Marvel Collection' },
    { url: wweUrl, title: 'WWE' },
    { url: animationUrl, title: 'Animated Movies' }
  ]
  // Add more countries here, e.g., 'Canada': [...], 'United Kingdom': [...]
};

// Main function to render sections based on country
async function renderSectionsByCountry() {
  const country = await getVisitorCountry();
  console.log(`Visitor country detected: ${country}`);
  
  const sections = countrySectionOrder[country] || countrySectionOrder['Unknown']; // Use fallback if country not mapped
  
  // Render in the prioritized order (loop through the array)
  sections.forEach((section, index) => {
    const sectionId = `section${index + 1}`; // Assumes your sections are ID'd as section1, section2, etc.
    renderCollection(sectionId, section.url, section.title);
  });
}

// Call this on page load instead of your static render calls
renderSectionsByCountry();
</script>



<script>
const API_KEY = '';
const IMAGE_BASE = 'https://image.tmdb.org/t/p/';
const POSTER_SIZE = 'w300';
const BACKDROP_SIZE = 'original';
const MAIN_WORKER_BASE_URL = 'https://workers-playground-autumn-mouse-86e7.watchoutofficial2006.workers.dev/';
const HLS_WORKER_BASE_URL = 'https://earnvids-proxy.watchoutofficial2006.workers.dev/';
const RPM_WORKER_BASE_URL = 'https://hlsworker.infinitynews2021.workers.dev/';

// Helper function to save to Continue Watching in localStorage
function saveToContinueWatching(id, mediaType, posterPath, backdropPath) {
    let continueWatching = JSON.parse(localStorage.getItem('continueWatching') || '[]');
    
    // Convert the incoming id to a string to ensure consistent comparison
    const incomingId = String(id);
    
    // Filter out items where the ID matches the incoming ID after converting to a string
    continueWatching = continueWatching.filter(item => !(String(item.id) === incomingId && item.mediaType === mediaType));
    
    const fullPosterUrl = posterPath ? `${IMAGE_BASE}${POSTER_SIZE}${posterPath}` : '';
    const fullBackdropUrl = backdropPath ? `${IMAGE_BASE}${BACKDROP_SIZE}${backdropPath}` : '';

    continueWatching.unshift({ 
        id: incomingId, // Store the ID as a string to maintain consistency
        mediaType, 
        posterUrl: fullPosterUrl, 
        backdropUrl: fullBackdropUrl 
    });
    
    localStorage.setItem('continueWatching', JSON.stringify(continueWatching));
}

// Helper function to save to My List in localStorage
function saveToMyList(id, mediaType, posterPath) {
    let myList = JSON.parse(localStorage.getItem('myList') || '[]');
    myList = myList.filter(item => !(item.id === id && item.mediaType === mediaType));
    const fullPosterUrl = posterPath ? `${IMAGE_BASE}${POSTER_SIZE}${posterPath}` : '';
    myList.unshift({ id, mediaType, posterUrl: fullPosterUrl });
    localStorage.setItem('myList', JSON.stringify(myList));
}

// Save video progress to localStorage
function saveVideoProgress(uniqueContentId, currentTime, duration) {
    let videoProgress = JSON.parse(localStorage.getItem('videoProgress') || '{}');
    const percentage = Math.floor((currentTime / duration) * 100);
    videoProgress[uniqueContentId] = {
        currentTime: currentTime,
        duration: duration,
        percentage: percentage
    };
    localStorage.setItem('videoProgress', JSON.stringify(videoProgress));
    // Show next button only if id starts with tv_ and progress >= 95%
    const nextButton = document.getElementById('next-button');
     if (uniqueContentId.startsWith('tv') && percentage >= 90) {
        nextButton.classList.add('show');
    } else {
        nextButton.classList.remove('show');
    }
}

// Get video progress for a specific content item
function getVideoProgress(uniqueContentId) {
    let videoProgress = JSON.parse(localStorage.getItem('videoProgress') || '{}');
    return videoProgress[uniqueContentId] || null;
}

// Display progress bar below download button (for movies) or within episode list item (for TV)
function displayProgressBar(targetElement, progress) {
    const existingBar = targetElement.querySelector('.content-progress-bar');
    if (existingBar) {
        existingBar.remove();
    }

    if (progress && targetElement) {
        const progressBar = document.createElement('div');
        progressBar.className = 'content-progress-bar';
        progressBar.style.width = '100%';
        progressBar.style.height = '5px';
        progressBar.style.backgroundColor = '#333';
        progressBar.style.overflow = 'hidden';

        const progressIndicator = document.createElement('div');
        progressIndicator.style.width = progress.percentage + '%';
        progressIndicator.style.height = '100%';
        progressIndicator.style.borderRadius = '0px 5px 5px 0px';
        progressIndicator.style.backgroundColor = '#e50914';

        progressBar.appendChild(progressIndicator);
        targetElement.appendChild(progressBar);
    }
}

window.addEventListener('message', (event) => {
    // âš ï¸ CRITICAL: In a production environment, always verify the origin.
    // e.g., if (event.origin !== 'http://localhost:8000') return;

    const data = event.data;

    // Check for the custom event identifier 'videoTimeUpdate'
    if (data && data.event === 'videoTimeUpdate') {
        console.log("Video Progress Update from iframe:");
        console.log(`- Current Time: ${data.currentTime.toFixed(2)}s`);
        console.log(`- Duration: ${data.duration.toFixed(2)}s`);
        console.log(`- Paused: ${data.paused}`);
    }
});

// Set up player message listener to track progress
function setupPlayerListener(uniqueContentId) {
    const playerIframe = document.getElementById('movie-player-iframe');
    if (!playerIframe) return;

    // Get the origin of the currently loaded iframe
    const playerOrigin = new URL(playerIframe.src).origin;
    
    // Determine the type of player based on the origin or other data
    const isRpmPlayer = playerOrigin.includes('rpm');
    const isWatchoutPlayer = (playerOrigin === window.location.origin) || playerOrigin.includes('watchout'); // Adjust 'watchout' if your domain is different

    const messageHandler = function(event) {
        // --- Security Check ---
        // Only proceed if the message is from the expected iframe origin
        if (event.origin !== playerOrigin) return;
        
        // --- 1. RPM Player Logic (Polling based on 'Ready' status) ---
        if (isRpmPlayer) {
            if (event.data.playerStatus === 'Ready') {
                // Clear any existing interval to prevent duplication
                if (window.progressInterval) {
                    clearInterval(window.progressInterval);
                }
                
                // Start polling the RPM player for time every 5 seconds
                window.progressInterval = setInterval(() => {
                    playerIframe.contentWindow.postMessage({
                        command: 'getTime'
                    }, playerOrigin);
                }, 5000);
            }

            // Handle the time response (from polling)
            if (event.data.currentTime !== undefined && event.data.duration !== undefined) {
                saveVideoProgress(uniqueContentId, event.data.currentTime, event.data.duration);
            }
        } 
        
        // --- 2. Watchout Player Logic (Automatic timeupdate postMessage) ---
        else if (isWatchoutPlayer) {
            // Watchout player sends an automatic message on timeupdate
            if (event.data.event === 'videoTimeUpdate') {
                 // The HLS player broadcasts its time automatically, 
                 // no need for the 'Ready' status or polling interval.
                 
                 const currentTime = event.data.currentTime;
                 const duration = event.data.duration;
                 
                 // Save the progress
                 if (currentTime !== undefined && duration !== undefined) {
                     saveVideoProgress(uniqueContentId, currentTime, duration);
                 }
            }
        }
        
    }; // End of messageHandler

    // Remove previous handler if exists to avoid duplication
    if (window.currentMessageHandler) {
        window.removeEventListener('message', window.currentMessageHandler);
        if (window.progressInterval) {
            clearInterval(window.progressInterval); // Clear the polling interval
        }
    }

    window.currentMessageHandler = messageHandler;
    window.addEventListener('message', messageHandler);
}

// Helper function to format title into dotted string
function formatTitleForHls(title) {
    if (!title) return '';
    return title
        .toLowerCase()
        .replace(/&/g, 'and')
        .replace(/[,!*'"()\[\]{}]/g, '')     // remove symbols & brackets
        .replace(/[:/?\- ]/g, '.')           // convert separators (including ?) to dots
        .replace(/\.\.+/g, '.')              // collapse multiple dots
        .replace(/^\.+|\.+$/g, '');          // trim dots
}




// New function to find the latest watched episode for a TV show
function getLatestWatchedEpisode(seriesId) {
    let videoProgress = JSON.parse(localStorage.getItem('videoProgress') || '{}');
    let latestEpisode = null;
    let latestTimestamp = 0;
    
    for (let key in videoProgress) {
        if (key.startsWith(`tv_${seriesId}_`)) {
            let parts = key.split('_');
            if (parts.length >= 4) {
                let season = parseInt(parts[2]);
                let episode = parseInt(parts[3]);
                let progress = videoProgress[key];
                
                if (!latestEpisode || season > latestEpisode.season || 
                    (season === latestEpisode.season && episode > latestEpisode.episode)) {
                    latestEpisode = { season, episode, progress };
                }
            }
        }
    }
    
    return latestEpisode;
}

const REGION_PLAYER_MAP = [
  { match: ['tamil nadu'], url: 'https://watchout-tamil.rpmvid.com' },
  { match: ['telangana', 'andhra pradesh'], url: 'https://watchout-telugu.rpmvid.com' },
  { match: ['kerala'], url: 'https://watchout-malayalam.rpmvid.com' },
  { match: ['karnataka'], url: 'https://watchout-kannada.rpmvid.com' },
  { country: 'IN', url: 'https://watchout-hindi.rpmplay.me' }, // Default Hindi for India
  { country: 'PK', url: 'https://watchout-hindi.rpmplay.me' }, // Hindi player for Pakistan
  { country: 'default', url: 'https://watchouteng.rpmvid.com' } // English for rest
];


async function getRegionBasedPlayerBaseUrl() {
  try {
    const ipInfo = await fetch("https://ipapi.co/json").then(res => res.json());
    const country = ipInfo.country_code;
    const region = ipInfo.region.toLowerCase();

    for (const entry of REGION_PLAYER_MAP) {
      if (entry.match && entry.match.some(r => region.includes(r))) {
        return entry.url;
      }
      if (entry.country && entry.country === country) {
        return entry.url;
      }
    }

    // Fallback to default English player
    return REGION_PLAYER_MAP.find(e => e.country === 'default').url;
  } catch (error) {
    console.error("Failed to fetch location info:", error);
    return REGION_PLAYER_MAP.find(e => e.country === 'default').url;
  }
}

async function getMovieStreamingAndDownloadLink(movieItem, movieReleaseYear) {
  let currentPlayLink = null;
  let isHlsWorkerLink = false;
  let sourceUsed = "none";
  const movieTitle = movieItem.title;
  const movieId = movieItem.id;

  if (!movieId) {
    console.warn("âŒ Missing movie ID, cannot fetch links.");
    return { playLink: null, isHlsWorkerLink: false, source: sourceUsed };
  }

  // 1ï¸âƒ£ Try GitHub (Primary)
  const githubHlsUrl = `https://raw.githubusercontent.com/Watchout2025/api/refs/heads/main/hls/movie/${movieId}`;
  try {
    const githubRes = await fetch(githubHlsUrl);
    if (githubRes.ok) {
      const fileCode = (await githubRes.text()).trim();

      if (fileCode) {
        // Build full playable link
        currentPlayLink = `${fileCode}`;
        isHlsWorkerLink = true;
        sourceUsed = "GitHub";
        console.log(`âœ… Found GitHub HLS code for "${movieTitle}": ${fileCode}`);
        console.log(`âž¡ï¸ Final GitHub Play Link: ${currentPlayLink}`);
      } else if (fileCode.startsWith("http")) {
  // Wrap direct m3u8 in your player
  currentPlayLink = `${encodeURIComponent(fileCode)}`;
  isHlsWorkerLink = true;
  sourceUsed = "GitHub";
}
 else {
        console.warn(`âš ï¸ GitHub file for "${movieTitle}" is empty or invalid.`);
      }
    } else {
      console.warn(`âŒ No GitHub entry found for movie ID ${movieId}.`);
    }
  } catch (error) {
    console.error(`âš ï¸ Error fetching from GitHub for movie ID ${movieId}:`, error);
  }

  // 2ï¸âƒ£ Try RPM Worker â€” only if GitHub didn't work
  if (!currentPlayLink && movieTitle && movieReleaseYear) {
    const formattedMovieTitle = formatTitleForHls(movieTitle);
    const dottedTitle = `${formattedMovieTitle}.${movieReleaseYear}`;
    const rpmWorkerApiUrl = `${RPM_WORKER_BASE_URL}?title=${encodeURIComponent(dottedTitle)}`;

    try {
      const rpmRes = await fetch(rpmWorkerApiUrl);
      const rpmData = await rpmRes.json();

      if (rpmData?.result?.files?.length > 0) {
        const fileCode = rpmData.result.files[0].file_code;
        const playerBaseUrl = await getRegionBasedPlayerBaseUrl();
        currentPlayLink = `${playerBaseUrl}/#${fileCode}&api=all`;
        isHlsWorkerLink = false;
        sourceUsed = "RPM";
        console.log(`âœ… RPM Worker link for "${movieTitle}": ${currentPlayLink}`);
      } else {
        console.warn(`âš ï¸ No files from RPM worker for "${movieTitle}" (${dottedTitle}).`);
      }
    } catch (error) {
      console.error(`âš ï¸ Error fetching from RPM worker for "${movieTitle}" (${dottedTitle}):`, error);
    }
  }

  // 3ï¸âƒ£ Fallback to Videasy â€” only if still no link
  if (!currentPlayLink) {
    currentPlayLink = `https://player.videasy.net/movie/${movieItem.id}`;
    isHlsWorkerLink = true;
    sourceUsed = "Videasy";
    console.log(`ðŸ” Using fallback Videasy player link for "${movieTitle}": ${currentPlayLink}`);
  }

  // ðŸ§¾ Final return
  return {
    playLink: currentPlayLink,
    isHlsWorkerLink,
    source: sourceUsed
  };
}


// openModal Script
async function openModal(id, mediaType) {
    const modal = document.getElementById('tmdb-modal');
	const modalSection = document.getElementById('modal-content');
    const overlay = document.getElementById('overlay');
    const playerWrap = document.getElementById('playerWrap');
    const iframeContainer = document.getElementById('iframe-holder');
    const titleElement = document.getElementById('modal-title');
    const aboutHeading = document.getElementById('previewModal--section-header');
    const yearElement = document.getElementById('modal-year');
    const ratingElement = document.getElementById('modal-rating');
    const runtimeContainer = document.getElementById('modal-runtime');
    const overviewElement = document.getElementById('modal-overview');
    const seasonEpisodeControls = document.getElementById('season-episode-controls');
    const episodesContainer = document.getElementById('episodes-container');
    const episodeListContainer = document.getElementById('episode-list');
    const moreLikeThisContainer = document.getElementById('more-like-this-container');
    const collectionWrapper = document.getElementById('collection-wrapper');
    const collectionContainer = document.getElementById('collection-container');
    const collectionTab = document.getElementById('collection-tab');
    const moreLikeThis = document.getElementById('more-like-this');
    const episodes = document.getElementById('episodes');
    const keywordsTag = document.getElementById('keywords-tag');
    const downloadBtn = document.getElementById('modal-download');
    const episodeTab = document.getElementById('episode-tab');
	const channelSection = document.getElementById('channel-content');
    const isDesktop = window.innerWidth >= 1024;
    const spinnerHTML = `
                    <div class="loading-spinner-container">
                        <img
                            src="https://assets.nflxext.com/en_us/pages/wiplayer/site-spinner.png"
                            alt="Loading..."
                            onerror="this.onerror=null; this.src='https://placehold.co/64x64/cccccc/333333?text=Loading';">
                    </div>
                    <a class="player-close" onclick="closeModal()"><svg xmlns="http://www.w3.org/2000/svg" fill="none" role="img" viewBox="0 0 24 24" width="24" height="24" data-icon="XStandard" aria-hidden="true">
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.5858 12L2.29291 3.70706L3.70712 2.29285L12 10.5857L20.2929 2.29285L21.7071 3.70706L13.4142 12L21.7071 20.2928L20.2929 21.7071L12 13.4142L3.70712 21.7071L2.29291 20.2928L10.5858 12Z" fill="currentColor"></path>

</svg></a>
                `;
    const playIconSvg = `
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" role="img" viewBox="0 0 24 24" width="24" height="24" data-icon="PlayStandard" aria-hidden="true">
<path d="M5 2.69127C5 1.93067 5.81547 1.44851 6.48192 1.81506L23.4069 11.1238C24.0977 11.5037 24.0977 12.4963 23.4069 12.8762L6.48192 22.1849C5.81546 22.5515 5 22.0693 5 21.3087V2.69127Z" fill="currentColor"></path>

</svg>
    `;
  
    const url = `${window.location.pathname}?${mediaType}=${id}`;
    if (window.location.href !== window.location.origin + url) {
        history.pushState({ id, mediaType }, "", url);
    }
  
    overlay.style.display ='block';
    modal.style.visibility ='visible';
    modal.style.transform ='translateY(0)';
    modal.scrollTop = 0;
    document.body.style.overflow = 'hidden';
    document.documentElement.style.overflow = 'hidden';

    titleElement.textContent = 'Loading...';
    yearElement.textContent = '';
    ratingElement.textContent = '';
    runtimeContainer.textContent = '';
    overviewElement.textContent = '';
    playerWrap.innerHTML = `
    <a style="z-index: 2" class="modal-close" onclick="closeModal()"></a>  
    <div class="modal-backdrop-container" id="modal-backdrop-container">
    <!-- Backdrop Img -->
    </div>
    <div class="previewModal--outerwrapper" >
        <a class="modal-close" onclick="closeModal()"></a>
        <div class="shadow-wrap" style="
    position: absolute;
    z-index: 1;
    width: 100%;
    bottom: 0;
    height: 41%;
    background: linear-gradient(0deg, #181818, #ffffff00 100%);
"></div>
        <div class="previewModal">
<!-- Logo -->
<div id="modal-logo-container" class="previewModal-logo-con"></div>
<!-- Play Button -->
<div class="modal-controls">
<a>

<button class="play-button2" id="modal-play" type="button">
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"
aria-hidden="true">
<path
d="M5 2.69127C5 1.93067 5.81547 1.44851 6.48192 1.81506L23.4069 11.1238C24.0977 11.5037 24.0977 12.4963 23.4069 12.8762L6.48192 22.1849C5.81546 22.5515 5 22.0693 5 21.3087V2.69127Z"
fill="currentColor"></path>
</svg>
<span>Watch</span>
<span style="font-size:11px;opacity:0.85;">(Free with Ads)</span>
</button>
</a>
<button class="provider-button" id="provider-play" style="display:none;" type="button">
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"
aria-hidden="true">
<path
d="M5 2.69127C5 1.93067 5.81547 1.44851 6.48192 1.81506L23.4069 11.1238C24.0977 11.5037 24.0977 12.4963 23.4069 12.8762L6.48192 22.1849C5.81546 22.5515 5 22.0693 5 21.3087V2.69127Z"
fill="currentColor"></path>
</svg>
<span></span>
</button>
<!-- My List Button -->
<button class="btn-mylist2  myList2 previewModal--wrapper" aria-label="My List">
<svg id="myListSvg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"
aria-hidden="true">
<path fill-rule="evenodd" clip-rule="evenodd"
d="M11 11V2H13V11H22V13H13V22H11V13H2V11H11Z"
fill="currentColor"></path>
</svg>
</button>

<!-- Thumbs Up Button -->
<button class="thumbs-up-button previewModal--wrapper" aria-label="Like">
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"
aria-hidden="true">
<path fill-rule="evenodd" clip-rule="evenodd"
d="M10.696 8.7732C10.8947 8.45534 11 8.08804 11 7.7132V4H11.8377C12.7152 4 13.4285 4.55292 13.6073 5.31126C13.8233 6.22758 14 7.22716 14 8C14 8.58478 13.8976 9.1919 13.7536 9.75039L13.4315 11H14.7219H17.5C18.3284 11 19 11.6716 19 12.5C19 12.5929 18.9917 12.6831 18.976 12.7699L18.8955 13.2149L19.1764 13.5692C19.3794 13.8252 19.5 14.1471 19.5 14.5C19.5 14.8529 19.3794 15.1748 19.1764 15.4308L18.8955 15.7851L18.976 16.2301C18.9917 16.317 19 16.4071 19 16.5C19 16.9901 18.766 17.4253 18.3994 17.7006L18 18.0006V18.5001C18 19.3285 17.3284 20 16.5 20H12.6228C11.6554 20 10.6944 19.844 9.77673 19.5382L8.28366 19.0405C7.22457 18.6874 6.11617 18.5051 5 18.5001V13.7543L7.03558 13.1727C7.74927 12.9688 8.36203 12.5076 8.75542 11.8781L10.696 8.7732ZM10.5 2C9.67157 2 9 2.67157 9 3.5V7.7132L7.05942 10.8181C6.92829 11.0279 6.72404 11.1817 6.48614 11.2497L4.45056 11.8313C3.59195 12.0766 3 12.8613 3 13.7543V18.5468C3 19.6255 3.87447 20.5 4.95319 20.5C5.87021 20.5 6.78124 20.6478 7.65121 20.9378L9.14427 21.4355C10.2659 21.8094 11.4405 22 12.6228 22H16.5C18.2692 22 19.7319 20.6873 19.967 18.9827C20.6039 18.3496 21 17.4709 21 16.5C21 16.4369 20.9983 16.3742 20.995 16.3118C21.3153 15.783 21.5 15.1622 21.5 14.5C21.5 13.8378 21.3153 13.217 20.995 12.6883C20.9983 12.6258 21 12.5631 21 12.5C21 10.567 19.433 9 17.5 9H15.9338C15.9752 8.6755 16 8.33974 16 8C16 6.98865 15.7788 5.80611 15.5539 4.85235C15.1401 3.09702 13.5428 2 11.8377 2H10.5Z"
fill="currentColor"></path>
</svg>
</button>
</div>
</div>

<button onclick="toggleMute()" aria-label="Turn audio on" class="previewModal-audioToggle previewModal--wrapper color-supplementary hasIcon round ">
<svg id="volume-icon" xmlns="http://www.w3.org/2000/svg" fill="none" role="img" viewBox="0 0 24 24" width="24" height="24" data-icon="VolumeHighStandard" aria-hidden="true">
<path fill-rule="evenodd" clip-rule="evenodd" d="M11 4.00003C11 3.59557 10.7564 3.23093 10.3827 3.07615C10.009 2.92137 9.57889 3.00692 9.29289 3.29292L4.58579 8.00003H1C0.447715 8.00003 0 8.44774 0 9.00003V15C0 15.5523 0.447715 16 1 16H4.58579L9.29289 20.7071C9.57889 20.9931 10.009 21.0787 10.3827 20.9239C10.7564 20.7691 11 20.4045 11 20V4.00003ZM5.70711 9.70714L9 6.41424V17.5858L5.70711 14.2929L5.41421 14H5H2V10H5H5.41421L5.70711 9.70714ZM15.2929 9.70714L17.5858 12L15.2929 14.2929L16.7071 15.7071L19 13.4142L21.2929 15.7071L22.7071 14.2929L20.4142 12L22.7071 9.70714L21.2929 8.29292L19 10.5858L16.7071 8.29292L15.2929 9.70714Z" fill="currentColor"></path>
</svg>
</button>

</div>

                <div class="video-wrapper">
                    <div id="iframePlaceholder"></div>
                </div>
                <div class="progress-border" id="progressBorder"></div>
    `;
    const container = document.getElementById('modal-backdrop-container');
    // Delete play-button if on desktop
    if (window.innerWidth > 1000) {
    // Desktop
    document.querySelectorAll('.play-button').forEach(btn => btn.remove());
    downloadBtn.style.display = 'none';
    document.querySelectorAll('.myList1').forEach(btn => btn.remove());
    document.querySelectorAll('.modal-logo-container').forEach(btn => btn.remove());
    document.querySelectorAll('.model-rating-box').forEach(btn => btn.style.display = "none");
    document.querySelectorAll('.model-title').forEach(btn => btn.style.display = "none");
    
    } else {
        // Mobile
        document.querySelectorAll('.play-button2').forEach(btn => btn.remove());
        document.querySelectorAll('.myList2').forEach(btn => btn.remove());
        document.querySelectorAll('.previewModal-logo-con').forEach(btn => btn.remove());
    }
    const logoContainer = document.getElementById('modal-logo-container');
    seasonEpisodeControls.style.display = 'none';
    episodesContainer.style.display = 'none';
    episodeListContainer.innerHTML = '';
    moreLikeThis.innerHTML = '';
    const playBtn = document.getElementById('modal-play');
    playBtn.style.display = 'none';

    const existingMovieBar = document.getElementById('movie-progress-bar-container');
    if (existingMovieBar) {
        existingMovieBar.remove();
    }
    const existingTvBar = document.getElementById('tv-progress-bar-container');
    if (existingTvBar) {
        existingTvBar.remove();
    }
    document.querySelectorAll('.content-progress-bar').forEach(bar => bar.remove());

    let apiUrl = '';

	if (mediaType === 'channel') {
        channelSection.style.display = 'block';
        modalSection.style.display = 'none';
        console.log("live channel tvg-id:", id);
        // ðŸ” Find channel by tvg-id
        const channel = liveChannelsCache.find(
            c => c.tvgId === id
        );
        if (!channel || !channel.url) {
            console.error("Channel not found for tvg-id:", id);
            channelSection.innerHTML = `
                <a class="modal-close" onclick="closeModal()"></a>
                <div style="color:white; padding:20px;">Channel not available</div>
            `;
            return;
        }
        const streamUrl = channel.url;
        // Clear old iframe
        channelSection.innerHTML = '';
        channelSection.innerHTML = `
            <a class="modal-close" onclick="closeModal()"></a>
            <iframe 
                src="https://watchout-player.netlify.app/?url=${encodeURIComponent(streamUrl)}"
                allow="autoplay; fullscreen"
                allowfullscreen
                style="width:100%; aspect-ratio:16/9; border:0;">
            </iframe>
        `;
    } 
    else {
        modalSection.style.display = 'block';
        channelSection.style.display = 'none';
    }
	
    if (mediaType === 'movie') {
		
		channelSection.style.display = 'none';
    apiUrl = `${MAIN_WORKER_BASE_URL}?url=${encodeURIComponent(`movie/${id}?append_to_response=credits,images,recommendations,runtime,keywords,videos,release_dates,collection,watch/providers`)}`;
} else if (mediaType === 'tv') {
    apiUrl = `${MAIN_WORKER_BASE_URL}?url=${encodeURIComponent(`tv/${id}?append_to_response=credits,images,recommendations,seasons,first_air_date,keywords,videos,content_ratings,collection,watch/providers`)}`;
}

    try {
        const res = await fetch(apiUrl);
        if (!res.ok) {
            throw new Error(`HTTP error! status: ${res.status}`);
        }
        const item = await res.json();
        injectJSONLD(item, mediaType);

        modal.dataset.seriesTitle = item.name;
        modal.dataset.seriesId = item.id;
        modal.dataset.firstAirDate = item.first_air_date || '';
        modal.dataset.posterPath = item.poster_path || ''; // Store poster path
        modal.dataset.backdropPath = item.backdrop_path || ''; // Store backdrop path

        document.getElementById('modal-backdrop-container').innerHTML = `<img id="modal-backdrop" class="modal-backdrop" src="${item.backdrop_path ? `${IMAGE_BASE}${BACKDROP_SIZE}${item.backdrop_path}` : ''}" alt="Backdrop">`;
        backdropImage = document.getElementById('modal-backdrop');
        modal.dataset.currentBackdrop = backdropImage.src;

        let logoPath = null;
        if (item.images && item.images.logos) {
            const englishLogo = item.images.logos.find(logo => logo.iso_639_1 === 'en');
            if (englishLogo) {
                logoPath = englishLogo.file_path;
            } else if (item.images.logos.length > 0) {
                logoPath = item.images.logos[0].file_path;
            }
        }

        logoContainer.innerHTML = logoPath ?
            `<img src="${IMAGE_BASE}w500${logoPath}" alt="${item.title || item.name}">` :
            '';

        titleElement.textContent = item.title || item.name;
        aboutHeading.textContent = `About ${item.title || item.name}`;
        updateMetaTags({
            title: item.title || item.name,
            overview: item.overview || 'Watch now on WatchOut!',
            posterPath: item.backdrop_path || item.poster_path,
            id,
            mediaType
        });

        const releaseYear = (item.release_date || item.first_air_date) ? new Date(item.release_date || item.first_air_date).getFullYear() : null;
        yearElement.textContent = releaseYear || 'N/A';
        ratingElement.textContent = item.adult ? '18+' : 'U/A 16+';

        runtimeContainer.innerHTML = '';
        if (mediaType === 'movie' && item.runtime && typeof item.runtime === 'number' && item.runtime > 0) {
            const hours = Math.floor(item.runtime / 60);
            const minutes = item.runtime % 60;
            runtimeContainer.textContent = `${hours}h ${minutes}m`;
        } else if (mediaType === 'tv' && item.number_of_seasons && item.number_of_seasons > 0) {
            runtimeContainer.textContent = `${item.number_of_seasons} Season${item.number_of_seasons > 1 ? 's' : ''}`;
        } else {
            runtimeContainer.textContent = 'N/A';
        }

        overviewElement.textContent = item.overview || 'No overview available.';

        // Cast
        const castEls = document.querySelectorAll('.modal-cast');
        if (castEls.length > 0) {
            const castList = item.credits?.cast?.length > 0
                ? item.credits.cast.slice(0, 5).map(actor => actor.name).join(', ')
                : 'No cast information available.';
            
            castEls.forEach(el => {
                el.textContent = castList;
            });
        }
        
        // Stream on + Logo + Correct Label
            const isDesktop = window.innerWidth > 900;
            const providerBtn = document.getElementById(isDesktop ? 'provider-play' : 'play-provider');
            if (!providerBtn) return;

            providerBtn.style.display = 'none';
            providerBtn.onclick = null;
            providerBtn.innerHTML = '<span>Stream on</span>';

            if (item.homepage && item.homepage.trim() !== '') {
                const providers = item['watch/providers']?.results?.IN || item['watch/providers']?.results;
                let logoPath = null;
                let label = '';

                if (providers) {
                    // 1. Subscription (flatrate) â€” Netflix, Disney+, Hulu, etc.
                    if (providers.flatrate?.[0]) {
                        logoPath = providers.flatrate[0].logo_path;
                        label = 'Subscription';
                    }
                    // 2. Free with ads â€” Tubi, Pluto TV, etc.
                    else if (providers.ads?.[0]) {
                        logoPath = providers.ads[0].logo_path;
                        label = 'Free with ads';
                    }
                    // 3. Buy
                    else if (providers.buy?.[0]) {
                        logoPath = providers.buy[0].logo_path;
                        label = 'Buy';
                    }
                    // 4. Rent
                    else if (providers.rent?.[0]) {
                        logoPath = providers.rent[0].logo_path;
                        label = 'Rent';
                    }
                }

                if (logoPath) {
                    providerBtn.innerHTML = `
                        <span>Stream on</span>
                        <img src="https://image.tmdb.org/t/p/original${logoPath}" 
                             alt="Provider" 
                             style="width:24px;height:24px;border-radius:4px;">
                        <span style="font-size:11px;opacity:0.85;">(${label})</span>`;
                    providerBtn.style.display = 'flex';
                    providerBtn.onclick = () => window.open(item.homepage, '_blank', 'noopener,noreferrer');
                } else {
                    providerBtn.style.display = 'none';
                }

                
                
            }

        // Genres
        const genresEls = document.querySelectorAll('.modal-genres');
        if (genresEls.length > 0) {
            genresEls.forEach(el => {
                el.textContent = item.genres?.length > 0
                    ? item.genres.map(g => g.name).join(', ')
                    : 'N/A';
            });
        }

        // Maturity Rating / Certification
        const certificationEls = document.querySelectorAll('.modal-certification');
        if (certificationEls.length > 0) {
                let certification = 'N/A';
                const countryCode = 'IN'; // Change this if you want another country

                if (mediaType === 'movie') {
                        const countryData = item.release_dates?.results?.find(r => r.iso_3166_1 === countryCode);
                        certification = countryData?.release_dates?.[0]?.certification || 'N/A';
                } else {
                        const countryData = item.content_ratings?.results?.find(r => r.iso_3166_1 === countryCode);
                        certification = countryData?.rating || 'N/A';
                }

                certificationEls.forEach(el => {
                        el.textContent = certification;
                });
        }

        
      
        // ---------------------------------------------------------------
        //  Creators / Directors section (works for movie & tv)
        // ---------------------------------------------------------------
        const creatorsEls = document.querySelectorAll('.modal-creators');
        if (creatorsEls.length > 0) {
            let creatorsText = 'No creators information available.';
        
            // ---------- TV SHOWS ----------
            if (mediaType === 'tv' && item.created_by?.length) {
                // Primary source: the official `created_by` array
                creatorsText = item.created_by.map(c => c.name).join(', ');
            }
            // ---------- MOVIES ----------
            else if (mediaType === 'movie' && item.credits?.crew?.length) {
                // Directors are in the credits â†’ crew â†’ job === "Director"
                const directors = item.credits.crew
                    .filter(p => p.job === 'Director')
                    .map(p => p.name);

                if (directors.length) creatorsText = directors.join(', ');
            }
            // ---------- OPTIONAL TV fallback ----------
            else if (mediaType === 'tv' && item.credits?.crew?.length) {
                // Some shows have no `created_by`. Grab the main show-runner(s)
                const showRunners = item.credits.crew
                    .filter(p => ['Executive Producer', 'Creator'].includes(p.job))
                    .map(p => p.name);
        
                if (showRunners.length) creatorsText = showRunners.join(', ');
            }
        
            // ---- Write the result to every .modal-creators element ----
            creatorsEls.forEach(el => el.textContent = creatorsText);
        } 

        // Populate Trailers & More
        const modalVideos = document.getElementById('modal-videos');
        modalVideos.innerHTML = ''; // Clear existing content

        if (item.videos && item.videos.results && item.videos.results.length > 0) {
            const trailers = item.videos.results.filter(video =>
                video.type === 'Trailer' && video.site === 'YouTube'
            );

            if (trailers.length > 0) {
              try{
                createPlayer(trailers[0].key);
              }
              catch (error) {
                   console.log("cannot create player");
              }
              trailers.forEach(video => {
                    const videoElement = document.createElement('div');
                    videoElement.className = 'video-item';

                    const thumbnailUrl = `https://img.youtube.com/vi/${video.key}/hqdefault.jpg`;

                    videoElement.innerHTML = `
                        <img src="${thumbnailUrl}" alt="${video.name}" />
                        <p class="video-title">${video.name}</p>
                    `;

                    videoElement.addEventListener('click', () => {
                            const videoUrl = `https://www.youtube.com/embed/${video.key}?autoplay=1`;
                            // Replace the thumbnail and text with the iframe
                            videoElement.innerHTML = `
                            <iframe src="${videoUrl}" frameborder="0" allowfullscreen class="video-iframe"></iframe>
                        `;
                    });

                    modalVideos.appendChild(videoElement);
                });
            } 
        } 

        

        // Keywords
        const keywordsEls = document.querySelectorAll('.modal-keywords');
        if (keywordsEls.length > 0) {
            let keywordsList = '';
    
            if (mediaType === 'movie') {
                keywordsList = item.keywords?.keywords?.length > 0
                    ? item.keywords.keywords.slice(0, 3).map(k => k.name).join(', ')
                    : 'N/A';
            } else {
                keywordsList = item.keywords?.results?.length > 0
                    ? item.keywords.results.slice(0, 3).map(k => k.name).join(', ')
                    : 'N/A';
            }

            keywordsEls.forEach(el => {
                el.textContent = keywordsList;  
            });
        }
      
        const youtubePlayer = document.getElementById('youtubePlayer');
        const modalContent = document.getElementById('tmdb-modal');
Â  Â  Â  Â  if (youtubePlayer) {
Â  Â  Â  Â  Â  Â  modalContent.addEventListener('scroll', checkModalPlayerVisibility);
Â  Â  Â  Â  Â  Â  console.log('scroll detected fn called');
Â  Â  Â  Â  }

        
// Render collection parts (similar to recommendations)
if (item.belongs_to_collection && item.belongs_to_collection.id) {
    // First fetch the collection details to get all parts
    const collectionUrl = `${MAIN_WORKER_BASE_URL}?url=${encodeURIComponent(`collection/${item.belongs_to_collection.id}`)}`;
    const collectiondiv = document.getElementById('collection');
    
    fetch(collectionUrl)
        .then(response => response.json())
        .then(collectionData => {
            if (collectionData.parts && collectionData.parts.length > 0) {
                collectionWrapper.style.display = 'block';
                collectiondiv.innerHTML = '';
                
                collectionData.parts.slice(0, 9).forEach(part => {
                    const isDesktop = window.innerWidth >= 1000;
                    const imgPath = isDesktop ? part.backdrop_path : part.poster_path;
                    const imgSize = isDesktop ? 'w780' : POSTER_SIZE;

                    if (imgPath) {
                        const container = document.createElement('div');
                        container.classList.add('similar-item');
                        container.onclick = () => openModal(part.id, part.media_type || 'movie'); // Collection parts are typically movies

                        // ðŸ”² Title Card Image Wrapper
                        const imageWrapper = document.createElement('div');
                        imageWrapper.className = 'titleCard-imageWrapper';

                        const img = document.createElement('img');
                        img.src = `${IMAGE_BASE}${imgSize}${imgPath}`;
                        img.alt = part.title || part.name;

                        imageWrapper.appendChild(img);

                        if (isDesktop) {
                            // â–¶ï¸ Play Icon Inside Wrapper
                            const playIcon = document.createElement('div');
                            playIcon.className = 'titleCard-playIcon';
                            playIcon.innerHTML = `
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" role="img" viewBox="0 0 24 24" width="24" height="24" data-icon="PlayStandard" aria-hidden="true" class="titleCard-playSVG">
                                  <path d="M5 2.69127C5 1.93067 5.81547 1.44851 6.48192 1.81506L23.4069 11.1238C24.0977 11.5037 24.0977 12.4963 23.4069 12.8762L6.48192 22.1849C5.81546 22.5515 5 22.0693 5 21.3087V2.69127Z" fill="currentColor"></path>
                                </svg>
                            `;
                            imageWrapper.appendChild(playIcon);
                        }

                        container.appendChild(imageWrapper);

                        if (isDesktop) {
                            // ðŸ“… Metadata
                            const metaOuter = document.createElement('div');
                            metaOuter.className = 'videoMetadata--container-container';

                            const metaContainer = document.createElement('div');
                            metaContainer.className = 'videoMetadata--container';

                            const infoContainer = document.createElement('div');
                            infoContainer.className = 'videoMetadata--line';

                            // Maturity
                            const maturity = document.createElement('span');
                            maturity.className = 'maturity-rating';
                            const maturityNumber = document.createElement('span');
                            maturityNumber.className = 'maturity-number';
                            maturityNumber.textContent = part.adult ? 'A' : 'U/A';
                            maturity.appendChild(maturityNumber);
                            infoContainer.appendChild(maturity);

                            // HD Badge
                            const hd = document.createElement('span');
                            hd.className = 'player-feature-badge';
                            hd.textContent = 'HD';
                            infoContainer.appendChild(hd);

                            // Year
                            if (part.release_date || part.first_air_date) {
                                const year = document.createElement('div');
                                year.className = 'year';
                                year.textContent = (part.release_date || part.first_air_date).slice(0, 4);
                                infoContainer.appendChild(year);
                            }

                            metaContainer.appendChild(infoContainer);
                            metaOuter.appendChild(metaContainer);
                            container.appendChild(metaOuter);

                            // Overview
                            if (part.overview) {
                                const overview = document.createElement('p');
                                overview.textContent = part.overview;
                                overview.className = 'similar-overview';
                                container.appendChild(overview);
                            }
                        }

                        collectiondiv.appendChild(container);
                        const collectionTab = document.getElementById('collection-tab');
                        collectionTab.style.display = 'block';
                        switchTab('collection-container', collectionTab)
                    }
                });
            } else {
                // Hide collection container if no parts
                collectionWrapper.style.display = 'none';
                collectionTab.style.display = 'none';
                const moreLikeThisTab = document.getElementById('more-like-this-tab');
                switchTab('more-like-this-container', moreLikeThisTab)
            }
        })
        .catch(error => {
            console.error('Error fetching collection data:', error);
            collectionTab.style.display = 'none';
            const moreLikeThisTab = document.getElementById('more-like-this-tab');
            switchTab('more-like-this-container', moreLikeThisTab)
            collectionWrapper.style.display = 'none';
        });
} else {
    // Hide collection container if not part of a collection
    collectionTab.style.display = 'none';
    const moreLikeThisTab = document.getElementById('more-like-this-tab');
    switchTab('more-like-this-container', moreLikeThisTab)
    collectionWrapper.style.display = 'none';
}

if (item.recommendations && item.recommendations.results && item.recommendations.results.length > 0) {
    moreLikeThis.innerHTML = '';
    item.recommendations.results.slice(0, 9).forEach(recommendation => {
        const isDesktop = window.innerWidth >= 1000;
        const imgPath = isDesktop ? recommendation.backdrop_path : recommendation.poster_path;
        const imgSize = isDesktop ? 'w780' : POSTER_SIZE;

        if (imgPath) {
            const container = document.createElement('div');
            container.classList.add('similar-item');
            container.onclick = () => openModal(recommendation.id, recommendation.media_type || mediaType);

            // ðŸ”² Title Card Image Wrapper
            const imageWrapper = document.createElement('div');
            imageWrapper.className = 'titleCard-imageWrapper';

            const img = document.createElement('img');
            img.src = `${IMAGE_BASE}${imgSize}${imgPath}`;
            img.alt = recommendation.title || recommendation.name;

            imageWrapper.appendChild(img);

            if (isDesktop) {
                // â–¶ï¸ Play Icon Inside Wrapper
                const playIcon = document.createElement('div');
                playIcon.className = 'titleCard-playIcon';
                playIcon.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" role="img" viewBox="0 0 24 24" width="24" height="24" data-icon="PlayStandard" aria-hidden="true" class="titleCard-playSVG">
                      <path d="M5 2.69127C5 1.93067 5.81547 1.44851 6.48192 1.81506L23.4069 11.1238C24.0977 11.5037 24.0977 12.4963 23.4069 12.8762L6.48192 22.1849C5.81546 22.5515 5 22.0693 5 21.3087V2.69127Z" fill="currentColor"></path>
                    </svg>
                `;
                imageWrapper.appendChild(playIcon);
            }

            container.appendChild(imageWrapper);

            if (isDesktop) {
                // ðŸ“… Metadata
                const metaOuter = document.createElement('div');
                metaOuter.className = 'videoMetadata--container-container';

                const metaContainer = document.createElement('div');
                metaContainer.className = 'videoMetadata--container';

                const infoContainer = document.createElement('div');
                infoContainer.className = 'videoMetadata--line';

                // Maturity
                const maturity = document.createElement('span');
                maturity.className = 'maturity-rating';
                const maturityNumber = document.createElement('span');
                maturityNumber.className = 'maturity-number';
                maturityNumber.textContent = recommendation.adult ? 'A' : 'U/A';
                maturity.appendChild(maturityNumber);
                infoContainer.appendChild(maturity);

                // HD Badge
                const hd = document.createElement('span');
                hd.className = 'player-feature-badge';
                hd.textContent = 'HD';
                infoContainer.appendChild(hd);

                // Year
                if (recommendation.release_date || recommendation.first_air_date) {
                    const year = document.createElement('div');
                    year.className = 'year';
                    year.textContent = (recommendation.release_date || recommendation.first_air_date).slice(0, 4);
                    infoContainer.appendChild(year);
                }

                metaContainer.appendChild(infoContainer);
                metaOuter.appendChild(metaContainer);
                container.appendChild(metaOuter);

                // Overview
                if (recommendation.overview) {
                    const overview = document.createElement('p');
                    overview.textContent = recommendation.overview;
                    overview.className = 'similar-overview';
                    container.appendChild(overview);
                }
            }

            moreLikeThis.appendChild(container);
        }
    });
} else {
    moreLikeThisContainer.style.display = 'none';
}



        // Fixed My List button event listener
        const myListBtn = document.querySelector('.btn-mylist2');
        let myList = JSON.parse(localStorage.getItem('myList') || '[]');
        const itemExists = myList.some(listItem => listItem.id === id && listItem.mediaType === mediaType);
        const myListSvg = document.getElementById('myListSvg');
        if (itemExists) {
            myListSvg.innerHTML = `<path fill-rule="evenodd" clip-rule="evenodd" d="M21.2928 4.29285L22.7071 5.70706L8.70706 19.7071C8.51952 19.8946 8.26517 20 7.99995 20C7.73474 20 7.48038 19.8946 7.29285 19.7071L0.292847 12.7071L1.70706 11.2928L7.99995 17.5857L21.2928 4.29285Z" fill="currentColor"></path>`;          
        }
        else {
              myListSvg.innerHTML = `<path fill-rule="evenodd" clip-rule="evenodd" d="M11 11V2H13V11H22V13H13V22H11V13H2V11H11Z" fill="currentColor"></path>`;          

        }
        if (myListBtn) {
            myListBtn.onclick = () => {
                // Fix: Compare with the current item's ID (using 'id' parameter, not 'item.id')
                let myList = JSON.parse(localStorage.getItem('myList') || '[]');
                const itemExists = myList.some(listItem => listItem.id === id && listItem.mediaType === mediaType);
        
                if (itemExists) {
                    // Remove item from myList
                    myList = myList.filter(listItem => !(listItem.id === id && listItem.mediaType === mediaType));
                    localStorage.setItem('myList', JSON.stringify(myList));
                    myListSvg.innerHTML = `<path fill-rule="evenodd" clip-rule="evenodd" d="M11 11V2H13V11H22V13H13V22H11V13H2V11H11Z" fill="currentColor"></path>`;
                } else {
                    // Add item to myList
                    saveToMyList(id, mediaType, item.poster_path || item.backdrop_path);
                    myListSvg.innerHTML = `<path fill-rule="evenodd" clip-rule="evenodd" d="M21.2928 4.29285L22.7071 5.70706L8.70706 19.7071C8.51952 19.8946 8.26517 20 7.99995 20C7.73474 20 7.48038 19.8946 7.29285 19.7071L0.292847 12.7071L1.70706 11.2928L7.99995 17.5857L21.2928 4.29285Z" fill="currentColor"></path>`;          
                }
            };
        }

        if (mediaType === 'movie') {
            playBtn.style.display = 'flex';
            const movieProgress = getVideoProgress(`movie_${id}`);
            playBtn.innerHTML = `
                ${playIconSvg}
                ${movieProgress ? 'Resume' : 'Watch'}
                <span style="font-size:11px; opacity:0.85; font-weight:600;">
                    (Free with Ads)
                </span>
            `;
            //downloadBtn.style.display = 'block';
            episodeTab.style.display = 'none';
            keywordsTag.textContent = "This Movie is:";
            

            if (movieProgress) {
                const progressBarContainer = document.createElement('div');
                progressBarContainer.id = 'movie-progress-bar-container';
                progressBarContainer.style.marginTop = '10px';
                downloadBtn.after(progressBarContainer);
                displayProgressBar(progressBarContainer, movieProgress);
            }

            playBtn.onclick = async (e) => {
                modal.scrollTop = 0;
                if (!isDesktop) {
                    // Mobile â†’ put spinner in playerWrap
                    playerWrap.innerHTML = spinnerHTML;
                    playBtn.style.display ="none";
                } else {
                    // Desktop â†’ put spinner in iframe-holder
                    const iframeHolder = document.getElementById("iframe-holder");
                    iframeHolder.style.display ="Block";
                    if (iframeHolder) {
                        iframeHolder.innerHTML = spinnerHTML;
                    } else {
                        console.error("iframe-holder element not found in the DOM");
                    }
                }

                e.preventDefault();
                modal.dataset.currentBackdrop = document.getElementById('modal-backdrop')?.src || '';
                modal.dataset.currentMovieId = item.id;

                const { playLink, isHlsWorkerLink } = await getMovieStreamingAndDownloadLink(item, releaseYear);

                const playerUrl = playLink;
                let iframeAttributes = `id="movie-player-iframe" src="${playerUrl}" width="100%" height="100%" frameborder="0" allowfullscreen style="aspect-ratio: 16/9;"`;

                if (isHlsWorkerLink) {
                    iframeAttributes = `id="movie-player-iframe" src="${playerUrl}" width="100%" height="100%" frameborder="0" allowfullscreen style="aspect-ratio: 16/9;"`;
                }

                const iframeHolder = document.getElementById('iframe-holder');
                if (!isDesktop) {
                   // Mobile â†’ put iframe inside playerWrap
                   playerWrap.innerHTML = `
                       <iframe ${iframeAttributes}></iframe>
                       <a class="player-close" onclick="closeModal()"><svg xmlns="http://www.w3.org/2000/svg" fill="none" role="img" viewBox="0 0 24 24" width="24" height="24" data-icon="XStandard" aria-hidden="true">
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.5858 12L2.29291 3.70706L3.70712 2.29285L12 10.5857L20.2929 2.29285L21.7071 3.70706L13.4142 12L21.7071 20.2928L20.2929 21.7071L12 13.4142L3.70712 21.7071L2.29291 20.2928L10.5858 12Z" fill="currentColor"></path>

</svg></a>
                   `;
                   window.open("https://otieu.com/4/9119528", "_blank");
               } else {
                   // Desktop â†’ put iframe inside iframe-holder
                   const iframeHolder = document.getElementById("iframe-holder");
                   if (iframeHolder) {
                       iframeHolder.innerHTML = `
                           <iframe ${iframeAttributes}></iframe>
                           <a class="player-close" onclick="playerClose()"><svg xmlns="http://www.w3.org/2000/svg" fill="none" role="img" viewBox="0 0 24 24" width="24" height="24" data-icon="XStandard" aria-hidden="true">
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.5858 12L2.29291 3.70706L3.70712 2.29285L12 10.5857L20.2929 2.29285L21.7071 3.70706L13.4142 12L21.7071 20.2928L20.2929 21.7071L12 13.4142L3.70712 21.7071L2.29291 20.2928L10.5858 12Z" fill="currentColor"></path>

</svg></a>
                       `;
                   } else {
                       console.error("iframe-holder element not found in the DOM");
                       playerWrap.innerHTML = `
                           <div style="display: flex; justify-content: center; align-items: center; height: 100%; color: white; font-size: 1.2em;">
                               Error: Player container not found.
                           </div>
                           <a class="modal-close" onclick="closeModal()"></a>
                       `;
                   }
                   window.open("https://otieu.com/4/9119528", "_blank");
                }


                saveToContinueWatching(item.id, mediaType, item.poster_path, item.backdrop_path);
                setupPlayerListener(`movie_${id}`);
            };

            const originalDownloadBtnText = 'Download';
            downloadBtn.onclick = async () => {
                downloadBtn.textContent = 'Downloading...';
                downloadBtn.disabled = true;
                try {
                    const { playLink } = await getMovieStreamingAndDownloadLink(item, releaseYear);

                    if (playLink) {
                        window.open(`${playLink}&dl=1`, '_blank');
                        setTimeout(() => {
                            downloadBtn.textContent = originalDownloadBtnText;
                            downloadBtn.disabled = false;
                        }, 2000);
                    } else {
                        console.error("Could not determine download link.");
                        alert("Unable to find a download link for this content at the moment.");
                        downloadBtn.textContent = originalDownloadBtnText;
                        downloadBtn.disabled = false;
                    }
                } catch (error) {
                    console.error("Error during download link fetch:", error);
                    alert("An error occurred while trying to get the download link. Please try again.");
                    downloadBtn.textContent = originalDownloadBtnText;
                    downloadBtn.disabled = false;
                }
            };

        } 

		else if (mediaType === 'tv') {
			channelSection.style.display = 'none';	
            const validSeasons = item.seasons ? item.seasons.filter(s => s.season_number >= 1) : [];

            if (validSeasons.length > 0) {
                playBtn.style.display = 'flex';
                downloadBtn.style.display = 'none';

                const latestWatched = getLatestWatchedEpisode(id);
                if (latestWatched) {
                    playBtn.innerHTML = `
                    ${playIconSvg}Resume S${latestWatched.season}E${latestWatched.episode}
                    <span style="font-size:11px; opacity:0.85; font-weight:600;">
                      (Free with Ads)
                    </span>`;
                    playBtn.onclick = (e) => {
                        e.preventDefault();
                        if (!isDesktop) {
                            playBtn.style.display ="none";
                        } 
                        playEpisode(item.name, latestWatched.season, latestWatched.episode, id, 
                                   `tv_${id}_${latestWatched.season}_${latestWatched.episode}`, releaseYear);
                    };
                    const tvProgress = getVideoProgress(`tv_${id}_${latestWatched.season}_${latestWatched.episode}`);
                    if (tvProgress) {
                        const progressBarContainer = document.createElement('div');
                        progressBarContainer.id = 'tv-progress-bar-container';
                        progressBarContainer.style.marginTop = '10px';
                        playBtn.after(progressBarContainer);
                        displayProgressBar(progressBarContainer, tvProgress);
                    }
                } else {
                    playBtn.innerHTML = `${playIconSvg}Watch S1E1 <span style="font-size:11px; opacity:0.85; font-weight:600;">
                      (Free with Ads)
                    </span>`;
                    playBtn.onclick = (e) => {
                        e.preventDefault();
                        if (!isDesktop) {
                            playBtn.style.display ="none";
                        }
                        playEpisode(item.name, 1, 1, id, `tv_${id}_1_1`, releaseYear);
                    };
                }
                episodeTab.style.display = 'block';
                switchTab('episodes', episodeTab);
                seasonEpisodeControls.style.display = 'flex';
                episodesContainer.style.display = 'block';

                const seasonSelector = document.getElementById('season-selector');
                seasonSelector.innerHTML = '';

                validSeasons.forEach(season => {
                    const option = document.createElement('option');
                    option.value = season.season_number;
                    option.textContent = `Season ${season.season_number} (${season.episode_count} EP)`;
                    seasonSelector.appendChild(option);
                });

                seasonSelector.onchange = async () => {
                    const selectedSeason = seasonSelector.value;
                    await fetchEpisodes(id, selectedSeason, item.name, releaseYear);
                };

                if (seasonSelector.options.length > 0) {
                    const latestValidSeasonNumber = validSeasons[validSeasons.length - 1].season_number;
                    seasonSelector.value = latestValidSeasonNumber;
                    await fetchEpisodes(id, latestValidSeasonNumber, item.name, releaseYear);
               }

            } else {
                seasonEpisodeControls.style.display = 'none';
                episodesContainer.style.display = 'block';
                episodeListContainer.innerHTML = '<p style="padding: 10px;">No valid seasons found.</p>';
            }
        }

    } catch (error) {
        titleElement.textContent = 'Error loading details.';
        overviewElement.textContent = 'Could not load details for this item. Please try again later.';
        yearElement.textContent = '';
        ratingElement.textContent = '';
        runtimeContainer.textContent = '';
        logoContainer.innerHTML = '';
        moreLikeThisContainer.style.display = 'none';
        seasonEpisodeControls.style.display = 'none';
        episodesContainer.style.display = 'none';

        const backdropImage = document.getElementById('modal-backdrop');
        // Add a check to ensure backdropImage is not null before trying to set its properties
        if (backdropImage) {
            if (modal.dataset.currentBackdrop) {
                backdropImage.src = modal.dataset.currentBackdrop;
            } else {
                backdropImage.src = '';
            }
        } else {
            console.warn("Element with ID 'modal-backdrop' not found.");
            // Handle the case where the element is missing, e.g., log a warning or use a default
        }
        container.innerHTML += `<a class="modal-close" onclick="closeModal()"></a>`;
    }
}

// Updated fetchEpisodes â€” real episode-indexing uses the provided styles only
async function fetchEpisodes(seriesId, seasonNumber, seriesName, releaseYear) {
    const episodeListContainer = document.getElementById('episode-list');

    // Clear and show 6 skeleton items (each includes a number placeholder)
    episodeListContainer.innerHTML = '';
    for (let i = 0; i < 6; i++) {
        const skeletonItem = document.createElement('li');
        skeletonItem.style.display = 'flex';
        skeletonItem.style.backgroundColor = '#222';
        skeletonItem.style.borderRadius = '.5em';
        skeletonItem.style.alignItems = 'center';
        skeletonItem.style.height = '8em';
        skeletonItem.style.marginBottom = '0.25em';

        skeletonItem.innerHTML = `
        `;
        episodeListContainer.appendChild(skeletonItem);
    }

    const tmdbSeasonPath = `tv/${seriesId}/season/${seasonNumber}`;
    const apiUrl = `${MAIN_WORKER_BASE_URL}?url=${encodeURIComponent(tmdbSeasonPath)}`;

    try {
        const res = await fetch(apiUrl);
        if (!res.ok) throw new Error(`HTTP error! status: ${res.status}`);
        const data = await res.json();
        episodeListContainer.innerHTML = '';

        if (data.episodes && data.episodes.length > 0) {
            data.episodes.forEach((episode, index) => {
                const listItem = document.createElement('li');
                listItem.style.display = 'flex';
                listItem.style.position = 'relative';
                listItem.style.cursor = 'pointer';

                const thumbnailUrl = episode.still_path 
    ? `${IMAGE_BASE}original${episode.still_path}` 
    : (document.getElementById('modal-backdrop')?.src || null);
                const episodeTitle = episode.name || 'Untitled Episode';
                const displayTitle = `${index + 1}. ${episodeTitle}`;

                // Try common runtime fields; TMDB episode objects sometimes use `runtime` or `episode_run_time`
                const runtimeMinutes = episode.runtime ?? (episode.episode_run_time && episode.episode_run_time[0]) ?? null;
                const runtimeText = runtimeMinutes ? `${runtimeMinutes}min` : ''; // Direct formatting

                // Check if episode is unreleased and format availability date
                const isUnreleased = episode.air_date && new Date(episode.air_date) > new Date();
                const availabilityText = isUnreleased && episode.air_date ? 
                    `Available ${new Date(episode.air_date).getDate()} ${new Date(episode.air_date).toLocaleDateString('en-US', { month: 'long' })}` : 
                    '';

                // number/index (left), thumbnail (middle), details (right)
                const episodeContent = `
                <div class="episode-container" style="display: flex; align-items: center; flex-grow: 1;">
                    <!-- real index: uses styles you provided (only for real items) -->
                    <div class="episode-indexing" style="color: #d2d2d2; display: flex; flex: 0 0 7%; font-size: 1.5em; justify-content: center; align-items: center; margin-right: 12px;">
                      ${index + 1}
                    </div>
                    
                    
                    <div style="display: flex; height: 67px; border-radius: 5px; background: #181818; flex-direction: column; align-items: flex-start; margin-right: 20px;">
                        ${thumbnailUrl ? `<img src="${thumbnailUrl}" alt="${episodeTitle} Thumbnail" style="width: 120px; height: 67px; border-radius: 5px; object-fit: cover;">` : `<div style="width:120px; height:67px;"></div>`}
                        <div class="episode-progress-bar-placeholder" style="width: 120px;"></div>
                    </div>

                    <div class="episode-meta" style="flex-grow: 1;">
                        <div class="episode-meta-row" style="display:flex; gap:4px;">
                            <span class="episode-title">${displayTitle}</span>
                            <span class="episode-runtime" title="Runtime">${runtimeText}</span>
                        </div>
                        <span class="episode-overview" style="color: #d2d2d2; font-size: 14px; margin-top: 4px; padding-bottom:14px; padding-right:14px; line-height: 20px;">${episode.overview || ''}</span>
                        ${availabilityText ? `<div class="titleCard-availability"><span style="color: #fff; font-size: 16px; font-weight: 400;">${availabilityText}</span></div>` : ''}
                    </div>
                </div>
                <span class="episode-overview2" style="display:none; color: #d2d2d2; font-size: 14px; margin-top: 5px; line-height: 20px;">${episode.overview || ''}</span>
                `;

                listItem.innerHTML = episodeContent;
                listItem.dataset.seriesName = seriesName;
                listItem.dataset.seasonNumber = episode.season_number;
                listItem.dataset.episodeNumber = episode.episode_number;
                listItem.dataset.seriesId = seriesId;
                listItem.dataset.releaseYear = releaseYear;

                const uniqueEpisodeId = `tv_${seriesId}_${episode.season_number}_${episode.episode_number}`;
                listItem.dataset.uniqueEpisodeId = uniqueEpisodeId;

                // accessibility label
                listItem.setAttribute('aria-label', `Episode ${index + 1}: ${episodeTitle} â€” ${runtimeText}`);

                // restore progress bar if available
                const episodeProgress = getVideoProgress(uniqueEpisodeId);
                if (episodeProgress) {
                    const progressBarTarget = listItem.querySelector('.episode-progress-bar-placeholder');
                    if (progressBarTarget) {
                        displayProgressBar(progressBarTarget, episodeProgress);
                    }
                }

                // click handler
                listItem.onclick = () => playEpisode(
                    listItem.dataset.seriesName,
                    parseInt(listItem.dataset.seasonNumber),
                    parseInt(listItem.dataset.episodeNumber),
                    parseInt(listItem.dataset.seriesId),
                    listItem.dataset.uniqueEpisodeId,
                    listItem.dataset.releaseYear
                );

                episodeListContainer.appendChild(listItem);
            });
        } else {
            episodeListContainer.innerHTML = '<p style="padding: 10px;">No episodes found for this season.</p>';
        }

    } catch (error) {
        console.error('Error fetching episodes:', error);
        episodeListContainer.innerHTML = '<p style="padding: 10px;">Error loading episodes.</p>';
    }
}




function toggleFullscreen(element) {
    if (!document.fullscreenElement && !document.webkitFullscreenElement && 
        !document.mozFullScreenElement && !document.msFullscreenElement) {
        if (element.requestFullscreen) {
            element.requestFullscreen().catch(err => {
                console.warn(`Error attempting to enable full-screen mode: ${err.message}`);
            });
        } else if (element.webkitRequestFullscreen) {
            element.webkitRequestFullscreen();
        } else if (element.mozRequestFullScreen) {
            element.mozRequestFullScreen();
        } else if (element.msRequestFullscreen) {
            element.msRequestFullscreen();
        } else {
            console.warn('Fullscreen API is not supported by this browser.');
        }
    }
}

async function playEpisode(seriesName, seasonNumber, episodeNumber, seriesId, uniqueEpisodeId, releaseYear) {
    const container = document.getElementById('modal-backdrop-container');
    const isDesktop = window.innerWidth > 750;
    const playerWrap = document.getElementById('playerWrap');
    const modal = document.getElementById('tmdb-modal');
    const playBtn = document.getElementById('modal-play');
    const iframeHolder = document.getElementById('iframe-holder');
    const playingId = `tv_${seriesId}_${seasonNumber}_${episodeNumber}`;
    modal.scrollTop = 0;
    
    if (!isDesktop) {
      // Mobile
      if (playBtn) {
         playBtn.style.display = "none";
         }
      playerWrap.innerHTML = `
        <div class="loading-spinner-container">
          <img
            src="https://assets.nflxext.com/en_us/pages/wiplayer/site-spinner.png"
            alt="Loading..."
            onerror="this.onerror=null; this.src='https://placehold.co/64x64/cccccc/333333?text=Loading';">
        </div>
        <a class="player-close" onclick="closeModal()"><svg xmlns="http://www.w3.org/2000/svg" fill="none" role="img" viewBox="0 0 24 24" width="24" height="24" data-icon="XStandard" aria-hidden="true">
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.5858 12L2.29291 3.70706L3.70712 2.29285L12 10.5857L20.2929 2.29285L21.7071 3.70706L13.4142 12L21.7071 20.2928L20.2929 21.7071L12 13.4142L3.70712 21.7071L2.29291 20.2928L10.5858 12Z" fill="currentColor"></path>

</svg></a>
      `;
    } else {
      // Desktop
      iframeHolder.style.display = "block";
      iframeHolder.innerHTML = `
        <div class="loading-spinner-container">
          <img
            src="https://assets.nflxext.com/en_us/pages/wiplayer/site-spinner.png"
            alt="Loading..."
            onerror="this.onerror=null; this.src='https://placehold.co/64x64/cccccc/333333?text=Loading';">
        </div>
        <a class="player-close" onclick="playerClose()"><svg xmlns="http://www.w3.org/2000/svg" fill="none" role="img" viewBox="0 0 24 24" width="24" height="24" data-icon="XStandard" aria-hidden="true">
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.5858 12L2.29291 3.70706L3.70712 2.29285L12 10.5857L20.2929 2.29285L21.7071 3.70706L13.4142 12L21.7071 20.2928L20.2929 21.7071L12 13.4142L3.70712 21.7071L2.29291 20.2928L10.5858 12Z" fill="currentColor"></path>

</svg></a>
      `;
    }

    let episodeUrl = null;
let isHlsWorkerLink = false;

const formattedSeason = seasonNumber < 10 ? `s0${seasonNumber}` : `s${seasonNumber}`;
const formattedEpisode = episodeNumber < 10 ? `e0${episodeNumber}` : `e${episodeNumber}`;

if (seriesName && seasonNumber !== undefined && episodeNumber !== undefined) {
    const formattedSeriesTitle = formatTitleForHls(seriesName);
    const dottedTitle = `${formattedSeriesTitle}.${formattedSeason}${formattedEpisode}`;

    // ---------------------------------------
// ðŸ†• 1ï¸âƒ£ Try GitHub Direct HLS Link First
// ---------------------------------------
const githubJsonUrl = `https://raw.githubusercontent.com/Watchout2025/api/refs/heads/main/hls/tv/${seriesId}/S${seasonNumber}.json`;

try {
    const res = await fetch(githubJsonUrl);
    if (res.ok) {
        const data = await res.json();
        const fileId = data[episodeNumber];
        if (fileId) {
            let directHlsLink;

            // âœ… If fileId starts with http, use it directly
            if (fileId.startsWith("http")) {
                directHlsLink = fileId;
            } else {
                directHlsLink = `https://vidmmo.com/hls/${fileId}/master.m3u8`;
            }

            episodeUrl = `https://watchout-player.netlify.app/?url=${encodeURIComponent(directHlsLink)}`;
            isHlsWorkerLink = true;
            console.log(`âœ… Found episode ${episodeNumber}: ${episodeUrl}`);
        }
    }
} catch (error) {
    console.error("Error fetching HLS JSON:", error);
}



    // -----------------------------------
    // 2ï¸âƒ£ Fallback to RPM Worker if needed
    // -----------------------------------
    if (!episodeUrl) {
        const rpmWorkerApiUrl = `${RPM_WORKER_BASE_URL}?title=${encodeURIComponent(dottedTitle)}`;
        try {
            const rpmRes = await fetch(rpmWorkerApiUrl);
            const rpmData = await rpmRes.json();
            if (rpmData && rpmData.result && Array.isArray(rpmData.result.files) && rpmData.result.files.length > 0) {
                const fileCode = rpmData.result.files[0].file_code;
                const playerBaseUrl = await getRegionBasedPlayerBaseUrl();
                episodeUrl = `${playerBaseUrl}/#${fileCode}&api=all`;
                isHlsWorkerLink = false;
                console.log(`âœ… Found RPM fallback for "${seriesName} ${formattedSeason}${formattedEpisode}": ${episodeUrl}`);
            }
        } catch (error) {
            console.error(`Error fetching HLS for "${seriesName} ${formattedSeason}${formattedEpisode}":`, error);
        }
    }
}

// -------------------------------------
// 3ï¸âƒ£ Final Fallback: Videasy (if needed)
// -------------------------------------
if (!episodeUrl && seriesId !== undefined) {
    episodeUrl = `https://player.videasy.net/tv/${seriesId}/${seasonNumber}/${episodeNumber}`;
    isHlsWorkerLink = true;
    console.log(`âš ï¸ Using fallback Videasy link for TMDB ID ${seriesId} S${seasonNumber}E${episodeNumber}: ${episodeUrl}`);
}


    if (episodeUrl) {
        modal.dataset.currentBackdrop = document.getElementById('modal-backdrop')?.src || '';
        let iframeAttributes = `id="movie-player-iframe" src="${episodeUrl}" width="100%" height="100%" frameborder="0" allowfullscreen style="aspect-ratio: 16/9;"`;

        if (isHlsWorkerLink) {
            iframeAttributes = `id="movie-player-iframe" src="${episodeUrl}" width="100%" height="100%" frameborder="0" allowfullscreen style="aspect-ratio: 16/9;"`;
        }

        if (!isDesktop) {
         // Mobile â†’ put iframe inside playerWrap
         playerWrap.innerHTML = `
           <iframe ${iframeAttributes}></iframe>
           <a class="player-close" onclick="closeModal()"><svg xmlns="http://www.w3.org/2000/svg" fill="none" role="img" viewBox="0 0 24 24" width="24" height="24" data-icon="XStandard" aria-hidden="true">
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.5858 12L2.29291 3.70706L3.70712 2.29285L12 10.5857L20.2929 2.29285L21.7071 3.70706L13.4142 12L21.7071 20.2928L20.2929 21.7071L12 13.4142L3.70712 21.7071L2.29291 20.2928L10.5858 12Z" fill="currentColor"></path>

</svg></a>
         `;
       } else {
         // Desktop â†’ put iframe inside iframe-holder
         const iframeHolder = document.getElementById("iframe-holder"); // or querySelector
         if (iframeHolder) {
           iframeHolder.innerHTML = `
             <iframe ${iframeAttributes}></iframe>
             <a class="player-close" onclick="playerClose()"><svg xmlns="http://www.w3.org/2000/svg" fill="none" role="img" viewBox="0 0 24 24" width="24" height="24" data-icon="XStandard" aria-hidden="true">
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.5858 12L2.29291 3.70706L3.70712 2.29285L12 10.5857L20.2929 2.29285L21.7071 3.70706L13.4142 12L21.7071 20.2928L20.2929 21.7071L12 13.4142L3.70712 21.7071L2.29291 20.2928L10.5858 12Z" fill="currentColor"></path>

</svg></a>
    <button id="next-button" class="next-button" onclick="playEpisode('${seriesName}', ${seasonNumber}, ${episodeNumber + 1}, '${seriesId}', '${uniqueEpisodeId}', '${releaseYear}')">
    â–¶ Next Episode
    </button>
           `;
         } else {
          console.error("iframe-holder element not found in the DOM");
           playerWrap.innerHTML = `
             <div style="display: flex; justify-content: center; align-items: center; height: 100%; color: white; font-size: 1.2em;">
               Error: Player container not found.
             </div>
             <a class="modal-close" onclick="playerClose()"><svg xmlns="http://www.w3.org/2000/svg" fill="none" role="img" viewBox="0 0 24 24" width="24" height="24" data-icon="XStandard" aria-hidden="true">
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.5858 12L2.29291 3.70706L3.70712 2.29285L12 10.5857L20.2929 2.29285L21.7071 3.70706L13.4142 12L21.7071 20.2928L20.2929 21.7071L12 13.4142L3.70712 21.7071L2.29291 20.2928L10.5858 12Z" fill="currentColor"></path>

</svg></a>
           `;
         }
       }

        modal.scrollTop = 0;
        saveToContinueWatching(seriesId, 'tv', modal.dataset.posterPath, modal.dataset.backdropPath);
        setupPlayerListener(playingId);
        window.open("https://otieu.com/4/9119528", "_blank");
    } else {
        playerWrap.innerHTML = `
            <div style="display: flex; justify-content: center; align-items: center; height: 100%; color: white; font-size: 1.2em;">Error: No playable content found.</div>
            <a class="modal-close" onclick="closeModal()"></a>
        `;
        console.error(`No play URL found for TV episode TMDB ID ${seriesId} S${seasonNumber}E${episodeNumber}.`);
    }
}

function closeModal() {
    if (window.progressInterval) {
        clearInterval(window.progressInterval);
        window.progressInterval = null;
    }
  
    if (player) {
                try {
                    player.stopVideo();
                    player.destroy();
                } catch (e) {
                    console.log('Error destroying player:', e);
                }
                player = null;
            }
  
    if (window.currentMessageHandler) {
        window.removeEventListener('message', window.currentMessageHandler);
        window.currentMessageHandler = null;
    }
  
    const modal = document.getElementById('tmdb-modal');
    const playerWrap = document.getElementById('playerWrap');
	const channelSection = document.getElementById('channel-content');
    const backdropContainer = document.getElementById('modal-backdrop-container');
    const iframeHolder = document.getElementById('iframe-holder');
    displayContinueWatching();
    if (iframeHolder) {
        iframeHolder.innerHTML = `
            <a class="player-close" onclick="ClosePlayer()"><svg xmlns="http://www.w3.org/2000/svg" fill="none" role="img" viewBox="0 0 24 24" width="24" height="24" data-icon="XStandard" aria-hidden="true">
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.5858 12L2.29291 3.70706L3.70712 2.29285L12 10.5857L20.2929 2.29285L21.7071 3.70706L13.4142 12L21.7071 20.2928L20.2929 21.7071L12 13.4142L3.70712 21.7071L2.29291 20.2928L10.5858 12Z" fill="currentColor"></path>

</svg></a>
        `;
        iframeHolder.style.display = 'none';
    }
    // Check if URL contains movie or tv parameters
    if (window.location.search.includes('movie=') || window.location.search.includes('tv=')) {
       history.pushState({}, '', window.location.pathname);
    }
  
    playerWrap.innerHTML = ``;
	channelSection.innerHTML = ``;
    if (modal.style.transform !== 'translateY(100%)') {
       modal.style.transform = 'translateY(100%)';
    }
    overlay.style.display = 'none';
    document.body.style.overflow = '';
    document.documentElement.style.overflow = '';
}
function playerClose() {
  const iframeholder = document.getElementById('iframe-holder');
  iframeholder.style.display = 'none';
  iframeholder.innerHTML = ``;
  displayContinueWatching();
}

function ClosePlayer() {
    if (window.progressInterval) {
        clearInterval(window.progressInterval);
        window.progressInterval = null;
    }
    if (window.currentMessageHandler) {
        window.removeEventListener('message', window.currentMessageHandler);
        window.currentMessageHandler = null;
    }
    const iframeHolder = document.getElementById('iframe-holder');
    if (iframeHolder) {
        iframeHolder.innerHTML = `
            <a class="player-close" onclick="ClosePlayer()"><svg xmlns="http://www.w3.org/2000/svg" fill="none" role="img" viewBox="0 0 24 24" width="24" height="24" data-icon="XStandard" aria-hidden="true">
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.5858 12L2.29291 3.70706L3.70712 2.29285L12 10.5857L20.2929 2.29285L21.7071 3.70706L13.4142 12L21.7071 20.2928L20.2929 21.7071L12 13.4142L3.70712 21.7071L2.29291 20.2928L10.5858 12Z" fill="currentColor"></path>

</svg></a>
        `;
        iframeHolder.style.display = 'none';
    }
    const modal = document.getElementById('tmdb-modal');
    const playerWrap = document.getElementById('playerWrap');
    const playBtn = document.getElementById('modal-play');
    playerWrap.innerHTML = ``;
    playBtn.style.display = 'flex';
    document.body.style.overflow = '';
    document.documentElement.style.overflow = '';
}

document.querySelectorAll('.share-btn').forEach(btn => {
    btn.onclick = async () => {
        const titleElement = document.querySelector('.model-title');
        const title = titleElement ? titleElement.textContent.trim() : 'this';
        const url = window.location.href;
        const text = `Hey, I'm watching ${title} watch it out on Watch Out!`;

        if (navigator.share) {
            try {
                await navigator.share({
                    title: `Watch ${title}`,
                    text: text,
                    url: url,
                });
            } catch (err) {
                console.error('Share failed:', err);
                fallbackCopy(`${text}\n${url}`);
            }
        } else {
            fallbackCopy(`${text}\n${url}`);
        }
    };
});

const fallbackCopy = (message) => {
    if (navigator.clipboard) {
        navigator.clipboard.writeText(message)
            .then(() => alert('Link copied to clipboard!'))
            .catch(err => {
                console.error('Clipboard copy failed:', err);
            });
    }
};
</script>

  
<script>
// Function to display items from myList in the my-list-container
function displayMyList() {
    const myListContainer = document.getElementById('my-list-container');
    if (!myListContainer) {
        console.error('my-list-container element not found in the DOM');
        return;
    }

    // Clear existing content
    myListContainer.innerHTML = '';

    // Get myList from localStorage
    const myList = JSON.parse(localStorage.getItem('myList') || '[]');

    if (myList.length === 0) {
        myListContainer.innerHTML = '<p style="color: white; padding: 10px;">Your list is empty.</p>';
        return;
    }

    // Create a card for each item
    myList.forEach(item => {
        const card = document.createElement('div');
        card.className = 'movie-card';
        
        // Create poster image
        const img = document.createElement('img');
        img.src = item.posterUrl || 'https://placehold.co/150x225/cccccc/333333?text=No+Image';
        img.alt = `${item.mediaType} poster`;

        // Add click event to open modal
        card.onclick = () => openModal(item.id, item.mediaType);

        // Append image to card
        card.appendChild(img);

        // Append card to container
        myListContainer.appendChild(card);
    });
}

// Call the function when the page loads
document.addEventListener('DOMContentLoaded', displayMyList);
</script>
<!------------------------------------------------------------------------- Update Metatag Script ------------------------------------------------------------------------------------------>
  
<script>
function updateMetaTags({ title, overview, posterPath }) {
  document.title = `${title} | WatchOut`;

  const description = document.querySelector('meta[name="description"]');
  if (description) description.setAttribute('content', overview);

  const ogTitle = document.querySelector('meta[property="og:title"]');
  const ogDesc = document.querySelector('meta[property="og:description"]');
  const ogImg = document.querySelector('meta[property="og:image"]');
  const ogUrl = document.querySelector('meta[property="og:url"]');
  const twitterImg = document.querySelector('meta[name="twitter:image"]');

  if (ogTitle) ogTitle.setAttribute('content', title);
  if (ogDesc) ogDesc.setAttribute('content', overview);
  if (ogImg) ogImg.setAttribute('content', `https://image.tmdb.org/t/p/w780${posterPath}`);
  if (ogUrl) ogUrl.setAttribute('content', window.location.href);
  if (twitterImg) twitterImg.setAttribute('content', `https://image.tmdb.org/t/p/w780${posterPath}`);

  let canonical = document.querySelector('link[rel="canonical"]');
  if (!canonical) {
    canonical = document.createElement('link');
    canonical.setAttribute('rel', 'canonical');
    document.head.appendChild(canonical);
  }
  canonical.setAttribute('href', window.location.href);
}

</script>


  
<!------------------------------------------------------------------------- Schema Script ------------------------------------------------------------------------------------------>
  
<script>
function injectJSONLD(data, type = 'movie') {
  const oldScript = document.querySelector('script[type="application/ld+json"]');
  if (oldScript) oldScript.remove();

  const jsonLD = {
    "@context": "https://schema.org",
    "@type": type === 'tv' ? "TVSeries" : "Movie",
    "name": data.title || data.name || '',
    "description": data.overview || '',
    "image": data.poster_path ? `https://image.tmdb.org/t/p/w500${data.poster_path}` : '',
    "genre": Array.isArray(data.genres) ? data.genres.map(g => g.name) : [],
    "datePublished": data.release_date || data.first_air_date || '',
    "aggregateRating": {
      "@type": "AggregateRating",
      "ratingValue": (data.vote_average || 0).toFixed(1),
      "bestRating": 10,
      "ratingCount": data.vote_count || 0
    }
  };

  if (type === 'movie' && data.credits?.crew) {
    const director = data.credits.crew.find(p => p.job === "Director");
    if (director) {
      jsonLD.director = { "@type": "Person", "name": director.name };
    }
  }

  if (data.credits?.cast?.length > 0) {
    jsonLD.actor = data.credits.cast.slice(0, 5).map(actor => ({
      "@type": "Person",
      "name": actor.name
    }));
  }

  const trailer = data.videos?.results?.find(v => v.type === "Trailer" && v.site === "YouTube");
  if (trailer) {
    jsonLD.trailer = {
      "@type": "VideoObject",
      "name": trailer.name,
      "embedUrl": `https://www.youtube.com/embed/${trailer.key}`,
      "thumbnailUrl": `https://img.youtube.com/vi/${trailer.key}/maxresdefault.jpg`,
      "uploadDate": data.release_date || data.first_air_date || ''
    };
  }

  const script = document.createElement('script');
  script.type = 'application/ld+json';
  script.textContent = JSON.stringify(jsonLD, null, 2);
  document.head.appendChild(script);
}
</script>
  
<!------------------------------------------------------------------------- KDrama------------------------------------------------------------------------------------------>
  
<style>
  /* Netflix-like styling with unique classes, no card titles, no body CSS */
  .kd-container { 
    padding-bottom: 30px;
  }
  
  .kd-relative {
    position: relative;
  }
  .kd-scroll-container {
    display: flex;
    overflow-x: auto;
    gap: 0.5rem;
    padding-left: 4%;
    scrollbar-width: none; /* Firefox */
  }
  .kd-scroll-container::-webkit-scrollbar {
    display: none; /* Chrome, Safari */
  }
  .kd-card ,.cd-card ,.ja-card{
    width: 29.22%;
    aspect-ratio: 2/2.8;
    flex: 0 0 auto;
    background: #111;
    border-radius: 6px;
    overflow: hidden;
    cursor: pointer;
  }
 
  .kd-card img,.cd-card img ,.ja-card img{
    width: 100%;
    height: auto;
	aspect-ratio:inherit;
    object-fit: unset;
  }
  .kd-scroll-btn {
    display: none; /* Hidden by default */
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    background: rgba(0, 0, 0, 0.5);
    color: #fff;
    border: none;
    padding: 8px;
    border-radius: 50%;
    cursor: pointer;
    z-index: 20;
  }
  .kd-scroll-btn:hover {
    background: rgba(0, 0, 0, 0.75);
  }
  #kd-scroll-left {
    left: 0;
  }
  #kd-scroll-right {
    right: 0;
  }
  .kd-error {
    color: #e50914;
    margin-top: 16px;
    display: none;
  }
  @media (max-width: 1000px) {
    .kd-scroll-btn, .cd-scroll-btn, .ja-scroll-btn {
      display: none !important; /* Show buttons on desktop */
    }
  }
  @media (min-width: 1024px) {
    .kd-scroll-btn, .cd-scroll-btn, .ja-scroll-btn {
      display: block !important; /* Show buttons on desktop */
    }
    .kd-card, .cd-card ,.ja-card{
      flex: 0 0 200px;
    }
    .kd-card img , .cd-card img ,.ja-card {
      height: 300px;
    }
    .kd-title {
      font-size: 20px;
      color: #fff;
      padding-bottom: 0.55rem;  
    }
  }
</style>



<script>
  document.addEventListener('DOMContentLoaded', () => {

    // API endpoint
    const tmdbApiEndpoint = 'https://search-proxy.bingeoutofficial.workers.dev/discover/tv?language=en-US&with_original_language=ko&sort_by=popularity.desc&first_air_date.gte=2020-01-01&first_air_date.lte=2025-11-18&with_genres=18';

    // Fetch TV shows
    const fetchTVShows = async () => {
      try {
        const response = await fetch(tmdbApiEndpoint);
        if (!response.ok) throw new Error(`HTTP error! Status: ${response.status}`);
        const data = await response.json();
        return data.results.slice(0, 20); // Get top 20 results
      } catch (error) {
        const errorDiv = document.getElementById('kd-error-message');
        errorDiv.textContent = 'Error loading TV shows. Please try again later.';
        errorDiv.style.display = 'block';
        console.error('Fetch error:', error.message);
        return [];
      }
    };

    // Render TV show cards
    const renderShows = (shows) => {
      const container = document.getElementById('kd-shows-container');
      container.innerHTML = ''; // Clear existing content
      shows.forEach((show) => {
        const card = document.createElement('div');
        card.className = 'kd-card';
        card.onclick = () => openModal(show.id, 'tv'); // Add onclick event
        card.innerHTML = `
          <img 
            src="${show.poster_path ? `https://image.tmdb.org/t/p/w500${show.poster_path}` : 'https://via.placeholder.com/500x750?text=No+Image'}" 
            alt="${show.name}"
          >
        `;
        container.appendChild(card);
      });
    };
// Initialize
    const init = async () => {
      const shows = await fetchTVShows();
      if (shows.length > 0) {
        renderShows(shows);
      }
    };

    // Run initialization
    init();
  });
</script>
<!------------------------------------------------------------------------- Cdrama------------------------------------------------------------------------------------------>

<style>
  /* Netflix-like styling with unique classes for Chinese dramas, no card titles, no body CSS */
  .cd-container {
   
    padding-bottom: 30px;
  }
  .cd-title {
    font-size: 20px;
    color: #fff;
  }
  .cd-relative {
    position: relative;
  }
  .cd-scroll-container {
    display: flex;
    overflow-x: auto;
    gap: 0.5rem;
    padding-left: 4%;
    scrollbar-width: none; /* Firefox */
  }
  .cd-scroll-container::-webkit-scrollbar {
    display: none; /* Chrome, Safari */
  }

  
  .cd-card img {
    width: 100%;
    height: auto;
    object-fit: cover;
  }
  .cd-scroll-btn {
    display: none; /* Hidden by default */
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    background: rgba(0, 0, 0, 0.5);
    color: #fff;
    border: none;
    padding: 8px;
    border-radius: 50%;
    cursor: pointer;
    z-index: 20;
  }
  .cd-scroll-btn:hover {
    background: rgba(0, 0, 0, 0.75);
  }
  #cd-scroll-left {
    left: 0;
  }
  #cd-scroll-right {
    right: 0;
  }
  .cd-error {
    color: #e50914;
    margin-top: 16px;
    display: none;
  }
  
</style>



<script>
  document.addEventListener('DOMContentLoaded', () => {
    // API endpoint
    const tmdbApiEndpoint = 'https://search-proxy.bingeoutofficial.workers.dev/discover/tv?language=en-US&with_original_language=zh&sort_by=popularity.desc&first_air_date.gte=2020-01-01&first_air_date.lte=2025-11-18&with_genres=18&without_genres=16';

    // Fetch TV shows
    const fetchTVShows = async () => {
      try {
        const response = await fetch(tmdbApiEndpoint);
        if (!response.ok) throw new Error(`HTTP error! Status: ${response.status}`);
        const data = await response.json();
        return data.results.slice(0, 20); // Get top 20 results
      } catch (error) {
        const errorDiv = document.getElementById('cd-error-message');
        errorDiv.textContent = 'Error loading TV shows. Please try again later.';
        errorDiv.style.display = 'block';
        console.error('Fetch error:', error.message);
        return [];
      }
    };

    // Render TV show cards
    const renderShows = (shows) => {
      const container = document.getElementById('cd-shows-container');
      container.innerHTML = ''; // Clear existing content
      shows.forEach((show) => {
        const card = document.createElement('div');
        card.className = 'cd-card';
        card.onclick = () => openModal(show.id, 'tv'); // Add onclick event
        card.innerHTML = `
          <img 
            src="${show.poster_path ? `https://image.tmdb.org/t/p/w500${show.poster_path}` : 'https://via.placeholder.com/500x750?text=No+Image'}" 
            alt="${show.name}"
          >
        `;
        container.appendChild(card);
      });
    };

    // Initialize
    const init = async () => {
      const shows = await fetchTVShows();
      if (shows.length > 0) {
        renderShows(shows);
      }
    };

    // Run initialization
    init();
  });
</script>

<!------------------------------------------------------------------------- J-Anime------------------------------------------------------------------------------------------>  

<style>
  /* Netflix-like styling with unique classes for Japanese anime, no card titles, no body CSS */
  .ja-container {
    padding-bottom: 30px;
  }
  .ja-title {
    font-size: 20px;
    padding-left: 4%;
    font-weight: 800;
    margin-bottom: 0.55rem;
    color: #fff;
  }
  .ja-relative {
    position: relative;
  }
  .ja-scroll-container {
    display: flex;
    overflow-x: auto;
    gap: 0.5rem;
    padding-left: 4%;
    scrollbar-width: none; /* Firefox */
  }
  .ja-scroll-container::-webkit-scrollbar {
    display: none; /* Chrome, Safari */
  }
  .ja-card {
    transition: transform 0.3s;
    cursor: pointer; /* Indicate clickable */
  }
 
  .ja-scroll-btn {
    display: none; /* Hidden by default */
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    background: rgba(0, 0, 0, 0.5);
    color: #fff;
    border: none;
    padding: 8px;
    border-radius: 50%;
    cursor: pointer;
    z-index: 20;
  }
  .ja-scroll-btn:hover {
    background: rgba(0, 0, 0, 0.75);
  }
  #ja-scroll-left {
    left: 0;
  }
  #ja-scroll-right {
    right: 0;
  }
  .ja-error {
    color: #e50914;
    margin-top: 16px;
    display: none;
  }
  @media (min-width: 1024px) {
    .ja-scroll-btn {
      display: block; /* Show buttons on desktop */
    }
    .ja-card {
      flex: 0 0 200px;
    }
    .ja-card img {
      height: 300px;
    }
    .ja-title {
      font-size: 20px;
    }
  }
</style>



<script>
  document.addEventListener('DOMContentLoaded', () => {  
    // API endpoint
    const tmdbApiEndpoint = 'https://search-proxy.bingeoutofficial.workers.dev/discover/tv?language=en-US&with_original_language=ja&sort_by=popularity.desc&first_air_date.gte=2020-01-01&first_air_date.lte=2025-11-18&with_genres=16';

    // Fetch TV shows
    const fetchTVShows = async () => {
      try {
        const response = await fetch(tmdbApiEndpoint);
        if (!response.ok) throw new Error(`HTTP error! Status: ${response.status}`);
        const data = await response.json();
        return data.results.slice(0, 20); // Get top 20 results
      } catch (error) {
        const errorDiv = document.getElementById('ja-error-message');
        errorDiv.textContent = 'Error loading TV shows. Please try again later.';
        errorDiv.style.display = 'block';
        console.error('Fetch error:', error.message);
        return [];
      }
    };

    // Render TV show cards
    const renderShows = (shows) => {
      const container = document.getElementById('ja-shows-container');
      container.innerHTML = ''; // Clear existing content
      shows.forEach((show) => {
        const card = document.createElement('div');
        card.className = 'ja-card';
        card.onclick = () => openModal(show.id, 'tv'); // Add onclick event
        card.innerHTML = `
          <img 
            src="${show.poster_path ? `https://image.tmdb.org/t/p/w500${show.poster_path}` : 'https://via.placeholder.com/500x750?text=No+Image'}" 
            alt="${show.name}"
          >
        `;
        container.appendChild(card);
      });
    };

    // Initialize
    const init = async () => {
      const shows = await fetchTVShows();
      if (shows.length > 0) {
        renderShows(shows);
      }
    };

    // Run initialization
    init();
  });
</script>  
<!------------------------------------------------------------------------- Telegram------------------------------------------------------------------------------------------>  
  
<style>
  .telegram-banner {
    display: flex;
    align-items: center;
    justify-content: space-between;
    background: rgba(42, 42, 42, 0.6);
    color: white;
    padding: 10px;
    border: 1px solid rgba(255, 255, 255, 0.15);
    border-radius: 5px;
    margin: 10px 4%;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    text-decoration: none;
  }

  .telegram-banner img {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    border: 2px solid #ffffff;
  }

  .telegram-info {
    flex-grow: 1;
    margin-left: 15px;
  }

  .telegram-title {
    font-size: 18px;
    font-weight: bold;
  }

  .telegram-description {
    font-size: 14px;
    opacity: 0.8;
  }
  @media (max-width: 1000px) {
    .border-t {
        margin-bottom: 60px;
    }
    .bottom-disclaimer{
      display:none;}
}
  
</style>

<a class="telegram-banner" href="https://t.me/WatchOut_fun" target="_blank">
  <img src="https://w7.pngwing.com/pngs/979/991/png-transparent-telegram-flat-black-icon-social-media-flat-black-icon-thumbnail.png" alt="Telegram" />
  <div class="telegram-info">
    <div class="telegram-title">Join Our Telegram Group</div>
    <div class="telegram-description">Get the latest updates, movies, and series directly.</div>
  </div>
</a>  
  
<!------------------------------------------------------------------------- Footer-------------------------------------------------------------------------------------------->
<!------------------------------------------------------------------------- Footer-------------------------------------------------------------------------------------------->
<!------------------------------------------------------------------------- Footer-------------------------------------------------------------------------------------------->

  
<footer class="border-t border-[#1a2a35] h-12">
    <div class="max-w-screen-xl mx-auto px-4 h-full flex items-center space-x-2">
      <img
        src="/icons/indra-group-logo.png"
        alt="Indra Group logo"
        class="h-4 w-auto"
      />
      <span class="text-[#6b7a8a] text-xs">Â© Watch Out, LLC</span>
    </div>
	<a href="https://watchout.fun/download" target="_blank">
       <img src="/icons/downloadapk.png" 
       style="height: 30px; border-radius: 4px; border: white 1px solid;">
    </a>

    <div class="bottom-disclaimer" data-v-3feaf96d="" bis_skin_checked="1" style="
    color: #fff;
    font-size: 11px;
"> Â© 2025 Cinexa - All external content remains the property of the rightful owner. <span data-v-3feaf96d="" style="color: var(--ion-color-secondary);">(3.13.0)</span>
    </div>
  </footer>







<!-- Navigation Bar Code -->
<style>
    /* Netflix Navigation Bar */
    .netflix-nav {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        background: rgba(20, 20, 20, 0.95);
        backdrop-filter: blur(10px);
        border-top: 1px solid rgba(255, 255, 255, 0.1);
        z-index: 1000;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    }
@media (min-width: 1000px) {
  .netflix-nav {
    display: none;
  }
}

@media (min-width: 900px) {
  .home-top-nav {
    display: none;
  }
}

    .nav-container {
        display: flex;
        justify-content: space-around;
        align-items: center;
        padding: 8px 0;
        max-width: 600px;
        margin: 0 auto;
    }

    .nav-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        color: #8c8c8c;
        transition: all 0.3s ease;
        padding: 8px 16px;
        border-radius: 8px;
        min-width: 70px;
        position: relative;
        cursor: pointer;
    }

    .nav-item:hover {
        color: white;
        transform: translateY(-2px);
    }

    .nav-item.active {
        color: white;
    }

    .nav-icon {
        width: 24px;
        height: 24px;
        margin-bottom: 4px;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .nav-text {
        font-size: 10px;
        font-weight: 500;
        text-align: center;
        line-height: 1.2;
    }

    /* Home Icon */
    .home-icon {
        width: 22px;
        height: 22px;
        background: currentColor;
        clip-path: polygon(50% 0%, 0% 40%, 0% 100%, 100% 100%, 100% 40%);
    }

    /* Search Icon */
    .search-icon {
        width: 22px;
        height: 22px;
    }

    .search-icon svg {
        width: 100%;
        height: 100%;
        stroke: currentColor;
    }

    /* New & Hot Icon (Play button) */
    .play-icon {
        width: 22px;
        height: 22px;
        border: 2px solid currentColor;
        border-radius: 4px;
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .play-icon::after {
        content: '';
        width: 0;
        height: 0;
        border-left: 6px solid currentColor;
        border-top: 4px solid transparent;
        border-bottom: 4px solid transparent;
        margin-left: 2px;
    }

    /* Profile Icon */
    .profile-icon {
        width: 22px;
        height: 22px;
        border-radius: 5px;
        background: linear-gradient(135deg, #4a90e2, #357abd);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 12px;
        font-weight: bold;
        color: white;
    }

    /* Active state indicator */
    .nav-item.active::before {
        content: '';
        position: absolute;
        top: -8px;
        left: 50%;
        transform: translateX(-50%);
        width: 4px;
        height: 4px;
        background: #e50914;
        border-radius: 50%;
    }

    /* Loading bar animation */
    .loading-bar {
        position: absolute;
        bottom: 100%;
        left: 50%;
        transform: translateX(-50%);
        width: 80%;
        height: 2px;
        background: rgba(255, 255, 255, 0.2);
        border-radius: 1px;
        overflow: hidden;
    }

    .loading-progress {
        height: 100%;
        width: 60%;
        background: white;
        border-radius: 1px;
        animation: loading 2s ease-in-out infinite;
    }

    @keyframes loading {
        0% { transform: translateX(-100%); }
        50% { transform: translateX(0%); }
        100% { transform: translateX(100%); }
    }

    /* Responsive adjustments */
    @media (max-width: 480px) {
        .nav-container {
            padding: 6px 0;
        }
        
        .nav-item {
            padding: 6px 12px;
            min-width: 60px;
        }
        
        .nav-icon {
            width: 20px;
            height: 20px;
        }
        
        .home-icon,
        .play-icon,
        .search-icon,
        .profile-icon {
            width: 20px;
            height: 20px;
        }
        
        .nav-text {
            font-size: 9px;
        }
    }
</style>

<!-- HTML STRUCTURE - Add this anywhere in your <body> section (preferably at the end) -->
        <nav class="netflix-nav">
            <div class="nav-container">
                <div id="home-nav" class="nav-item active" data-page="home">
                    <div class="nav-icon">
                        <div class="home-icon"></div>
                    </div>
                    <span class="nav-text">Home</span>
                </div>
        
                <div class="nav-item" data-page="search">
            <div class="nav-icon">
                <div class="search-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="11" cy="11" r="8"></circle>
                        <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                    </svg>
                </div>
            </div>
            <span class="nav-text">Search</span>
        </div>
        
        <div id="new-hot-nav" class="nav-item" data-page="new">
            <div class="nav-icon">
                <div class="play-icon"></div>
            </div>
            <span class="nav-text">New & Hot</span>
        </div>
        
        <div id="my-netflix-nav" class="nav-item" data-page="profile">
            <div class="nav-icon">
                <div class="profile-icon"><img src="https://occ-0-4345-3647.1.nflxso.net/dnm/api/v6/vN7bi_My87NPKvsBoib006Llxzg/AAAABfjwXqIYd3kCEU6KWsiHSHvkft8VhZg0yyD50a_pHXku4dz9VgxWwfA2ontwogStpj1NE9NJMt7sCpSKFEY2zmgqqQfcw1FMWwB9.png?r=229&quot;" alt="User Avatar" style="width:24px; height:24px; border-radius:4px;">
                </div>
                  </div>
                        <span class="nav-text">My Stuff</span>
                  </div>
             </div>
        </nav>
  </div>
<!-- JAVASCRIPT - Add this before closing </body> tag or in a separate JS file -->
<script>
// Navigation functionality
// Navigation functionality
const navItems = document.querySelectorAll('.nav-item');
const tmdbSearchContainer = document.getElementById('tmdb-search-container');
const tmdbToggleButton = document.getElementById('tmdb-toggle-btn');

navItems.forEach(item => {
    item.addEventListener('click', (e) => {
        e.preventDefault();

        // Scroll to top of the page
        window.scrollTo({ top: 0, behavior: 'smooth' }); // Smooth scroll

        // Remove active class from all items
        navItems.forEach(nav => nav.classList.remove('active'));

        // Add active class to clicked item
        item.classList.add('active');

        // Add click animation
        item.style.transform = 'scale(0.95)';
        setTimeout(() => {
            item.style.transform = '';
        }, 150);

        // Simulate page change
        const page = item.dataset.page;
        console.log(`Navigating to ${page} page`);

        // Handle the 'expanded' class for the search container
        if (tmdbSearchContainer) {
            if (page === 'search') {
                if (window.location.pathname !== '/search') {
                searchPage.scrollTop = 0;
                history.pushState({}, '', '/search');
                }

                searchPage.classList.add('is-visible');
                searchInputBar.focus();
            } 
        }

        // Handle the display for the toggle button
    });
});

window.addEventListener('popstate', (event) => {
  // get the current path (ignoring query string / hash)
  const path = window.location.pathname;

  if (path === '/search') {
    // if URL is /search, ensure the searchPage is visible
    searchPage.classList.add('is-visible');
    searchInputBar.focus();
  } else {
    // otherwise, remove the â€œis-visibleâ€ class
    searchPage.classList.remove('is-visible');
    searchInputBar.blur();
  }
});

</script>
<!-- Section Switching Script -->
<script>
    // ðŸ”¹ Real function declaration
    function showSection(sectionId) {
        const homeSection = document.getElementById('home-section');
        const newHotSection = document.getElementById('new-hot-section');
        const myNetflixSection = document.getElementById('my-netflix-section');

        const homeNav = document.getElementById('home-nav');
        const newHotNav = document.getElementById('new-hot-nav');
        const myNetflixNav = document.getElementById('my-netflix-nav');

        const headerTitle = document.getElementById('header-title');
        const headerLogoImg = document.getElementById('header-logo-img');

        // ðŸ”¹ Detect mobile
        const fragContMobile = window.innerWidth <= 750;

        // Hide all sections
        homeSection.classList.add('section-hidden');
        newHotSection.classList.add('section-hidden');
        myNetflixSection.classList.add('section-hidden');

        // Deactivate all nav buttons
        homeNav.classList.remove('active');
        newHotNav.classList.remove('active');
        myNetflixNav.classList.remove('active');

        // Always reset header
        headerTitle.textContent = '';
        headerLogoImg.classList.remove('hidden-element');

        // Show specific section
        switch (sectionId) {
            case 'home':
                homeSection.classList.remove('section-hidden');
                homeNav.classList.add('active');
                searchPage.classList.remove('is-visible');
                break;

            case 'new-hot':
                newHotSection.classList.remove('section-hidden');
                newHotNav.classList.add('active');
                searchPage.classList.remove('is-visible');
                headerTitle.textContent = 'New & Hot';
                if (fragContMobile) {
                    headerLogoImg.classList.add('hidden-element');
                }
                break;

            case 'my-netflix':
                myNetflixSection.classList.remove('section-hidden');
                myNetflixNav.classList.add('active');
                headerTitle.textContent = 'My WatchOut';
                searchPage.classList.remove('is-visible');
                displayMyList();
                if (fragContMobile) {
                    headerLogoImg.classList.add('hidden-element');
                }
                break;
                
        }
    }

    document.addEventListener('DOMContentLoaded', () => {
        const homeNav = document.getElementById('home-nav');
        const newHotNav = document.getElementById('new-hot-nav');
        const myNetflixNav = document.getElementById('my-netflix-nav');

        // Event Listeners
        homeNav.addEventListener('click', () => showSection('home'));
        newHotNav.addEventListener('click', () => showSection('new-hot'));
        myNetflixNav.addEventListener('click', () => showSection('my-netflix'));

        // Initially show the 'Home' section
        showSection('home');
    });
</script>


  <script>
window.addEventListener("message", function (event) {
  // Try-catch block to safely parse the message data
  try {
    const data = JSON.parse(event.data);
    
    // Log the full received message to the console for debugging
    //console.log("Message received from the player:", data);
    
    // Check for a timeupdate event from the player
    if (data.type === "PLAYER_EVENT" && data.data.event === "timeupdate") {
      const { mediaType, id, season, episode, currentTime, duration } = data.data;
      
      let uniqueContentId;
      
      // Conditionally construct the unique ID based on mediaType
      if (mediaType === "tv") {
        uniqueContentId = `${mediaType}_${id}_${season}_${episode}`;
      } else {
        uniqueContentId = `${mediaType}_${id}`;
      }
      
      // Call your saveVideoProgress function with the extracted data
      saveVideoProgress(uniqueContentId, currentTime, duration);
      
      // Confirmation log after the function call
      //console.log(`Successfully called saveVideoProgress for ${uniqueContentId}`);
    }
    
  } catch (e) {
    // Fallback for non-JSON messages
    if (typeof event.data === "string") {
      var messageArea = document.querySelector("#messageArea");
      if (messageArea) {
        messageArea.innerText = event.data;
      }
    }
  }
});
   </script>
  <script>
        // YouTube API setup
        var tag = document.createElement('script');
        tag.src = "https://www.youtube.com/iframe_api";
        var firstScriptTag = document.getElementsByTagName('script')[0];
        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
    
        let player = null;
        let apiReady = false;
        let currentVideoId = null;
        let progressInterval = null; // Variable to hold the interval ID
    
        // This function is called automatically by the YouTube IFrame API when it's ready.
        function onYouTubeIframeAPIReady() {
            apiReady = true;
        }
    

        /**
         * Creates a new YouTube player instance.
         * @param {string} videoId The YouTube video ID.
         */
        function createPlayer(videoId) {
            const placeholder = document.getElementById('iframePlaceholder');
        
            // Clear any existing content to prevent issues
            placeholder.innerHTML = '';
        
            const playerFrame = document.createElement('iframe');
            playerFrame.id = 'youtubePlayer';
            playerFrame.width = '100%';
            playerFrame.height = '100%';
            // Construct the YouTube embed URL with autoplay, muted, and other parameters
            playerFrame.src = `https://www.youtube.com/embed/${videoId}?autoplay=1&mute=1&controls=0&showinfo=0&rel=0&modestbranding=1&iv_load_policy=3&disablekb=1&cc_load_policy=0&fs=0&playsinline=1&title=0&enablejsapi=1&end=999999&vq=hd1080`;
            playerFrame.frameborder = '0';
            playerFrame.classList.add('hidden');
        
            placeholder.appendChild(playerFrame);
        
            player = new YT.Player(playerFrame, {
                events: {
                    'onReady': onPlayerReady,
                    'onStateChange': onPlayerStateChange
                }
            });
        }
    
        /**
         * Hides the backdrop image and shows the video player when the video is ready.
         */
        let playerVisible = false; // Track if player has been shown
    
        function onPlayerReady() {
            // Don't show the player immediately - wait for 1 second of playback
            playerVisible = false;
        
            // Start the progress bar animation and store the interval ID
            if (progressInterval) {
                clearInterval(progressInterval);
            }
            progressInterval = setInterval(updateProgress, 100);
        }
    
        /**
         * Handles player state changes, such as video ending.
         * @param {object} event The YouTube Player API event object.
         */
        function onPlayerStateChange(event) {
            const playerWrap = document.getElementById('playerWrap');
            const backdropOverlay = document.getElementById('modal-backdrop-container');
            const playerFrame = document.getElementById('youtubePlayer');
        
            if (event.data === YT.PlayerState.ENDED) {
                // Show replay overlay (the ::after pseudo-element) when the video finishes
                playerWrap.classList.add("shown");

                // Show backdrop and hide player when video ends
                if (backdropOverlay && playerFrame) {
                    backdropOverlay.classList.remove('hidden');
                    playerFrame.classList.add('hidden');
                }
              
            } else if (event.data === YT.PlayerState.PLAYING) {
                // Hide replay overlay when the video is playing
                playerWrap.classList.remove("shown");
            }
        }

        function toggleMute() {
            if (!player) return;
        
            const isMuted = player.isMuted();
            const volumeIcon = document.getElementById('volume-icon');
        
            if (isMuted) {
                player.unMute();
                // Change to the "unmuted" icon
                volumeIcon.innerHTML = `<path fill-rule="evenodd" clip-rule="evenodd" d="M24 12C24 8.28693 22.525 4.72597 19.8995 2.10046L18.4853 3.51468C20.7357 5.76511 22 8.81736 22 12C22 15.1826 20.7357 18.2348 18.4853 20.4852L19.8995 21.8995C22.525 19.2739 24 15.713 24 12ZM11 3.99995C11 3.59549 10.7564 3.23085 10.3827 3.07607C10.009 2.92129 9.57889 3.00685 9.29289 3.29285L4.58579 7.99995H1C0.447715 7.99995 0 8.44767 0 8.99995V15C0 15.5522 0.447715 16 1 16H4.58579L9.29289 20.7071C9.57889 20.9931 10.009 21.0786 10.3827 20.9238C10.7564 20.7691 11 20.4044 11 20V3.99995ZM5.70711 9.70706L9 6.41417V17.5857L5.70711 14.2928L5.41421 14H5H2V9.99995H5H5.41421L5.70711 9.70706ZM16.0001 12C16.0001 10.4087 15.368 8.88254 14.2428 7.75732L12.8285 9.17154C13.5787 9.92168 14.0001 10.9391 14.0001 12C14.0001 13.0608 13.5787 14.0782 12.8285 14.8284L14.2428 16.2426C15.368 15.1174 16.0001 13.5913 16.0001 12ZM17.0709 4.92889C18.9462 6.80426 19.9998 9.3478 19.9998 12C19.9998 14.6521 18.9462 17.1957 17.0709 19.071L15.6567 17.6568C17.157 16.1565 17.9998 14.1217 17.9998 12C17.9998 9.87823 17.157 7.8434 15.6567 6.34311L17.0709 4.92889Z" fill="currentColor"></path>`;
            } else {
                player.mute();
                // Change to the "muted" icon
                volumeIcon.innerHTML = `<path fill-rule="evenodd" clip-rule="evenodd" d="M11 4.00003C11 3.59557 10.7564 3.23093 10.3827 3.07615C10.009 2.92137 9.57889 3.00692 9.29289 3.29292L4.58579 8.00003H1C0.447715 8.00003 0 8.44774 0 9.00003V15C0 15.5523 0.447715 16 1 16H4.58579L9.29289 20.7071C9.57889 20.9931 10.009 21.0787 10.3827 20.9239C10.7564 20.7691 11 20.4045 11 20V4.00003ZM5.70711 9.70714L9 6.41424V17.5858L5.70711 14.2929L5.41421 14H5H2V10H5H5.41421L5.70711 9.70714ZM15.2929 9.70714L17.5858 12L15.2929 14.2929L16.7071 15.7071L19 13.4142L21.2929 15.7071L22.7071 14.2929L20.4142 12L22.7071 9.70714L21.2929 8.29292L19 10.5858L16.7071 8.29292L15.2929 9.70714Z" fill="currentColor"></path>`;
            }
        }
    
        /**
         * Updates the progress bar based on video playback time.
         */
        function updateProgress() {
            const progressBorder = document.getElementById('progressBorder');
            const backdrop = document.getElementById('modal-backdrop-container');
            const playerFrame = document.getElementById('youtubePlayer');
        
            if (player && player.getCurrentTime) {
                const currentTime = player.getCurrentTime();
                const duration = player.getDuration();
                const progress = (currentTime / duration) * 100;
                const remainingTime = duration - currentTime;
              
                progressBorder.style.width = progress + '%';
                // Show player only after 1 second of playback (only check if not already visible)
                if (!playerVisible && currentTime >= 1.0) {
                    backdrop.classList.add('hidden');
                    playerFrame.classList.remove('hidden');
                    playerVisible = true; // Stop checking visibility
                }
                // Show backdrop 5 seconds before video ends
                if (playerVisible && remainingTime <= 10 && remainingTime > 0) {
                    if (backdrop && playerFrame) {
                        backdrop.classList.remove('hidden');
                        playerFrame.classList.add('hidden');
                    }
                }
            }
        }
    
        /**
         * Closes the modal and cleans up the player.
         */
        //function closeModal() {
         /**   const modal = document.getElementById('movieModal');
        
            // Hide modal
            modal.classList.remove('show');
            currentVideoId = null;
            
            // Clear the progress interval and reset the bar
            if (progressInterval) {
                clearInterval(progressInterval);
                progressInterval = null;
            }
            document.getElementById('progressBorder').style.width = '0%';
        
            // Stop and destroy the YouTube player instance
            if (player) {
                try {
                    player.stopVideo();
                    player.destroy();
                } catch (e) {
                    console.log('Error destroying player:', e);
                }
                player = null;
            }
        
            // Clear the iframe and reset the modal state
            const placeholder = document.getElementById('iframePlaceholder');
            if (placeholder) {
                placeholder.innerHTML = '';
            }
        
            const backdrop = document.getElementById('modal-backdrop-container');
            backdrop.classList.remove('hidden');
        
            const playerWrap = document.getElementById('playerWrap');
            playerWrap.classList.remove("shown");

            // Remove the scroll listener from the modal
            const modalContent = modal.querySelector('.modal-content');
            if (modalContent) {
                modalContent.removeEventListener('scroll', checkModalPlayerVisibility);
            }
        }
    
        /**
         * Checks the visibility of the player inside the scrollable modal content and controls playback.
         */
        function checkModalPlayerVisibility() {
            const playerWrap = document.getElementById('playerWrap');
            const playerFrame = document.getElementById('youtubePlayer');
            const backdropOverlay = document.getElementById('modal-backdrop-container');
            const modal = document.getElementById('tmdb-modal');
        
            if (!playerWrap || !modal || !playerFrame) return;
            if (player.getPlayerState() === YT.PlayerState.ENDED) {
                return; // Exit early, keep the backdrop shown for ended videos
            }
        
            const rect = playerWrap.getBoundingClientRect();
            const modalRect = modal.getBoundingClientRect();

            // Calculate the visible height of the player relative to the modal viewport
            const visibleTop = Math.max(modalRect.top, rect.top);
            const visibleBottom = Math.min(modalRect.bottom, rect.bottom);
            const visibleHeight = Math.max(0, visibleBottom - visibleTop);
            const playerHeight = rect.height;
            const visibilityPercentage = (visibleHeight / playerHeight) * 100;
            
            // Only apply visibility logic if player has already been shown after 1 second
            if (playerVisible) {
                if (visibilityPercentage < 60) {
                    backdropOverlay.classList.remove('hidden');
                    playerFrame.classList.add('hidden');
                    if (player.getPlayerState() === YT.PlayerState.PLAYING) {
                        player.pauseVideo();
                    }
                } else {
                    backdropOverlay.classList.add('hidden');
                    playerFrame.classList.remove('hidden');
                    if (player.getPlayerState() === YT.PlayerState.PAUSED) {
                        player.playVideo();
                    }
                }
            }
        }
        
        // Event listener for the replay functionality
        document.addEventListener('click', function(e) {
            const playerWrap = e.target.closest('#playerWrap');
            if (playerWrap && playerWrap.classList.contains('shown')) {
                if (player) {
                    player.seekTo(0);
                    player.playVideo();
                }
            }
        });
    </script>

<!-- Your existing HTML content -->

<!-- Add this script before the closing body tag -->
<!-- URL Modal Handler - Movie, TV Show, and Season Support (Capital S Format) with Season Validation -->
<script>
document.addEventListener('DOMContentLoaded', function() {
  // Function to check URL and open modal if it matches pattern
function checkUrlAndOpenModal() {
  const urlParams = new URLSearchParams(window.location.search);
  
  // Check if URL has movie parameter: ?movie={id}
  const movieId = urlParams.get('movie');
  if (movieId) {
    console.log(`Detected movie ID ${movieId} in URL, opening modal...`);
    history.replaceState({ page: "browse" }, "", "/browse");
    openModal(movieId, 'movie');
    return;
  }
  
  // Check if URL has TV parameter: ?tv={id}
  const tvId = urlParams.get('tv');
  if (tvId) {
    console.log(`Detected TV show ID ${tvId} in URL, opening modal...`);
    history.replaceState({ page: "browse" }, "", "/browse");
    openModal(tvId, 'tv');
    return;
  }
}
  
  // Handle browser back/forward navigation
  window.addEventListener('popstate', function(event) {
    // Close modal when navigating back
    const modal = document.getElementById('tmdb-modal');
    if (modal && modal.style.transform === 'translateY(0px)') {
      closeModal();
    } else {
      // Check if the new URL should open a modal
      checkUrlAndOpenModal();
    }
  });
  
  // Override the fetchEpisodes function to update URL when season changes
  const originalFetchEpisodes = window.fetchEpisodes;
  window.fetchEpisodes = function(seriesId, seasonNumber, seriesName) {
    // Update URL to include season when manually changing seasons (using Capital S format)
    const currentPath = window.location.pathname;
    const tvMatch = currentPath.match(/\/tv\/(\d+)/);
    
    if (tvMatch) {
      const newUrl = `/tv/${seriesId}/S${seasonNumber}`;
      history.pushState({seriesId, seasonNumber}, '', newUrl);
    }
    
    // Call the original fetchEpisodes function
    return originalFetchEpisodes(seriesId, seasonNumber, seriesName);
  };
  
  // Check URL on initial page load
  checkUrlAndOpenModal();
});

function handleRoute() {
  const path = location.pathname.toLowerCase();

  if (path === "/movies") {
    renderMovieSections();
  } else if (path === "/tv") {
    renderTVSections();
  } else if (path === "/anime") {
    renderAnimeSections();
  } else if (path === "/home") {
    renderHomeSections();
  } else if (path === "/my-list") {
    renderMyListSections();
  } else {
    console.warn(`No handler found for: ${path}`);
  }
}
function navigateTo(path) {
  // Only push if it's not already the same path
  if (location.pathname.toLowerCase() !== path.toLowerCase()) {
    history.pushState({}, "", path);
  }
}

document.addEventListener("DOMContentLoaded", handleRoute);
window.addEventListener("popstate", handleRoute);

function playLiveStream(url, name) {
    // 1. Safety: Remove any existing player overlay before creating a new one
    const existingOverlay = document.getElementById('external-player-overlay');
    if (existingOverlay) {
        existingOverlay.remove();
    }

    // 2. Create the main Full-Screen Overlay container
    const overlay = document.createElement('div');
    overlay.id = 'external-player-overlay';
    overlay.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background-color: #000000;
        z-index: 99999;
        display: flex;
        flex-direction: column;
        margin: 0;
        padding: 0;
        overflow: hidden;
    `;

    // 3. Create the Header Bar (Channel Name + Close Button)
    const header = document.createElement('div');
    header.style.cssText = `
        height: 60px;
        background-color: #1a1a1a;
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0 20px;
        color: #ffffff;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;
        border-bottom: 1px solid #333;
        box-sizing: border-box;
    `;
    
    // Channel Title
    const title = document.createElement('div');
    title.style.cssText = `
        font-size: 18px;
        font-weight: 600;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        max-width: 60%;
    `;
    title.textContent = `Streaming: ${name}`;
    
    // Close Button
    const closeBtn = document.createElement('button');
    closeBtn.innerHTML = '&#10005; Close Player';
    closeBtn.style.cssText = `
        background-color: #e11d48;
        color: #ffffff;
        border: none;
        padding: 10px 20px;
        border-radius: 6px;
        cursor: pointer;
        font-size: 14px;
        font-weight: bold;
        transition: background 0.2s;
    `;
    closeBtn.onmouseover = () => closeBtn.style.backgroundColor = '#be123c';
    closeBtn.onmouseout = () => closeBtn.style.backgroundColor = '#e11d48';
    
    // Function to close the player and stop the stream
    closeBtn.onclick = () => {
        overlay.remove();
    };

    // 4. Create the Iframe
    const iframe = document.createElement('iframe');
    const encodedStreamUrl = encodeURIComponent(url);
    iframe.src = `https://watchout-player.netlify.app/?url=${encodedStreamUrl}`;
    
    iframe.style.cssText = `
        flex: 1;
        width: 100%;
        border: none;
        background-color: #000;
    `;
    
    // Essential iframe permissions for video playback
    iframe.allow = "autoplay; encrypted-media; fullscreen; picture-in-picture";
    iframe.setAttribute('allowfullscreen', 'true');

    // 5. Assemble and inject into the DOM
    header.appendChild(title);
    header.appendChild(closeBtn);
    overlay.appendChild(header);
    overlay.appendChild(iframe);
    
    document.body.appendChild(overlay);
}

</script>
	<script>
    const reportModal = document.getElementById("reportModal");
    const issueType = document.getElementById("issueType");
    const submitBtn = document.getElementById("submitBtn");

    function openReportModal() {
      reportModal.classList.add("active");
    }

    function closeReportModal() {
      reportModal.classList.remove("active");
    }

    issueType.addEventListener("change", () => {
      submitBtn.disabled = issueType.value === "";
    });

    function submitIssue() {
      const type = issueType.value;
      const desc = document.getElementById("issueDesc").value;

      alert(`Issue reported:\nType: ${type}\nDescription: ${desc || "N/A"}`);

      closeReportModal();
      issueType.value = "";
      document.getElementById("issueDesc").value = "";
      submitBtn.disabled = true;
    }
  </script>
</body>

</html>
